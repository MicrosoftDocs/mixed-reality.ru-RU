---
title: Учебники по началу работы — 5. Взаимодействие с трехмерными объектами
description: ''
author: jessemcculloch
ms.author: jemccull
ms.date: 05/02/2019
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.openlocfilehash: 29a31f794cbcda4f0c77b4e6e2d0e3c2c91dcb8c
ms.sourcegitcommit: af1602710c1ccb7ed870a491923350d387706129
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/01/2019
ms.locfileid: "68702017"
---
# <a name="5-interacting-with-3d-objects"></a>5. Взаимодействие с трехмерными объектами

В этом руководстве мы рассмотрим основные трехмерные материалы и взаимодействие с пользователем. Мы будем изучать следующее: 
* Упорядочение трехмерных объектов в составе коллекции.
* Ограничивающие прямоугольники для базовой манипуляции.
* Близко и далеко.
* Жесты касания и захвата с отслеживанием руки. 

## <a name="objectives"></a>Цели

* Узнайте, как организовать трехмерное содержимое с помощью коллекции объектов сетки МРТК
* Реализация ограничивающих рамок.
* Настройка трехмерных объектов для базовой манипуляции — перемещение, вращение и масштабирование
* Изучение ближнего и дальнего взаимодействия.
* Дополнительные сведения о жестах отслеживания, таких как захват и сенсорный ввод

## <a name="instructions"></a>Инструкция

### <a name="organizing-3d-objects-in-a-collection"></a>Упорядочение трехмерных объектов в коллекции

1. Щелкните правой кнопкой мыши иерархию и выберите пункт создать пустое. Это действие создает пустой игровой объект. Переименуйте его в 3DObjectCollection. В него мы поместим все трехмерные объекты. Убедитесь, что для этой коллекции заданы значения размещения x=0, y=0 и z=0.

![Изображение "Урок 4, глава 1, шаг 1"](images/Lesson4_Chapter1_step1im.PNG)

2. Импортируйте ресурсы Басемодуле, используя те же инструкции для импорта пользовательских пакетов, описанных в [занятия 1](mrlearning-base-ch1.md). Ресурсы Басемодуле включают трехмерные модули и другие полезные сценарии, используемые в этом руководстве. Пакет Unity Басемодуле можно найти здесь:<https://github.com/Microsoft/MixedRealityLearning/releases/tag/V1.1>

3. Вам нужен шаблон CoffeeCup (Чашка кофе), рядом с которым отображается голубой кубик. Не выбирайте чашку кофе с синим кубом и небольшим белым документом, так как это означает исходную трехмерную модель, а не prefab.) 

![Изображение "Урок 4, глава 1, примечание A"](images/Lesson4_chapter1_noteaim.PNG)

4. Перетащите prefabную чашку кофе в объект игры 3DObjectCollection из шага 1. Теперь эта чашка кофе станет дочерним элементом коллекции.

![Изображение "Урок 4, глава 1, шаг 4"](images/Lesson4_chapter1_step4ima.PNG)

5. Теперь мы добавим в сцену дополнительные трехмерные объекты. Ниже приведен список объектов, которые мы добавим в наш пример. При добавлении объектов может оказаться, что они отображаются в сцене в различных размерах. Настройте шкалу для каждой трехмерной модели в разделе параметр преобразования на панели инспектора. Рекомендуемые настройки для этого примера мы добавили в список объектов ниже. Выполните поиск этих слов в поле поиска на панели проекта и перетащите трехмерный объект prefab в объект 3DObjectCollection, как на предыдущем шаге. Вы найдете эти коллекции Prefabs в Assets > Басемодулеассетс > базовый модуль Prefabs
- Выполните поиск по запросу TheModule_BaseModuleIncomplete. Перетащите объект в сцену. Установите параметры размера x=0,03, y=0,03 и z=0,03. 
- Выполните поиск по запросу Octa_BaseModuleIncomplete. Перетащите объект в сцену. Установите параметры размера x=0,13, y=0,13 и z=0,13.
- Выполните поиск по запросу EarthCore_BaseModuleIncomplete. Перетащите объект в сцену. Установите параметры размера x=50,0, y=50,0 и z=50,0.
- Выполните поиск по запросу Cheese_BaseModuleIncomplete. Перетащите объект в сцену. Установите параметры размера x=0,05, y=0,05 и z=0,05.
- Выполните поиск по запросу Model_Platonic_BaseModuleIncomplete. Перетащите объект в сцену. Установите параметры размера x=0,13, y=0,13 и z=0,13.

![Изображение "Урок 4, глава 1, шаг 5"](images/Lesson4_Chapter1_step5im.PNG)

6. Добавьте в сцену три куба. Щелкните правой кнопкой мыши объект 3DObjectCollection, выберите пункт объемный объект, а затем выберите куб. Установите параметры размера x=0,14, y=0,14 и z=0,14. Повторите этот шаг еще два раза, чтобы создать сумму из трех кубов. Кроме того, куб можно дублировать дважды для всего трех кубов. Вы также можете применить три готовых шаблона куба из раздела Assets>BaseModuleAssets>Base Module Prefabs: GreenCube_BaseModuleIncomplete, BlueCube_BaseModuleIncomplete и OrangeCube_BaseModuleIncomplete.

![Изображение "Урок 4, глава 1, шаг 6"](images/Lesson4_Chapter1_step6im.PNG)

7. Расположите коллекцию объектов в виде сетки, выполнив процедуру из [урока 2](mrlearning-base-ch2.md) с коллекцией объектов сетки MRTK. На рисунке ниже представлен пример размещения объектов в виде сетки размером 3x3.

![Изображение "Урок 4, глава 1, примечание B"](images/Lesson4_chapter1_notebim.PNG)

>Примечание. Можно заметить, что некоторые объекты находятся вне центра, например объекты на изображении выше. Это связано с тем, что шаблоны или объекты могут иметь невыровненные дочерние объекты. Вы можете изменить положения объектов и (или) дочерних объектов, чтобы сетка была равномерной.


### <a name="manipulating-3d-objects"></a>Работа с трехмерными объектами
1. Добавьте возможность манипулирования кубом. Чтобы добавить возможность манипулировать трехмерными объектами, выполните следующие действия.
-   Выберите трехмерный объект, который требуется изменить в иерархии, например один из кубов.
-   Нажмите кнопку Добавить компонент. 
-   Поиск манипуляций.
-   Выберите обработчик манипуляции.
-   Повторите эти действия для всех трехмерных объектов в объекте 3DObjectCollection, но не самого 3DObjectCollection.
-   Убедитесь, что все трехмерные объекты имеют конфликтующее или блочное окно ("добавить компонент" > "конфликт").

![Изображение "Урок 4, глава 2, шаг 1"](images/Lesson4_chapter2_step1im.PNG)

>Обработчик манипуляции — это компонент, позволяющий настраивать параметры поведения объектов при работе с ними. Это относится к повороту, масштабированию, перемещению и ограничению перемещения по определенной оси. 

2. Настройте для одного куба ограничения, чтобы его можно было только масштабировать. Выберите один куб в объекте 3DObjectCollection. На панели инспектора рядом с двумя типами манипуляций, щелкните раскрывающееся меню и выберите масштаб. Теперь пользователь может изменить только размер куба.

![Изображение "Урок 4, глава 2, шаг 2"](images/Lesson4_Chapter2_step2im.PNG)

3. Измените цвет каждого куба, чтобы их можно было различать. 
-   Перейдите на панель "проект" и прокрутите вниз, пока не увидите Микседреалититулкит. SDK, а затем выберите его.
-   Выберите папку Стандартные активы.
-   Щелкните папку материалы.
-   Перетащите новый материал на каждый из кубов. 

>Примечание. Вы можете выбрать для кубов любые цвета. В нашем примере мы будем использовать гловингциан, гловингоранже и Green. Вы можете экспериментировать с другими цветами. Чтобы добавить цвет к кубу, щелкните куб, который необходимо изменить, а затем перетащите материал в поле Material (материал) модуля подготовки сетки на панели инспектора Куба. 

![Изображение "Урок 4, глава 2, шаг 3"](images/Lesson4_Chapter2_step3im.PNG)

4. Выберите другой куб в объекте 3DObjectCollection и сделайте его таким образом, чтобы его перемещение было ограничено фиксированным расстоянием от заголовка. Для этого справа от ограничения на метку перемещения щелкните раскрывающееся меню и выберите пункт исправить расстояние в заголовке. Теперь пользователь может перемещать этот куб только в пределах поля зрения. 

![Изображение "Урок 4, глава 2, шаг 4"](images/Lesson4_chapter2_step4im.PNG)

Целью следующих шагов является включение захвата и взаимодействие с нашими трехмерными объектами и применение различных параметров манипуляции.

5. Выберите объект Мак и нажмите кнопку Добавить компонент на панели инспектора. 

6. Найдите в поле поиска близкое взаимодействие с возможностью захвата и выберите скрипт. Этот компонент позволяет пользователям достичь и захватить объекты с помощью отслеживания руки. Объекты также можно манипулировать с расстояния, если флажок Разрешить далеко манипулировать не установлен, как указано зеленым кружком на изображении ниже.

![Изображение "Урок 4, глава 2, шаг 6"](images/Lesson4_Chapter2_step6im.PNG)

7. Добавьте близкое взаимодействие к объекту восьмиядерными, объекту Платоновыми, ядру земли, лунному модулю и чашке кофе, повторив шаги 5 и 6 на этих объектах.

8. Удалите возможность дальнего манипулирования для объекта Octa. Для этого выберите восьмиядерными в иерархии и снимите флажок Разрешить далекое манипуляции (отмечено зеленым кружком). Теперь пользователи смогут взаимодействовать с объектом Octa только напрямую с помощью отслеживаемых рук.

>Примечание. Полная документация по компоненту обработчика манипулирования и связанным с ним параметрам вы можете найти в [документации MRTK](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_ManipulationHandler.html).

9. Убедитесь, что к ядру земли, лунному модулю и кофе (см. шаг 7) добавлен ближайший к взаимодействию компонент.

10. Для лунного модуля измените параметры обработчика манипуляции так, чтобы он поменялся относительно центра объекта как для практически, так и для дальнего взаимодействия, как показано на рисунке ниже.

![Изображение "Урок 4, глава 2, шаг 10"](images/Lesson4_chapter2_step10im.PNG)

11. Для ядра Земли Измените поведение выпуска на Nothing. Это делает это так, что после того, как ядро земли будет освобождено от вашего пользователя, оно не будет перемещаться. 

![Изображение "Урок 4, глава 2, шаг 11"](images/Lesson4_Chapter2_step11im.PNG)

> Примечание. Этот параметр полезен, например, при создании мяча, который можно бросать. Поддержание скорости и угловой скорости делает его таким образом, что после освобождения шарика он продолжит двигаться на скорости, в которой он был освобожден, аналогично тому, как работает физический шарик.

### <a name="adding-bounding-boxes"></a>Добавление ограничивающих рамок
Ограничивающие рамки делают манипулирование объектами одной рукой более простым и интуитивно понятным, как при прямом манипулировании (ближнее взаимодействие), так и при лучевом манипулировании (дальнее взаимодействие). Ограничивающие прямоугольники предоставляют маркеры, которые могут быть извлечены для масштабирования и вращения объектов вдоль определенной оси.
>Примечание. Прежде чем можно будет добавить ограничивающий прямоугольник к объекту, сначала необходимо иметь в объекте объект, который является объектом (например, «конфликт ящиков»), как было раньше в этом занятии. Чтобы добавить коллайдер, можно выбрать нужный объект и выбрать на панели инспектора действие Add Component > Box Collider (Добавить компонент > Прямоугольный коллайдер).
>

1. Добавьте в объект Earth Core рамку, если она еще не существует. Блочный установщик и программа установки не требуются, если используется prefab, предоставленный в папке ресурсов базового модуля в соответствии с заданными инструкциями. В случае с ядром земли мы добавили поле «node_id30» в объект под ядром земли, как показано на рисунке ниже. Выберите node_id30 на вкладке инспектора объектов, нажмите кнопку Добавить компонент и выполните поиск по слову конфликт Box. 

![Изображение "Урок 4, глава 3, шаг 1"](images/Lesson4_Chapter3_step1im.PNG)

![Изображение "Урок 4, глава 3, шаг 2"](images/Lesson4_chapter3_step2im.PNG)

> Примечание. Убедитесь, что размер рамки не слишком велик или не слишком мал. Его размер должен примерно совпадать с размером того объекта, который он окружает (в нашем примере это ядро Земли). При необходимости измените значение поля "конфликт", выбрав параметр "Изменить" в списке конфликтующих параметров. Можно изменить значения x, y и z либо перетащить обработчики ограничивающих прямоугольников в окне сцены редактора. 

![Изображение "Урок 4, глава 3, примечание"](images/Lesson4_Chapter3_noteim.PNG)

2. Добавьте ограничивающий прямоугольник в объект node_id30 для земли Core. Для этого выберите объект node_id30 из 3DObjectCollection. На вкладке инспектор щелкните Добавить компонент и найдите ограничивающий прямоугольник. Убедитесь, что ограничивающая рамка, прямоугольный коллайдер и скрипты манипулирования (обработчик манипулирования и обработчик захвата при близком взаимодействии) размещены в одном игровом объекте.

3.  В разделе поведение ограничивающего прямоугольника выберите активировать при запуске из раскрывающегося списка активация. Чтобы просмотреть дополнительные сведения о доступных вариантах активации или о других параметрах ограничивающей рамки, воспользуйтесь [документацией по ограничивающей рамке MRTK](<https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_BoundingBox.html>).

   

   *В следующих шагах мы также изменим вид ограничивающего прямоугольника, изменяя значение поля по умолчанию, материал, когда он загружается, а также визуализацию угловых и боковых маркеров. MRTK предоставляет несколько параметров для настройки ограничивающей рамки.*

4. На панели проект найдите BoundingBox, и вы увидите список материалов, обозначенных синей сферой в результатах поиска, как показано на рисунке ниже. 

5. Перетащите материал BoundingBox в ячейку "материальный материал" в компоненте ограничивающего прямоугольника. Также Возьмите материал баундингбоксграббед и помещайте его в ячейку, захваченную материалом в компоненте ограничивающего прямоугольника.

6. Перетащите MRTK_BoundingBox_ScaleWidget prefab в гнездо Scale prefab в компоненте ограничивающего прямоугольника. 

7. Перетащите MRTK_BoundingBox_RotateWidget prefab в область маркера вращения в компоненте бокса резервирования.

![Изображение "Урок 4, глава 3, шаг 4"](images/Lesson4_chapter3_step4-7im.PNG)

8. Убедитесь, что ограничивающая рамка привязана к правильному объекту. В компоненте ограничивающего прямоугольника есть целевой объект и границы, переопределяющие скрипты. Обязательно перетащите в оба этих слота объект, вокруг которого есть ограничивающая рамка. В этом примере перетащите объект node_id30 в оба этих слота, как показано на рисунке ниже.

> При запуске или воспроизведении приложения объект будет окружен синим кадром. Мы можете перетаскивать углы этой рамки, чтобы изменять размер объекта. Если вы хотите, чтобы маркеры масштабирования и маркеры вращения были больше и видны, рекомендуется использовать параметры ограничивающего прямоугольника по умолчанию (избегая шагов с 4 по 7). 

![Изображение "Урок 4, глава 3, шаг 8"](images/Lesson4_Chapter3_step8im.PNG)

9. Чтобы вернуться к визуализации ограничивающего прямоугольника по умолчанию, на панели инспектора объекта ограничивающего прямоугольника выберите маркер вращения prefab и нажмите клавишу DELETE. Вы увидите визуализацию ограничивающего прямоугольника, как показано на рисунке ниже. Примечание. Визуализации ограничивающей рамки отображаются только в режиме воспроизведения.

![Изображение "Урок 4, глава 3, шаг 9"](images/Lesson4_chapter3_step9im.PNG)

### <a name="adding-touch-effects"></a>Добавление эффектов касания
В этом примере мы добавим звуковой эффект, который воспроизводится при касании объекта рукой.

1. Добавьте компонент источника звука в игровой объект. Выберите объект восьмиядерными в иерархии сцены. На панели инспектора нажмите кнопку Добавить компонент, найдите и выберите источник звука. Позднее мы применим этот источник звука для воспроизведения звуковых эффектов. 

>Примечание. Убедитесь, что на объекте восьмиядерными имеется рамка, конфликтующая с объектом.

2. Добавьте компонент с сенсорным взаимодействием NEAR. Нажмите кнопку Добавить компонент на панели инспектора и выполните поиск по запросу с сенсорным взаимодействием. Выберите этот компонент, чтобы добавить его. 

>Примечание. Ранее мы добавили близкое к взаимодействию. Различие между этим и практическим взаимодействием заключается в том, что захватное взаимодействие предназначено для захвата и взаимодействия объекта. Сенсорный компонент предназначен для того, чтобы объект был затронуты. Вы можете использовать оба компонента совместно, чтобы сочетать эти взаимодействия.

![Изображение "Урок 4, глава 4, шаг 1"](images/Lesson4_chapter4_step1-2im.PNG)

3. Добавьте в сценарий сенсорного взаимодействия руки. Обратите внимание, что этот сценарий включен в сцену, импортированную в рамках этой демонстрации, и не включается в исходный МРТК. Как и на предыдущем шаге, нажмите кнопку Добавить компонент и выполните поиск по фразе взаимодействие с руки, чтобы добавить его.

>Обратите внимание, что сценарий имеет три варианта: 

>   - По завершении сенсорного ввода: Активируется при касании и освобождении объекта
>   - При запуске сенсорного ввода: Активируется, когда объект затронут
>   - При обновлении сенсорного ввода: Периодически срабатывает при прикосновении объекта к объекту

>   В этом примере мы будем работать с параметром on Touch Started.

4. Нажмите кнопку + в параметре при запуске касания, как показано на рисунке ниже. Перетащите объект восьмиядерными в пустое поле. 

5. В раскрывающемся списке нет функции (над зеленым прямоугольником на рисунке ниже) выберите Аудиосаурце-> Плайонешот. В это поле мы добавим аудиоклип, используя следующие концепции.

   - MRTK содержит небольшой список аудиоклипов. Вы можете изучить их на панели проекта. Они будут находиться в папке Микседреалититулкит. SDK, а затем в папке Standard Assets. Там вы увидите папку Audio, в которой находятся все звуковые клипы.
   - В этом примере мы будем использовать аудиоклип MRTK_Gem. 
   - Чтобы добавить этот аудиоклип, перетащите его из панели проекта в слот AudioSource.PlayOneShot (отмечен зеленой рамкой в приведенном выше примере) на панели инспектора.

   Теперь, когда пользователь достигает и затрагивает объект восьмиядерными, начнет воспроизводиться звуковая дорожка MRTK_Gem. Сценарий касания руки также будет настраивать цвет объекта при его наличии. 

![Изображение "Урок 4, глава 4, шаг 3, примечание 5"](images/Lesson4_chapter4_step3-5-noteim.PNG)

## <a name="congratulations"></a>Поздравляем! 
В этом учебнике вы узнали, как организовать трехмерные объекты в коллекции Grid и как управлять трехмерными объектами (масштабирование, вращение и перемещение) с помощью ближнего действия (с отслеживанием руки) и намного взаимодействием (с использованием лучей или лучей). Вы также узнали, как разместить ограничивающие рамки вокруг трехмерных объектов и как использовать и настраивать приспособлений в ограничивающих прямоугольниках. И наконец, вы научились инициировать события при касании объекта.

[Следующий урок. 6. Изучение дополнительных входных параметров](mrlearning-base-ch5.md)

