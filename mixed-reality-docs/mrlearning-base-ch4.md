---
title: Учебники по началу работы — 5. Взаимодействие с трехмерными объектами
description: ''
author: jessemcculloch
ms.author: jemccull
ms.date: 05/02/2019
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.openlocfilehash: fe068d0cfcea369f10e6fa636eb73fecb3002fa7
ms.sourcegitcommit: 23b130d03fea46a50a712b8301fe4e5deed6cf9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/24/2019
ms.locfileid: "75334387"
---
# <a name="5-interacting-with-3d-objects"></a>5. взаимодействие с трехмерными объектами

В этом руководстве вы узнаете о базовом трехмерном содержимом и пользовательском интерфейсе, например:

* Упорядочение трехмерных объектов в составе коллекции
* Ограничивающие прямоугольники для базовой манипуляции
* Практически и далеко о взаимодействии
* Жесты касания и захвата с отслеживанием руки

## <a name="objectives"></a>Задачи

* Узнайте, как организовать трехмерное содержимое с помощью коллекции объектов сетки МРТК
* Реализация ограничивающих рамок.
* Настройка трехмерных объектов для базовой манипуляции — перемещение, вращение и масштабирование
* Изучение ближнего и дальнего взаимодействия.
* Дополнительные сведения о жестах отслеживания, таких как захват и сенсорный ввод

## <a name="organizing-3d-objects-in-a-collection"></a>Упорядочение трехмерных объектов в коллекции

1. Щелкните правой кнопкой мыши иерархию и выберите создать пустой, чтобы создать пустой объект Game, переименуйте его в 3DObjectCollection и убедитесь, что он расположен в положении x = 0, y = 0, а z = 0.

    ![mrlearning-Base-CH4-1-Step1. png](images/mrlearning-base-ch4-1-step1.png)

2. Скачайте пакет Unity [Unity. HoloLens2. GettingStarted. Tutorials. Asset. 2.1.0.0](https://github.com/microsoft/MixedRealityLearning/releases/download/getting-started-v2.1.0.0/Unity.HoloLens2.GettingStarted.Tutorials.Asset.2.1.0.0.unitypackage) и импортируйте его, используя те же инструкции для импорта пользовательских пакетов, описанных в [занятия 1](mrlearning-base-ch1.md). Этот пакет содержит трехмерные модели и другие полезные ресурсы, используемые в этом руководстве.

3. На панели проект перейдите к разделу активы > Басемодулеассетс > базовый модуль Prefabs и выполните поиск по слову "неполный", мы будем использовать некоторые из этих Prefabs.

    ![mrlearning-Base-CH4-1-step3. png](images/mrlearning-base-ch4-1-step3.png)

4. Перетащите чашку кофе в объект игры 3DObjectCollection из шага 1. Теперь эта чашка кофе станет дочерним элементом коллекции.

    ![mrlearning-Base-CH4-1-step4. png](images/mrlearning-base-ch4-1-step4.png)

5. Далее вы добавите в нашу сцену больше трехмерных объектов, следуя тому же процессу, что и на предыдущем шаге. Ниже приведен список объектов для добавления в этом примере. При добавлении объектов они могут отображаться в сцене в различных размерах. Настройте шкалу для каждой трехмерной модели в разделе Параметры преобразования на панели инспектора. Рекомендуемые настройки для этого примера мы добавили в список объектов ниже.

    * Cheese_BaseModuleIncomplete. Scale: x = 0,05, y = 0,05, z = 0,05.
    * CoffeeCup_BaseModuleIncomplete. Scale: x = 0,1, y = 0,1, z = 0,1.
    * EarthCore_BaseModuleIncomplete. Scale: x = 50,0 y = 50,0, z = 50,0.
    * Model_Platonic_BaseModuleIncomplete. Scale: x = 0,13, y = 0,13, z = 0,13.
    * Octa_BaseModuleIncomplete. Масштаб: x = 0,13. y=0,13 и z=0,13.
    * TheModule_BaseModuleIncomplete. Scale: x = 0,03, y = 0,03, z = 0,03.

    ![mrlearning-Base-CH4-1-step5. png](images/mrlearning-base-ch4-1-step5.png)

6. Добавьте в сцену три куба. Щелкните правой кнопкой мыши объект 3DObjectCollection, выберите пункт объемный объект, а затем выберите куб. Установите параметры размера x=0,14, y=0,14 и z=0,14. Повторите этот шаг еще два раза, чтобы создать сумму из трех кубов. Кроме того, куб можно дублировать дважды для всего трех кубов. Вы также можете применить три готовых шаблона куба из раздела Assets>BaseModuleAssets>Base Module Prefabs: GreenCube_BaseModuleIncomplete, BlueCube_BaseModuleIncomplete и OrangeCube_BaseModuleIncomplete.

    ![mrlearning-Base-CH4-1-step6. png](images/mrlearning-base-ch4-1-step6.png)

7. Упорядочите коллекцию объектов для формирования сетки с помощью процедуры, описанной в [занятии 2](mrlearning-base-ch2.md), с помощью коллекции объектов сетки мртк. Пример настройки объектов в сетке 3x3 см. на рисунке ниже.

    ![mrlearning-Base-CH4-1-Step7. png](images/mrlearning-base-ch4-1-step7.png)

    >[!NOTE]
    >Можно заметить, что некоторые объекты находятся вне центра, например объекты на изображении выше. Это связано с тем, что шаблоны или объекты могут иметь невыровненные дочерние объекты. Вы можете изменить положения объектов и (или) дочерних объектов, чтобы сетка была равномерной.

## <a name="manipulating-3d-objects"></a>Работа с трехмерными объектами

1. Добавьте возможность манипулирования кубом. Чтобы добавить возможность манипулировать трехмерными объектами, выполните следующие действия.
    * Выберите трехмерный объект, который требуется изменить в иерархии (т. е. один из кубов).
    * Нажмите кнопку Добавить компонент.
    * Поиск "манипуляции"
    * Выбор обработчика манипуляции
    * Повторите эти действия для всех трехмерных объектов в объекте 3DObjectCollection, но не самого 3DObjectCollection.
    * Убедитесь, что для всех трехмерных объектов установлен компонент "конфликт" или "рамка" ("Добавить >".

    ![Изображение "Урок 4, глава 2, шаг 1"](images/Lesson4_chapter2_step1im.PNG)

    >[!NOTE]
    >Обработчик манипуляции — это компонент, позволяющий настраивать параметры поведения объектов при работе с ними. Это относится к повороту, масштабированию, перемещению и ограничению перемещения по определенной оси.

2. Настройте для одного куба ограничения, чтобы его можно было только масштабировать. Выберите один куб в объекте 3DObjectCollection. На панели инспектора рядом с двумя типами манипуляций, щелкните раскрывающееся меню и выберите масштаб. Теперь пользователь может изменить только размер куба.

    ![Изображение "Урок 4, глава 2, шаг 2"](images/Lesson4_Chapter2_step2im.PNG)

3. Измените цвет каждого куба, чтобы их можно было различать.
    * Перейдите на панель "проект" и прокрутите вниз, пока не увидите Микседреалититулкит. SDK, а затем выберите его.
    * Выберите папку Стандартные активы.
    * Щелкните папку материалы.
    * Перетащите новый материал на каждый из кубов.

    >[!NOTE]
    >Вы можете выбрать для кубов любые цвета. В этом примере используются гловингциан, гловингоранже и Green. Вы можете экспериментировать с другими цветами. Чтобы добавить цвет к кубу, щелкните куб, который необходимо изменить, а затем перетащите материал в поле Material (материал) модуля подготовки сетки на панели инспектора Куба.

    ![Изображение "Урок 4, глава 2, шаг 3"](images/Lesson4_Chapter2_step3im.PNG)

4. Выберите другой куб в объекте 3DObjectCollection и сделайте его таким образом, чтобы его перемещение было ограничено фиксированным расстоянием от заголовка. Для этого справа от ограничения на метку перемещения щелкните раскрывающееся меню и выберите пункт исправить расстояние в заголовке. Это настраивает куб в соответствии с его полем зрения.

    ![Изображение "Урок 4, глава 2, шаг 4"](images/Lesson4_chapter2_step4im.PNG)

    Целью выполнения следующих действий является включение захвата и взаимодействие с нашими трехмерными объектами и применение различных параметров манипуляции.

5. Выберите объект Мак, а затем нажмите кнопку Добавить компонент на панели инспектора.

6. Найдите в поле поиска близкое взаимодействие с возможностью захвата и выберите скрипт. Этот компонент позволяет пользователям обращаться к объектам с помощью отслеживаний руки. Объекты также можно манипулировать с расстояниями, если флажок Разрешить далеко манипулировать не установлен, как обозначено зеленым кружком на изображении ниже.

    ![Изображение "Урок 4, глава 2, шаг 6"](images/Lesson4_Chapter2_step6im.PNG)

7. Добавьте близкое взаимодействие к объекту восьмиядерными, объекту Платоновыми, ядру земли, лунному модулю и чашке кофе, повторив шаги 5 и 6 на этих объектах.

8. Удалите возможность дальнего манипулирования для объекта Octa. Для этого выберите восьмиядерными в иерархии и снимите флажок разрешить множество манипуляций (отмечен зеленым кружком). Таким образом, пользователи могут взаимодействовать только с восьмиядерными напрямую с помощью отслеживания руки.

    >[!NOTE]
    >Полную документацию по компоненту обработчика манипуляции и связанным с ним параметрам см. в [документации по мртк](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_ManipulationHandler.html).

9. Убедитесь, что к ядру земли, лунному модулю и кофе (см. шаг 7) добавлен ближайший к взаимодействию компонент.

10. Для лунного модуля измените параметры обработчика манипуляции таким образом, чтобы они поворачиваются вокруг центра объекта как для практических, так и для дальнего взаимодействия, как показано на рисунке ниже.

    ![Изображение "Урок 4, глава 2, шаг 10"](images/Lesson4_chapter2_step10im.PNG)

11. Для ядра Земли Измените поведение выпуска на Nothing. Это делает это так, что после того, как ядро земли будет освобождено от вашего пользователя, оно не будет перемещаться.

    ![Изображение "Урок 4, глава 2, шаг 11"](images/Lesson4_Chapter2_step11im.PNG)

    >[!NOTE]
    >Этот параметр полезен для сценариев, например для создания шарика, который можно создать. Поддержание соответствующей скорости и угловой скорости, чтобы гарантировать, что после выпуска шарика он продолжит двигаться на скорости, в которой он был освобожден. Аналогично тому, как работает физический шарик.

## <a name="adding-bounding-boxes"></a>Добавление ограничивающих рамок

Ограничивающие прямоугольники упрощают и интуитивно обрабатывают объекты с одной стороны как для непосредственной манипуляции (близкого взаимодействия), так и для манипуляции на основе лучей (намногого взаимодействия). Ограничивающие прямоугольники предоставляют маркеры, которые могут быть извлечены для масштабирования и вращения объектов вдоль определенной оси.

>[!NOTE]
>Прежде чем можно будет добавить ограничивающий прямоугольник к объекту, сначала необходимо иметь в объекте объект, который является объектом (например, "Конфликтующее поле"), как было описано ранее в этом занятии. Для добавления конфликтующих объектов можно выбрать объект и на панели инспектора объекта, выбрав Добавить компонент > окно "конфликты".

1. Добавьте в объект Earth Core рамку, если она еще не существует. Поле "не требуется", если используется prefab, предоставленный в папке ресурсов базового модуля, в соответствии с заданными инструкциями. В случае с ядром земли мы добавили в node_id30 объект, расположенный под ядром земли, как показано на рисунке ниже. Выберите node_id30 на вкладке инспектора объектов, нажмите кнопку Добавить компонент и выполните поиск по слову конфликт Box.

    ![Изображение "Урок 4, глава 3, шаг 1"](images/Lesson4_Chapter3_step1im.PNG)

    ![Изображение "Урок 4, глава 3, шаг 2"](images/Lesson4_chapter3_step2im.PNG)

    >[!NOTE]
    >Убедитесь, что размер рамки не слишком велик или не слишком мал. Его размер должен примерно совпадать с размером того объекта, который он окружает (в нашем примере это ядро Земли). При необходимости измените значение поля "конфликт", выбрав параметр "Изменить" в списке конфликтующих параметров. Можно изменить значения x, y и z либо перетащить обработчики ограничивающих прямоугольников в окне сцены редактора.

    ![Изображение "Урок 4, глава 3, примечание"](images/Lesson4_Chapter3_noteim.PNG)

2. Добавьте ограничивающий прямоугольник в объект node_id30 земли Core. Для этого выберите объект node_id30 из 3DObjectCollection. На вкладке инспектор щелкните Добавить компонент и найдите ограничивающий прямоугольник. Убедитесь, что ограничивающая рамка, прямоугольный коллайдер и скрипты манипулирования (обработчик манипулирования и обработчик захвата при близком взаимодействии) размещены в одном игровом объекте.

3. В разделе поведение ограничивающего прямоугольника выберите активировать при запуске из раскрывающегося списка активация. Дополнительные сведения о различных вариантах активации и других параметрах ограничивающего прямоугольника см. в [документации по ограничивающему](<https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_BoundingBox.html>) прямоугольнику мртк.

    *В следующих шагах мы также изменим вид ограничивающего прямоугольника, изменяя значение поля по умолчанию, материал, когда он загружается, а также визуализацию угловых и боковых маркеров. МРТК содержит несколько параметров для настройки ограничивающего прямоугольника.*

4. На панели проект найдите «BoundingBox», и вы увидите список материалов, обозначенных синей сферой в результатах поиска, как показано на рисунке ниже.

5. Перетащите материал BoundingBox в ячейку "материальный материал" в компоненте ограничивающего прямоугольника. Также захватите материал баундингбоксграббед и помещайте его в ячейку, захваченную материалом в компоненте ограничивающего прямоугольника.

    ![mrlearning-Base-CH4-3-step5. png](images/mrlearning-base-ch4-3-step5.png)

6. Перетащите MRTK_BoundingBox_ScaleHandle prefab в гнездо шкалы prefab, а MRTK_BoundingBox_RotateHandle prefab в область маркера вращения в компоненте бокса резервирования.

    ![mrlearning-Base-CH4-3-step6. png](images/mrlearning-base-ch4-3-step6.png)

7. Убедитесь, что ограничивающая рамка привязана к правильному объекту. В компоненте ограничивающего прямоугольника есть целевой объект и границы, переопределяющие скрипты. Перетащите объект с ограничивающим прямоугольником вокруг обоих слотов. В этом примере перетащите объект node_id30 в оба этих слота, как показано на рисунке ниже.

    ![mrlearning-Base-CH4-3-Step7. png](images/mrlearning-base-ch4-3-step7.png)

    >[!NOTE]
    >При запуске или воспроизведении приложения объект будет окружен синим кадром. Мы можете перетаскивать углы этой рамки, чтобы изменять размер объекта. Если вы хотите, чтобы маркеры масштабирования и маркеры вращения были больше и видны, рекомендуется использовать параметры ограничивающего прямоугольника по умолчанию (избегая шагов с 4 по 6).

8. Чтобы вернуться к визуализации ограничивающего прямоугольника по умолчанию, на панели инспектора объекта ограничивающего прямоугольника выберите маркер вращения prefab и нажмите клавишу DELETE, чтобы удалить его. При входе в режим воспроизведения вау увидит визуализацию ограничивающего прямоугольника, как показано на рисунке ниже.

    ![mrlearning-Base-CH4-3-Step8. png](images/mrlearning-base-ch4-3-step8.png)

    >[!NOTE]
    >Визуализации ограничивающего прямоугольника отображаются только в режиме воспроизведения.

## <a name="adding-touch-effects"></a>Добавление эффектов касания

В этом примере мы добавим звуковой эффект, который воспроизводится при касании объекта рукой.

1. Добавьте компонент источника звука в игровой объект. Выберите объект восьмиядерными в иерархии сцены. На панели инспектора нажмите кнопку Добавить компонент, найдите и выберите источник звука. Позднее мы применим этот источник звука для воспроизведения звуковых эффектов.

    >[!NOTE]
    >Убедитесь, что на объекте восьмиядерными имеется рамка, конфликтующая с объектом.

2. Добавьте компонент с сенсорным взаимодействием NEAR. Нажмите кнопку Добавить компонент на панели инспектора и выполните поиск по запросу с сенсорным взаимодействием. Выберите этот компонент, чтобы добавить его.

    >[!NOTE]
    >Ранее мы добавили близкое к взаимодействию. Различие между этим и практическим взаимодействием заключается в том, что захватное взаимодействие предназначено для захвата и взаимодействия объекта. Сенсорный компонент предназначен для того, чтобы объект был затронуты. Вы можете использовать оба компонента совместно, чтобы сочетать эти взаимодействия.

    ![Изображение "Урок 4, глава 4, шаг 1"](images/Lesson4_chapter4_step1-2im.PNG)

3. Добавьте в сценарий сенсорного взаимодействия руки. Как и на предыдущем шаге, нажмите кнопку Добавить компонент и выполните поиск по фразе взаимодействие с руки, чтобы добавить его.

    Обратите внимание, что сценарий имеет три варианта:
    * Вкл. касания: активируется при касании и освобождении объекта
    * При сенсорном запуске: активируется, когда объект затронут
    * При обновлении касания: периодические срабатывания триггера, когда рука касается объекта

    В этом примере мы будем работать с параметром on Touch Started.

    >[!NOTE]
    >Этот сценарий включен в пакет Басемодулеассетс Unity, который был импортирован как в начале этого учебника, и не включен в исходный МРТК.

4. Нажмите кнопку + в параметре при запуске касания и перетащите объект восьмиядерными в пустое поле.

    ![mrlearning-Base-CH4-4-step4. png](images/mrlearning-base-ch4-4-step4.png)

5. В раскрывающемся списке без функции выберите Аудиосаурце > Плайонешот. В это поле мы добавим аудиоклип, используя следующие концепции.

    * MRTK содержит небольшой список аудиоклипов. Вы можете просматривать их на панели проекта. Их можно найти в разделе Assets > Микседреалититулкит. SDK > Standard Assets > Audio Folder.
    * В этом примере мы будем использовать аудиоклип MRTK_Gem.
    * Чтобы добавить аудиоклип, просто перетащите нужный клип с панели проект в поле Аудиосаурце. Плайонешот.

    ![mrlearning-Base-CH4-4-step5. png](images/mrlearning-base-ch4-4-step5.png)

   Теперь, когда пользователь достигает и затрагивает объект восьмиядерными, звуковая дорожка MRTK_Gem будет воспроизводиться. Сценарий касания руки также корректирует цвет объекта, когда он затронут.

## <a name="congratulations"></a>Поздравляем!

В этом учебнике вы узнали, как упорядочивать трехмерные объекты в коллекции Grid и как управлять этими объектами (масштабирование, вращение и перемещение) с помощью ближнего взаимодействия (с отслеживанием руки) и намного взаимодействием (с использованием лучей или лучей). Вы также узнали, как разместить ограничивающие рамки вокруг трехмерных объектов и как использовать и настраивать приспособлений в ограничивающих прямоугольниках. И наконец, вы научились инициировать события при касании объекта.

[Следующее занятие: 6. Просмотр дополнительных параметров ввода](mrlearning-base-ch5.md)
