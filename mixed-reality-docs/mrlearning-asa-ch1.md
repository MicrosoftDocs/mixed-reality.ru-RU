---
title: Учебники по пространственной привязке Azure — 1. Приступая к работе с пространственными привязками Azure
description: В рамках этого курса вы узнаете, как реализовать функцию распознавания лиц Azure в приложении смешанной реальности.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.openlocfilehash: ac345ecafee3a09e3b5ad58344310234e60354a1
ms.sourcegitcommit: 2cf3f19146d6a7ba71bbc4697a59064b4822b539
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73926877"
---
# <a name="1-getting-started-with-azure-spatial-anchors"></a>1. Приступая к работе с пространственными привязками Azure

Добро пожаловать во второй модуль учебников HoloLens 2. Прежде чем приступить к работе, убедитесь, что выполнены все [необходимые условия](https://docs.microsoft.com//azure/spatial-anchors/quickstarts/get-started-unity-hololens) . Если вы еще не выполнили первый [базовый модуль](mrlearning-base.md) , рекомендуется сначала выполнить этот модуль. Если вы начинаете с нового проекта Unity, выполните шаги по созданию нового проекта в [базовом модуле](mrlearning-base.md). 

## <a name="objectives"></a>Задачи

* Изучите основы разработки с помощью пространственных привязок Azure с помощью HoloLens 2

* Создание, передача и скачивание пространственных привязок

## <a name="instructions"></a>Инструкция

### <a name="downloading-and-importing-assets"></a>Загрузка и импорт ресурсов
Прежде чем начать, скачайте и импортируйте следующие ресурсы:

[Пространственные привязки Azure v 1.1.0](https://github.com/Azure/azure-spatial-anchors-samples/releases/download/v1.1.0/AzureSpatialAnchors.unitypackage)

[Пакет ресурсов для модуля MR версии 1.2](https://github.com/microsoft/MixedRealityLearning/releases/download/1.2/BaseModuleAssets-1.2.unitypackage)

[Пакет средств ASA Pack 1.3.1 версии v](https://github.com/Developer-OI/MixedRealityLearning/releases/download/ASA_1.3/ASAModuleAssets_1.3.1.unitypackage)

[2.1.0 пакета набора средств Mixed Reality Foundation](https://github.com/microsoft/MixedRealityToolkit-Unity/releases/tag/v2.1.0)

1. Создайте в проекте новую сцену. Щелкните правой кнопкой мыши папку сцены, выберите пункт Создать, а затем — сцена. Присвойте новой сцене имя "Асалеарнингмодуле".

![module2chapter1step1im](images/module2chapter1step1im.PNG)

2. Дважды щелкните сцену "Асалеарнингмодуле", чтобы увидеть некоторые предварительно определенные элементы, которые будут отображаться вместе с новой сценой. 
3. Настройка сцены для разработки смешанной реальности. 

![module2chapter1step3im](images/module2chapter1step3im.PNG)

> Примечание. при выборе [профиля для набора средств Mixed Reality](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/Profiles/Profiles.html)может отобразиться всплывающее диалоговое окно. Выберите профиль с именем *DefaultHoloLens2ConfigurationProfile* , дважды щелкнув его.

4. При выборе файла для МРТК выберите Дефаултмикседреалититулкитконфигуратионпрофиле.

> Примечание. Если у вас есть собственный профиль конфигурации, вы можете использовать его вместо него.
>

![module2chapter1step4im](images/module2chapter1step4im.PNG)

Теперь сцена настроена для смешанной реальности. Убедитесь, что вы сохранили сцену (сделайте это с помощью элемента управления/команды + S или щелкните файл, а затем щелкните Сохранить). 

5. Импортируйте пакет Unity для [пространственных привязок Azure v 1.1.0](https://github.com/Azure/azure-spatial-anchors-samples/releases/download/v1.1.0/AzureSpatialAnchors.unitypackage) , скачанный на шаге 1. Для этого щелкните ресурсы, перейдите к разделу Импорт пакета. Затем щелкните пользовательский пакет... Файлы компьютера будут открыты. После этого найдите место сохранения пакета пространственных привязок Azure и выберите его. Затем нажмите кнопку Открыть.

![module2chapter1step5bim](images/module2chapter1step5bim.PNG)

Появится всплывающее окно с перечнем средств и параметров и запросом на импорт. Выберите ***все*** доступные параметры, а затем нажмите кнопку Импорт.

![module2chapter1step5cim](images/module2chapter1step5cim.PNG)

> Примечание. Вы сможете выполнить импорт, подождите несколько минут. 

6. Далее следует импортировать [Пакет ресурсов модуля MR](https://github.com/microsoft/MixedRealityLearning/releases/tag/1.2) . Подобно шагу 5, вернитесь к Unity, щелкните активы и наведите указатель на пункт Импорт пакета. Щелкните пользовательский пакет... Файлы компьютера будут отображаться снова. Перейдите к месту, где вы сохранили пакет ресурсов основного модуля. и выберите его. Нажмите кнопку "Открыть".

![module2chapter1step5bim](images/module2chapter1step5bim.PNG)

> Примечание. позже в этом модуле могут потребоваться дополнительные ресурсы. Выполните следующие действия, чтобы импортировать все активы, упомянутые на этом этапе. 

7. Импортируйте [пакет модуля ASA 1.3.1](https://github.com/Developer-OI/MixedRealityLearning/releases/download/ASA_1.3/ASAModuleAssets_1.3.1.unitypackage) , выполнив те же действия, что и при импорте других предыдущих пакетов.

### <a name="configuring-your-scene"></a>Настройка сцены

В этом разделе мы добавим Prefabs и сценарии в сцену, чтобы создать ряд кнопок, демонстрирующих принципы поведения как локальных, так и пространственных привязок Azure в приложении.

8. На вкладке проект под папкой активы щелкните Асамодулеассетс. После выбора вы увидите два Prefabs: Буттонпарент и Парентанчор.

![module2chapter1step7im](images/module2chapter1step7im.PNG)

9. Перетащите оба Prefabs в сцену. 

![module2chapter1step8im](images/module2chapter1step8im.PNG)

Примечание. После добавления Буттонпарент в сцену появится всплывающее окно с запросом на импорт ресурсов TMP. Импортируйте "TMP Essentials". После этого, если в сцене отображается текст крупного шрифта, удалите объект Буттонпарент и добавьте его снова из папки Асамодулеассетс.

Примечание. Если вы хотите проверить журналы отладки в HoloLens. Можно перетащить DebugWindow prefab из папки Асамодулеассетс в сцену. Присоедините сценарий Дебугвиндовмессагинг на панели инспектора DebugWindow и включите параметр окно отладки включено. После этого перетащите DebugWindow prefab в Дебугтекст пустое поле. Можно также настроить расположение DebugWindow в любом месте, где это нужно.

10. Чтобы увеличить сцену, дважды щелкните родительскую привязку в иерархии и настройте представление для просмотра всей сцены по мере необходимости. В настоящее время Парентанчор — это цветной куб, используемый только для демонстрационных целей. Со временем мы будем скрывать куб и размещать наше содержимое в качестве дочернего элемента Парентанчор. 

11. Теперь можно настроить кнопки для работы с сценой. Для этого разверните Буттонпарент prefab и обратите внимание на несколько кнопок с метками. Эти кнопки создаются из МРТК Прессаблебуттон Prefabs. Дополнительные сведения о создании Прессаблебуттон из [базового модуля](mrlearning-base-ch2.md). Чтобы эти кнопки работали, необходимо добавить событие, которое будет запускаться при нажатии пользователем или выборе отдельных кнопок. 

- Для кнопки с именем Стартазуресессион создайте новое событие под нажатой кнопкой события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Стартазуресессион () из компонента Асамодулескрипт объекта Парентанчор, как показано на снимке экрана ниже.
- ![module2chapter1step10aim](images/module2chapter1step10aim.PNG)

![module2chapter1step10bim](images/module2chapter1step10bim.PNG)

![module2chapter1step10cim](images/module2chapter1step10fim.PNG)

- Для имени кнопки Стопазуресессион создайте новое событие под нажатой кнопкой мыши триггер события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Стопазуресессион () из компонента Асамодулескрипт объекта Парентанчор.

- Для кнопки с именем Креатеанчор создайте новое событие под нажатой кнопкой события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Креатеазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.  **После этого перетащите Парентанчор в следующее пустое поле "игровой объект".**

- Для кнопки с именем Начните поиск привязки, создайте новое событие под нажатием кнопки "триггер события", а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Финдазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.

- Для кнопки с именем Делетеазуреанчор создайте новое событие под нажатой кнопкой события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Делетеазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.  

- Для кнопки с именем удалите локальную привязку, создайте новое событие при нажатии кнопки триггер события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Ремовелокаланчор () из компонента Асамодулескрипт объекта Парентанчор. **После этого перетащите объект Парентанчор в следующее пустое поле "игровой объект".**

12. Чтобы настроить пространственные привязки Azure, перейдите в папку Азуреспатиаланчорсплугин в папке Assets и перейдите к примерам — > Resources-> файл Азуреспатиаланчорсдемоконфиг. На панели инспектора добавьте идентификатор учетной записи Azure и ключ учетной записи, созданные ранее. Если вы не создали их или не сделали, выполните [необходимые условия](https://docs.microsoft.com//azure/spatial-anchors/quickstarts/get-started-unity-hololens). 

  ![module2chapter1step13im](images/module2chapter1step13im.PNG)

### <a name="build-and-demonstrate-base-application"></a>Сборка и демонстрация базового приложения

Теперь, когда сцена настроена для демонстрации основ пространственных привязок Azure, мы создадим и демонстрируем базовое поведение пространственных привязок Azure. 

1. Снова откройте окно параметры сборки, перейдя в файл > параметры сборки.
    ![мрлеарнинг-ASA-CH1-3-шаг 1](images/mrlearning-asa-ch1-3-step1.jpg)
2. Убедитесь, что сцена, которую вы хотите использовать, находится в списке "сцены в сборке", нажав кнопку Добавить открытые сцены.
3. Убедитесь, что для платформы задано значение универсальная платформа Windows. В противном случае задайте то же значение.
4. Нажмите кнопку Параметры проигрывателя и выберите Параметры публикации. В разделе возможности включите: Интернет, Интернет-сервер, клиент, частный сетевой сервер, съемные ЗУ, веб-камера, микрофон и пространственное восприятие.
5. В том же параметрах проигрывателя перейдите к параметрам XR и выберите Виртуальная реальность, поддерживаемая в ON.
6. Нажмите кнопку Build (Сборка), чтобы начать процесс сборки.
   ![мрлеарнинг-ASA-CH1-3-шаг 6](images/mrlearning-asa-ch1-3-step6.jpg)
7. Создайте папку для приложения и укажите для нее название. На приведенном ниже рисунке создано папка с именем App, в которой будет содержаться приложение. Щелкните Выбрать папку, чтобы начать сборку в только что созданную папку. После завершения сборки вы можете закрыть окно параметров сборки в Unity.

    ![мрлеарнинг-ASA-CH1-3-Step7](images/mrlearning-asa-ch1-3-step7.jpg)

    > Примечание. Если сборка завершается неудачно, попробуйте повторить сборку или перезапустить Unity и выполнить сборку снова. Если отображается ошибка, например "ошибка: CS0246 = не удалось найти тип или имя пространства имен" XX "(возможно, отсутствует директива using или ссылка на сборку). Возможно, потребуется установить [пакет SDK для Windows 10 (10.0.18362.0)](<https://developer.microsoft.com//windows/downloads/windows-10-sdk>) . 


8. Даже после успешной сборки могут возникнуть некоторые ошибки, как показано ниже, но если сборка прошла успешно, можно пропустить их и перейти к дальнейшим действиям.

    ![мрлеарнинг-ASA-CH1-3-step7B](images/mrlearning-asa-ch1-3-step7B.png)

    

9. После завершения сборки откройте созданную папку, содержащую файлы только что созданного приложения. Дважды щелкните решение "Микседреалитибасе. sln" или соответствующее имя. Если вы использовали другое имя для проекта, чтобы открыть файл решения в Visual Studio.

    > Примечание. Откройте только что созданную папку (т. е. папку приложения, если следовать соглашениям об именовании из предыдущих шагов, так как файл с расширением SLN будет находиться за пределами этой папки, который не следует путать с файлом. sln в папке Build.

    ![мрлеарнинг-ASA-CH1-3-Step8](images/mrlearning-asa-ch1-3-step8.jpg)

    > Примечание. Если Visual Studio запрашивает установку новых компонентов, уделите несколько минут, чтобы убедиться, что все необходимые компоненты установлены согласно требованиям на [странице "Установка средств"](install-the-tools.md) .


9. Подключите HoloLens 2 к компьютеру с помощью USB-кабеля. Хотя в этих инструкциях урока предполагается, что вы будете развертывать тестирование на устройстве HoloLens 2, вы также можете выбрать развертывание в [эмуляторе hololens 2](using-the-hololens-emulator.md) или создать [пакет приложения для загрузки неопубликованных приложений](<https://docs.microsoft.com//windows/uwp/packaging/packaging-uwp-apps>) .

10. Перед выполнением сборки для устройства включите на нем режим разработчика. Если вы впервые используете HoloLens 2, в Visual Studio может появиться запрос на подключение к HoloLens 2 с использованием PIN-кода. Если необходимо включить режим разработчика или пару с Visual Studio, следуйте [этим инструкциям](https://docs.microsoft.com//windows/mixed-reality/using-visual-studio) .

11. Настройте Visual Studio для сборки в HoloLens 2, выбрав конфигурацию выпуска, а также архитектуру ARM.

    ![мрлеарнинг-ASA-CH1-3-step11](images/mrlearning-asa-ch1-3-step11.jpg)


12. Последний шаг — выполнить сборку на устройстве, выбрав Отладка > начать без отладки. Выбор команды Запуск без отладки приводит к немедленному запуску приложения на устройстве после успешной сборки без отладочной информации в Visual Studio. Это также означает, что вы можете отсоединить USB-кабель во время выполнения приложения на устройстве HoloLens 2, не прерывая его работу. Вы также можете выбрать сборка > развернуть решение для развертывания на устройстве без автоматического запуска приложения.

    ![мрлеарнинг-ASA-CH1-3-step12](images/mrlearning-asa-ch1-3-step12.jpg)

>Примечание. Пространственные привязки Azure используют Интернет для сохранения и загрузки данных привязки, поэтому перед тестированием приложения ASA убедитесь, что устройство подключено к Интернету.

13. Следуйте инструкциям. 
    При запуске приложения на устройстве следуйте инструкциям на экране. Нажмите кнопки сцены, соответствующие приведенным ниже шагам. Если вы добавили окно отладки, как упоминалось на предыдущих шагах, можно увидеть отзыв для отдельных нажатий кнопки и ход выполнения отдельных операций, связанных с пространственными привязками Azure.

![module2chapter1step10eim](images/module2chapter1step10eim.PNG)
    
    1. Запустите сеанс пространственных привязок.
    
    2. Переместить куб в другое расположение.
    
    3. Сохраните пространственные привязки Azure в расположении Куба.
    
    4. Останавливает сеанс пространственных привязок Azure.
    
    5. Удалите локальную привязку Куба, чтобы разрешить пользователю перемещать куб.
    
    6. Переместите куб в другое место.
    
    7. Запустите сеанс пространственных привязок Azure.
    
    8. Поиск пространственных привязок Azure. 
    Следует вернуться к исходному расположению, которое вы поместили при создании привязки.
    
    9. Удалите пространственный якорь Azure.
    
    10. Останавливает сеанс Azure.

### <a name="anchoring-an-experience"></a>Привязка интерфейса

В предыдущих разделах вы узнали основы пространственных привязок Azure. Мы использовали куб для представления и визуализации родительского объекта Game с присоединенной привязкой. В этом разделе вы узнаете, как закрепить весь интерфейс, поместив его в качестве дочернего элемента объекта Парентанчор. В этом примере используется демонстрационное приложение для работы с лунной сборкой, созданное во время [занятия 6](mrlearning-base-ch6.md).

1. Выполните поиск по фразе "Rocket Launcher Complete" prefab и перетащите его в иерархию как дочерний объект, как показано на рисунке ниже.

![module2chapter1step11](images/module2chapter1step11im.PNG)

2. Поместите интерфейс сборки модуля, чтобы куб по-прежнему был доступен, как показано на рисунке ниже. В приложении пользователи могут передвинуть весь процесс, переместив куб. 

![module2chapter1step12im](images/module2chapter1step12im.PNG)

> Примечание. Существует множество потоков взаимодействия с пользователем для изменения положения, включая использование кнопки для переключения ограничивающего прямоугольника, окружающего интерфейс, использование объекта изменения положения (такого как куб, используемый на этом шаге), использование положения и вращения. приспособлений и многое другое.

## <a name="congratulations"></a>Поздравляем!
В этом руководстве вы узнали основы пространственных привязок Azure. На этом занятии приводятся несколько кнопок, позволяющих изучить различные шаги, необходимые для запуска и завершения сеанса Azure, а также создавать, отправлять и скачивать привязки Azure на одном устройстве. На следующем занятии мы научитесь сохранять идентификаторы привязки Azure в HoloLens 2 для получения, даже после перезапуска приложения. В ходе серии вы также узнаете, как передавать идентификаторы привязки между несколькими устройствами для достижения пространственного выравнивания и изучать многопользовательские общие сеансы в рамках учебника по совместному использованию.

[Следующее занятие: 2. сохранение, получение и совместное использование пространственных привязок Azure](mrlearning-asa-ch2.md)

