---
title: Модуль MR Learning ASA. пространственный якорь Azure в HoloLens 2
description: В рамках этого курса вы узнаете, как реализовать функцию распознавания лиц Azure в приложении смешанной реальности.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.openlocfilehash: 690ece3a02aeefd598db18baa66de3ddabfa43eb
ms.sourcegitcommit: 611af6ff7a2412abad80c0c7d4decfc0c3a0e8c8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/17/2019
ms.locfileid: "68293818"
---
# <a name="1-getting-started-with-azure-spatial-anchors"></a>1. Приступая к работе с пространственными привязками Azure

Добро пожаловать во второй модуль учебников HoloLens 2. Прежде чем приступить к работе, убедитесь, что выполнены все [необходимые условия](https://docs.microsoft.com/en-us/azure/spatial-anchors/quickstarts/get-started-unity-hololens) . Если вы еще не выполнили первый [базовый модуль](mrlearning-base.md) , рекомендуется сначала выполнить этот модуль. Если вы начинаете с нового проекта Unity, выполните шаги по созданию нового проекта в [базовом модуле](mrlearning-base.md). 

## <a name="objectives"></a>Цели

* Изучите основы разработки с помощью пространственных привязок Azure с помощью HoloLens 2

* Создание, передача и скачивание пространственных привязок

## <a name="instructions"></a>Инструкция

### <a name="downloading-and-importing-assets"></a>Загрузка и импорт ресурсов
Прежде чем начать, скачайте и импортируйте следующие ресурсы:

[Пространственные привязки Azure](https://github.com/azure/azure-spatial-anchors-samples/releases)

[Пакет ресурсов основного модуля MR](https://github.com/microsoft/MixedRealityLearning/releases/tag/1.2)

[Пакет ресурсов для модуля ASA](https://github.com/microsoft/MixedRealityLearning/releases/tag/ASA_1.1)

[Набор средств для смешанной реальности](https://github.com/microsoft/MixedRealityToolkit-Unity/releases/)

> Примечание. Конкретные инструкции по импорту пространственных привязок Azure см. в шаге 6 для получения конкретных инструкций по пакету ресурсов и шаги с 3 по 4 для конкретных инструкций в наборе средств для смешанной реальности (МРКТ).

1. Создайте в проекте новую сцену. Щелкните правой кнопкой мыши папку сцены, выберите пункт Создать, а затем — сцена. Назовите новую сцену Асалеарнингмодуле.

![module2chapter1step1im](images/module2chapter1step1im.PNG)

2. Дважды щелкните Асалеарнингмодуле, чтобы увидеть некоторые предварительно определенные элементы вместе с новой сценой. 
3. Настройка сцены для разработки смешанной реальности. 

![module2chapter1step3im](images/module2chapter1step3im.PNG)

> Примечание. Вы увидите всплывающее окно с текстом, необходимо выбрать файл для набора средств Mixed Reality. Нажав кнопку ОК, вы перевернетесь к шагу 4.

4. При выборе файла для МРТК выберите Дефаултмикседреалититулкитконфигуратионпрофиле.

> Примечание. Если у вас есть собственный профиль конфигурации, вы можете использовать его вместо него.

![module2chapter1step4im](images/module2chapter1step4im.PNG)

Теперь сцена настроена для смешанной реальности. Убедитесь, что вы сохранили сцену (сделайте это с помощью элемента управления/команды + S или щелкните файл, а затем щелкните Сохранить). 

5. Импортируйте [Пространственные привязки Azure](https://github.com/azure/azure-spatial-anchors-samples/releases). Чтобы использовать пространственные привязки, необходимо импортировать этот ресурс. Щелкните приведенную выше ссылку и щелкните правой кнопкой мыши Азуреспатиаланчорс. пакет unitypackage. Щелкните Сохранить конечный объект и сохраните его на компьютере. 

![module2chapter1step5aim](images/module2chapter1step5aim.PNG)

После сохранения вернитесь в Unity, щелкните активы, перейдите к разделу Импорт пакета. Затем щелкните пользовательский пакет... Файлы компьютера будут открыты. После этого найдите место сохранения пакета пространственных привязок Azure и выберите его. Затем нажмите кнопку Открыть.

![module2chapter1step5bim](images/module2chapter1step5bim.PNG)

Появится всплывающее окно, провидингг список средств и параметров, и запросите, что нужно импортировать. Выберите ***все*** доступные параметры, а затем нажмите кнопку Импорт.

![module2chapter1step5cim](images/module2chapter1step5cim.PNG)

> Примечание. Подождите, импорт будет выполняться через несколько минут. 

6. Далее импортируйте [пакет ресурсов основного модуля https://github.com/microsoft/MixedRealityLearning/releases/tag/1.2) MR]. Подобно шагу 5, щелкните ссылку выше. Затем щелкните правой кнопкой мыши BasemoduleAssetsV1 1. унитипаккаг и выберите пункт Сохранить объект как и сохраните его на компьютере.

![module2chapter1step6aim](images/module2chapter1step6aim.PNG)

> Совет. Сохраните все эти ресурсы в той же папке, чтобы упростить их поиск и доступ к. Он обеспечивает все приятные и организованные возможности.

Как и шаг 5, вернитесь к Unity, щелкните активы и наведите указатель на пункт Импорт пакета. Щелкните пользовательский пакет... Файлы компьютера будут отображаться снова. Перейдите к месту, где вы сохранили пакет ресурсов основного модуля. и выберите его. Нажмите кнопку "Открыть".

![module2chapter1step5bim](images/module2chapter1step5bim.PNG)

> Примечание. Позже в этом модуле могут потребоваться дополнительные ресурсы. Выполните следующие действия, чтобы импортировать все активы, упомянутые на этом этапе. 

7. Импортируйте [пакет модуля ASA](https://github.com/microsoft/MixedRealityLearning/releases/tag/ASA_1.1) , используя тот же подход, что и при импорте предыдущих пакетов.

### <a name="configuring-your-scene"></a>Настройка сцены

В этом разделе мы добавим Prefabs и сценарии в сцену, чтобы создать ряд кнопок, демонстрирующих принципы поведения как локальных, так и пространственных привязок Azure в приложении.

8. На вкладке проект под папкой активы щелкните Асамодулеассетс. После выбора вы увидите два Prefabs: Буттонпарент и Парентанчор.

![module2chapter1step7im](images/module2chapter1step7im.PNG)

9. Перетащите оба Prefabs в сцену. 

![module2chapter1step8im](images/module2chapter1step8im.PNG)

10. Дважды щелкните родительскую привязку, чтобы выбрать ее. Возможно, потребуется настроить представление, чтобы увидеть всю сцену. При необходимости настройте сцену.

Ознакомьтесь с Парентанчор prefab. В настоящее время объект Game с именем, Парентанчор, является цветным кубом для демонстрационных целей. Со временем мы будем скрывать куб и размещать наше содержимое в качестве дочернего элемента Парентанчор. Этот prefab включает скрипт AzureSpatialAnchorsDemoWrapper.cs (входящий в состав пакета SDK для ASA) и скрипт ASAmoduleScript.cs, включенный в состав этого модуля в объект Парентанчор. 

11. Настройте кнопки. В разделе Буттонпарент prefab Обратите внимание на несколько кнопок с метками. Эти кнопки создаются из МРТК Прессаблебуттон Prefabs. Дополнительные сведения о создании нажатых кнопок из [базового модуля](mrlearning-base-ch2.md). Для каждой кнопки добавьте событие, которое будет запускаться при нажатии пользователем или выборе кнопки в соответствии со списком ниже. 

- Для кнопки с именем Стартазуресессион создайте новое событие под нажатой кнопкой события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Стартазуресессион () из компонента Асамодулескрипт объекта Парентанчор.

![module2chapter1step10aim](images/module2chapter1step10aim.PNG)

![module2chapter1step10bim](images/module2chapter1step10bim.PNG)

![module2chapter1step10cim](images/module2chapter1step10fim.PNG)

- Для имени кнопки Стопазуресессион создайте новое событие под нажатой кнопкой мыши триггер события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Стопазуресессион () из компонента Асамодулескрипт объекта Парентанчор.

- Для кнопки с именем Креатеанчор создайте новое событие под нажатой кнопкой события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Креатеазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.

- Для кнопки с именем Начните поиск привязки, создайте новое событие под нажатием кнопки "триггер события", а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Финдазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.

- Для кнопки с именем Делетеазуреанчор создайте новое событие под нажатой кнопкой события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Делетеазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.

- Для кнопки с именем удалите локальную привязку, создайте новое событие при нажатии кнопки триггер события, а также триггер события On Click. Перетащите объект Парентанчор в пустое поле и назначьте метод Ремовелокаланчор () из компонента Асамодулескрипт объекта Парентанчор.

### <a name="build-and-demonstrate-base-application"></a>Сборка и демонстрация базового приложения

Теперь, когда сцена настроена для демонстрации основ пространственных привязок Azure, мы создадим и демонстрируем базовое поведение пространственных привязок Azure. 

1. Если вы закрыли окно Build Settings (Параметры сборки), открытое в предыдущих разделах, снова откройте его, выбрав File (Файл) > Build Settings (Параметры сборки).
![Lesson1Chapter5Step1](images/Lesson1Chapter5Step1.JPG)

2. Убедитесь, что сцена, которую вы хотите использовать, находится в списке "сцены в сборке", нажав кнопку Добавить открытые сцены.

3. Нажмите кнопку Build (Сборка), чтобы начать процесс сборки.
![Lesson1Chapter5Step3](images/Lesson1Chapter5Step3.JPG)

4. Создайте папку для приложения и укажите для нее название. На приведенном ниже рисунке создано папка с именем App, в которой будет содержаться приложение. Щелкните Выбрать папку, чтобы начать сборку в только что созданную папку. После завершения сборки вы можете закрыть окно параметров сборки в Unity. 
![Lesson1Chapter5Step4](images/Lesson1Chapter5Step4.JPG)

  > ПРИМЕЧАНИЕ. Если сборка завершилась сбоем, попробуйте выполнить ее заново или перезапустите Unity и повторите попытку. Если отображается ошибка типа Error: CS0246 = не удалось найти тйое или имя пространства имен "XX" (возможно, отсутствует директива using или ссылка на сборку). Возможно, потребуется установить [пакет SDK для Windows 10 (10.0.18362.0)](<https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk>) . 
  >

5. После завершения сборки откройте созданную папку, содержащую файлы только что созданного приложения. Дважды щелкните решение "Микседреалитибасе. sln" или соответствующее имя. Если вы использовали другое имя для проекта, чтобы открыть файл решения в Visual Studio.

  > Примечание. Не забудьте открыть только что созданную папку (т. е. папку приложения, если следовать соглашениям об именовании из предыдущих шагов, так как файл с расширением SLN находится за пределами этой папки, который не следует путать с файлом. sln в папке Build. 

![Lesson1Chapter5Step5](images/Lesson1Chapter5Step5.JPG)

> Примечание. Если Visual Studio запрашивает установку новых компонентов, уделите некоторое время установке всех необходимых компонентов в соответствии с требованиями на [странице "Установка средств"](install-the-tools.md) . 

6. Подключите HoloLens 2 к компьютеру с помощью USB-кабеля. Хотя в этих инструкциях урока предполагается, что вы будете развертывать тестирование на устройстве HoloLens 2, вы также можете выбрать развертывание в [эмуляторе hololens 2](using-the-hololens-emulator.md) или создать [пакет приложения для загрузки неопубликованных приложений](<https://docs.microsoft.com/en-us/windows/uwp/packaging/packaging-uwp-apps>) .

7. Перед выполнением сборки для устройства включите на нем режим разработчика. Если вы впервые используете HoloLens 2, в Visual Studio может появиться запрос на подключение к HoloLens 2 с использованием PIN-кода. Если необходимо включить режим разработчика или пару с Visual Studio, следуйте [этим инструкциям](https://docs.microsoft.com/en-us/windows/mixed-reality/using-visual-studio) .

8. Настройте Visual Studio для сборки в HoloLens 2, выбрав конфигурацию выпуска, а также архитектуру RM.
![Lesson1Chapter5Step8](images/Lesson1Chapter5Step8.JPG)
   
9. Последний шаг — выполнить сборку на устройстве, выбрав Отладка > начать без отладки. Выбор команды Запуск без отладки приводит к немедленному запуску приложения на устройстве при успешном завершении отладки исаут отладочной информации, отображаемой в Visual Studio. Это также означает, что вы можете отсоединить USB-кабель во время выполнения приложения на устройстве HoloLens 2, не прерывая его работу. Вы также можете выбрать сборка > развернуть решение для развертывания на устройстве без автоматического запуска приложения.
![Lesson1Chapter5Step9](images/Lesson1Chapter5Step9.JPG)
   
10. Следуйте инструкциям. При запуске приложения на устройстве следуйте инструкциям на экране. Нажмите кнопки сцены, соответствующие приведенным ниже шагам.

![module2chapter1step10eim](images/module2chapter1step10eim.PNG)
    
    1. Запустите сеанс пространственных привязок.
    
    2. Переместить куб в другое расположение.
    
    3. Сохраните пространственные привязки Azure в расположении Куба.
    
    4. Останавливает сеанс пространственных привязок Azure.
    
    5. Удалите локальную привязку Куба, чтобы разрешить пользователю перемещать куб.
    
    6. Переместите куб в другое место.
    
    7. Запустите сеанс пространственных привязок Azure.
    
    8. Поиск пространственных привязок Azure. 
    Следует вернуться к исходному расположению, которое вы поместили при создании привязки.
    
    9. Удалите пространственный якорь Azure.
    
    10. Останавливает сеанс Azure.

### <a name="anchoring-an-experience"></a>Привязка интерфейса

В предыдущих разделах вы узнали основы пространственных привязок Azure. Мы использовали куб для представления и визуализации родительского объекта Game с присоединенной привязкой. В этом разделе вы узнаете, как закрепить весь интерфейс, поместив его в качестве дочернего элемента объекта Парентанчор. В этом примере используется демонстрационное приложение для работы с лунной сборкой, созданное во время [занятия 6](mrlearning-base-ch6.md).

1. Найдите сборку модуля лунного календаря полностью prefab и перетащите ее в иерархии в качестве дочернего элемента Анчорпарент gameobject, как показано на рисунке ниже.

![module2chapter1step11](images/module2chapter1step11im.PNG)

2. Поместите интерфейс сборки модуля, чтобы куб по-прежнему был доступен, как показано на рисунке ниже. В приложении пользователи могут передвинуть весь процесс, переместив куб. 

![module2chapter1step12im](images/module2chapter1step12im.PNG)

> Примечание. Существует множество потоков взаимодействия с пользователем для изменения положения, в том числе использование кнопки для переключения ограничивающего прямоугольника, который окружает интерфейс, использует объект изменения положения (например, куб, используемый на этом шаге), использование положения и вращения приспособлений и многое другое.

## <a name="congratulations"></a>Поздравляем!
В этом руководстве вы узнали основы пространственных привязок Azure. Этот ессон предоставляет несколько кнопок, позволяющих изучить различные шаги, необходимые для запуска и завершения сеанса Azure, а также создавать, отправлять и скачивать привязки Azure на одном устройстве. На следующем занятии мы научитесь сохранять идентификаторы привязки Azure в HoloLens 2 для получения, даже после перезапуска приложения. В ходе серии вы также узнаете, как передавать идентификаторы привязки между несколькими устройствами для достижения пространственного выравнивания и изучать многопользовательские общие сеансы в рамках учебника по совместному использованию.

[Следующий урок. ASA, урок 2](mrlearning-asa-ch2.md)

