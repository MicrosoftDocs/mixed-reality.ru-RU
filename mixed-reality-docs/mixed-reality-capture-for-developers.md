---
title: Смешанный реальности записи для разработчиков
description: Советы и рекомендации для смешанной реальности записи для разработчиков.
author: mattzmsft
ms.author: mazeller
ms.date: 02/24/2019
ms.topic: article
keywords: MRC, фото, видео, записи, камера
ms.openlocfilehash: c2d98baf16b2ea724247224aabadc1e2ca533ec1
ms.sourcegitcommit: 384b0087899cd835a3a965f75c6f6c607c9edd1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/12/2019
ms.locfileid: "59599456"
---
# <a name="mixed-reality-capture-for-developers"></a>Смешанный реальности записи для разработчиков

> [!NOTE]
> Дополнительные рекомендации, относящиеся к HoloLens 2 [ожидается в ближайшее время](index.md#news-and-notes). 

См. в разделе [Включение MRC в приложении](#enabling-mrc-in-your-app) ниже рекомендации по новую возможность MRC для HoloLens 2.

Так как пользователь может воспользоваться [смешанный захвата реальности](mixed-reality-capture.md) photo (MRC) или видео в любое время, существует несколько действий, которые следует помнить при разработке приложения. Сюда входят рекомендации по MRC качества и выполняется быстро реагировать на изменения системы, хотя MRCs фиксируются.

Разработчики могут также легко интегрировать захват смешанной реальности и вставки в свои приложения.

MRC на HoloLens (первого) поддерживает видео и фотографии до 720p, хотя MRC HoloLens 2 поддерживает видео до 1080 p и фотографии до разрешением 4 K.

## <a name="the-importance-of-quality-mrc"></a>Важность качества MRC

Смешанная реальность собираются фотографии и видео, вероятно, являются первый опыт работы, у пользователя приложения. Нужно ли как смешанной реальности снимки экрана, на странице Microsoft Store или из других пользователей, совместно использующих MRCs в социальных сетях. Можно использовать MRC демонстрационное приложение, расскажите пользователям, порекомендуйте пользователям совместно использовать их взаимодействия смешанной среде и для пользователя исследований и решение проблем.

## <a name="how-mrc-impacts-your-app"></a>Как MRC влияет на приложения

### <a name="enabling-mrc-in-your-app"></a>Включение MRC в приложении

По умолчанию приложения не выполняет никаких действий, чтобы пользователи могли воспользоваться захваты смешанной реальности. Тем не менее, разработки HoloLens 2 увеличивается, расстояние от камеры фото и видео (PV) и отображением, мы включим новый параметр, позволяющий создать 3-й отрисовки камеры, выровненным по камеры PV **HoloLens 2**. 

Желанию в 3-й камеры визуализацию предложениями для HoloLens 2 следующие улучшения в MRC взаимодействия по умолчанию:
* Голограмма выравнивание для физической среды и руки (для взаимодействия практически) должно быть точным вообще расстояния, вместо того смещение на расстоянии, отличное от [сосредоточиться точки](focus-point-in-unity.md) как можно увидеть в MRC по умолчанию.
* Правом глаза в гарнитура не будут скомпрометированы, так как оно не будет использоваться для подготовки к просмотру голограммы для выходных данных MRC.

### <a name="disabling-mrc-in-your-app"></a>Отключение MRC в приложении

Если используется двухмерная приложения [DXGI_PRESENT_RESTRICT_TO_OUTPUT](https://msdn.microsoft.com/library/windows/desktop/bb509554(v=vs.85).aspx) или [DXGI_SWAP_CHAIN_FLAG_HW_PROTECTED](https://msdn.microsoft.com/library/windows/desktop/bb173076(v=vs.85).aspx) Показать защищенное содержимое с цепочку правильно настроенный обмена, будет визуального содержимого приложения автоматически закрывать друг друга во время захвата смешанной реальности.

### <a name="knowing-when-mrc-is-active"></a>Зная, когда активно MRC

[AppCapture](https://msdn.microsoft.com/library/windows/apps/windows.media.capture.appcapture.aspx) класс может использоваться приложением знать, когда выполняется смешанный реальности записи системы (для аудио или видео).

>[!NOTE]
>В AppCapture [GetForCurrentView](https://msdn.microsoft.com/library/windows/apps/windows.media.capture.appcapture.getforcurrentview.aspx) API может возвращать значение null, если смешанный реальности записи не поддерживается на устройстве. Также важно отменять регистрацию CapturingChanged событие при приостановке приложения, в противном случае MRC можно получить в блокированном состоянии.

### <a name="best-practices-hololens-specific"></a>Рекомендации (стандартом HoloLens)

MRC должен работать без дополнительных действий со стороны разработчиков, но есть несколько моментов, которые следует учитывать для предоставления интерфейса захвата лучше всего смешанной реальности вашего приложения.

**MRC использует голограмма альфа-канал для использования вместе со [камеры](locatable-camera.md) изображениях**

Наиболее важным шагом является убедитесь, что приложение Очистка прозрачный черный цвет вместо Очистка непрозрачный черный цвет. В Unity это можно сделать, по умолчанию с MixedRealityToolkit, но если разработка ведется в среде не Unity, может потребоваться внести изменения одной строки.

Ниже приведены некоторые артефакты, которые можно встретить в MRC, если приложения без очистки прозрачный черный цвет.

**Пример ошибки**: Края черного вокруг содержимого (сбой снимите прозрачный черный цвет)

<table>
<tr>
<td>
<img src="images/chessboardblackedges-300px.jpg" alt="Failing to clear to transparent black: black edge artifacts around holograms"/>
</td>
<td>
<img src="images/fieldblackedges-300px.jpg" alt="Failing to clear to transparent black: black edge artifacts around holograms"/>
</td>
</tr>
</table>

**Пример ошибки**: Вся область фона сцены из она будет черным. При установке фоновой альфа-значения 1 результаты в черном фоне

![При установке фоновой альфа-значения 1 результаты в черном фоне](images/clearopaqueblack-300px.png)

**Ожидаемый результат**: Голограммы отображаются правильно переходом с реальной жизни (ожидаемый результат, если очистка прозрачный черный цвет)

![Ожидаемый результат, если очистка прозрачный черный цвет](images/cleartransparentblack-300px.png)

**Решение**.
* Измените любое содержимое, которое отображается как непрозрачный черный иметь альфа-значение 0.
* Убедитесь, что приложение Очистка прозрачный черный цвет.
* Unity по умолчанию снимите флажок, чтобы автоматически очистить с MixedRealityToolkit, но если это приложение не Unity, следует изменить цвет, используемый с ID3D11DeiceContext::ClearRenderTargetView(). Вы хотите убедиться, что снимите прозрачный черный цвет (0,0,0,0) вместо непрозрачный черный (0,0,0,1).

Теперь можно настроить альфа-значения ресурсов, если вы хотите, но обычно не требуется. В большинстве случаев, MRCs хорошо выглядят без дополнительной настройки. MRC предполагается предумножение альфа-канала. Альфа-значения будет отражаться только при записи MRC.

### <a name="what-to-expect-when-mrc-is-enabled-on-hololens"></a>Что происходит при включении MRC для HoloLens

Ниже применяются для HoloLens (первого) и HoloLens 2, если не указано иное.

* Система будет регулироваться приложением для подготовки к просмотру 30 Гц. Это создает некоторые запас для MRC для запуска, поэтому приложение не нужно сохранять резерв константы бюджета, а также соответствует видеозапись MRC частотой кадров 30 кадров/с
* Голограмма содержимое в глаза справа устройства может не отображаться «sparkle» при записи или потоковой передачи MRC: текст, могут стать более трудным для чтения и краями голограмма может отображаться более jaggy (желанию в 3-й камеры визуализации на **HoloLens 2** позволяет избежать Этот компромисс)
* MRC фотографии и видео, которые будут использовать приложения [сосредоточиться точки](focus-point-in-unity.md) Если это разрешено приложения, который поможет обеспечить голограммы располагаются точно. Для видео поэтому может показаться голограммы медленно переместятся в месте, если глубина точку фокуса значительного изменения сглажен точку фокуса. Голограммы, находящиеся на различные глубины из точку фокуса может появиться смещения из реального мира (см. пример ниже где точку фокуса составляет 2 метров, но голограмма находится на 1 метра).

![Голограммы на 2 метров появится вполне зарегистрированных во всем мире. Голограммы в закрыть или дальней расстояния могут сдвигаться.](images/hologramaccuracydistancemrc-1000px.png)

## <a name="integrating-mrc-functionality-from-within-your-app"></a>Интеграция MRC печать из приложения

Приложение смешанной реальности можно инициировать MRC фото или видео сбора данных в приложении, и записанные содержимое становится доступным в приложение без помещения для устройства «камеры.» Можно создать пользовательский MRC или воспользоваться преимуществами встроенных пользовательский Интерфейс камеры. 

### <a name="mrc-with-built-in-camera-ui"></a>MRC со встроенной камерой пользовательского интерфейса

Разработчики могут использовать *[API пользовательского интерфейса захвата камеры](https://docs.microsoft.com/windows/uwp/audio-video-camera/capture-photos-and-video-with-cameracaptureui)* для получения захваченных пользователя смешанной реальности фото или видео с помощью всего нескольких строк кода.

Этот API запускает встроенной камеры MRC пользовательского интерфейса, из которого пользователь может снять фото или видео и возвращает полученный записи в приложение.  Если вы хотите создать собственный пользовательский Интерфейс камеры, или требуется более низкого уровня доступа к потоку отслеживания, можно создать пользовательские записи захвата смешанной реальности.

### <a name="creating-a-custom-mrc-recorder"></a>Создание пользовательского средства записи MRC

Хотя пользователь всегда может активировать фото или видео, в системе MRC служба системы отслеживания измененных, приложение может потребоваться создание камеры пользовательские приложения, но включает голограммы в потоке камеры так же, как MRC. Это позволяет приложению начать захват от имени пользователя, создавать настраиваемые записи пользовательского интерфейса или настроить параметры MRC для именования несколько примеров.

**HoloStudio добавляет пользовательский MRC камеры с помощью эффектов MRC**

![HoloStudio добавляет пользовательский MRC камеры с помощью эффектов MRC](images/cameraiconholostudio-300px.jpg)

Увидите приложений Unity [Locatable_camera_in_Unity](locatable-camera-in-unity.md) для этого свойства разрешает голограммы.

Другие приложения это можно сделать с помощью [API-интерфейсы Windows Media захвата](https://msdn.microsoft.com/library/windows/apps/windows.media.capture.mediacapture.aspx) для управления камеры и добавления эффекта MRC видео и аудио для включения виртуальной голограммы и звуком в приложения в голосов и видео.

Приложения имеют два варианта, чтобы добавить эффект:
* Старый API: [Windows.Media.Capture.MediaCapture.AddEffectAsync()](https://msdn.microsoft.com/library/windows/apps/br211961.aspx)
* Новые возможности Майкрософт рекомендуется использовать API (Возвращает объект, что позволяет управлять динамические свойства): [Windows.Media.Capture.MediaCapture.AddVideoEffectAsync()](https://msdn.microsoft.com/library/windows/apps/windows.media.capture.mediacapture.addvideoeffectasync.aspx) / [Windows.Media.Capture.MediaCapture.AddAudioEffectAsync()](https://msdn.microsoft.com/library/windows/apps/windows.media.capture.mediacapture.addaudioeffectasync.aspx) , требующую приложению создавать собственную реализацию [IVideoEffectDefinition](https://msdn.microsoft.com/library/windows/apps/windows.media.effects.ivideoeffectdefinition.aspx) и [IAudioEffectDefinition](https://msdn.microsoft.com/library/windows/apps/windows.media.effects.iaudioeffectdefinition.aspx). См. в образце эффект MRC для пример использования.

(Обратите внимание, что эти пространства имен, не распознаваться Visual Studio, но по-прежнему допустимы строки)

Эффект видео MRC (**Windows.Media.MixedRealityCapture.MixedRealityCaptureVideoEffect**)

|  Имя свойства  |  Тип  |  Значение по умолчанию  |  Описание | 
|----------|----------|----------|----------|
|  StreamType  |  UINT32 ([MediaStreamType](https://msdn.microsoft.com/library/windows/apps/windows.media.capture.mediastreamtype.aspx))  |  1 (VideoRecord)  |  Описания какой поток записи, этот эффект применяется для. Звук не доступен. | 
|  HologramCompositionEnabled  |  Логический  |  TRUE  |  Флаг, чтобы включить или отключить голограммы в видеозаписи. | 
|  RecordingIndicatorEnabled  |  Логический  |  TRUE  |  Флаг, чтобы включить или отключить индикатор записи на экране во время записи голограмма. | 
|  VideoStabilizationEnabled  |  Логический  |  FALSE  |  Флаг, чтобы включить или отключить на платформе инспектор HoloLens стабилизации видео. | 
|  VideoStabilizationBufferLength  |  UINT32  |  0  |  Задайте, сколько исторических рамки используются для стабилизации видео. 0 — задержка 0 и почти «бесплатный» с точки зрения мощности и производительности. 15 рекомендуется высочайшего качества (за счет 15 кадров задержки и памяти). | 
|  GlobalOpacityCoefficient  |  float  |  0.9 (HoloLens) 1.0 (Иммерсивных гарнитуры)  |  Задать коэффициент непрозрачности глобального голограмма в диапазоне от 0.0 (полностью прозрачный) до 1.0 (полностью непрозрачный). | 
|  BlankOnProtectedContent  |  Логический  |  FALSE  |  Флаг, чтобы включить или отключить, возвращая пустая рамка, если 2d содержимое защищенных отображение приложения универсальной платформы Windows. Если этот флаг имеет значение false, а также двухмерных приложения универсальной платформы Windows — это отображение защищенные материалы, 2d приложения универсальной платформы Windows будет заменен защищенного содержимого текстуры в обоих гарнитуры и в записи, смешанной реальности. |
|  ShowHiddenMesh  |  Логический  |  FALSE  |  Флаг, чтобы включить или отключить отображение сетки скрытую область holographic камеры и соседних содержимого. |

Эффект аудио MRC (**Windows.Media.MixedRealityCapture.MixedRealityCaptureAudioEffect**)

<table>
<tr>
<th>Имя свойства</th>
<th>Тип</th>
<th>Значение по умолчанию</th>
<th>Описание</th>
</tr>
<tr>
<td>MixerMode</td>
<td>UINT32</td>
<td>2</td>
<td>
<ul>
<li>0 : Только звук MIC</li>
<li>1 : Только системные звуки</li>
<li>2 : MIC и системных звуков</li>
</ul>
</td>
</tr>
</table>

### <a name="simultaneous-mrc-limitations"></a>Одновременные MRC ограничения

Существуют некоторые ограничения вокруг нескольких приложений, доступ к MRC в то же время.

#### <a name="photovideo-camera-access"></a>Доступ к камере фото и видео

Число процессов, которые будут доступны в то же время ограничено камеры фото и видео. Во время процесса записи видео или сделать снимок любого другого процесса смогут получить камеры фото и видео. (это относится к смешанной реальности захвата и записи стандартных фотографий и видео)

В Windows 10 апреля 2018 г. обновления, это ограничение не применяется при встроенный пользовательский Интерфейс камеры MRC позволяет перевести фото или видео, после запуска приложения с помощью камеры фото и видео. Когда это происходит, разрешения и частоты кадров встроенной камеры MRC пользовательского интерфейса может быть снижена из его нормальных значений.

В Windows 10 октября 2018 обновлением, это ограничение не применяется для потоковой передачи MRC через Miracast.

#### <a name="mrc-access"></a>MRC доступа

В Windows 10 апреля 2018 г. обновление, больше не существует ограничение вокруг нескольких приложений, доступ к потоку MRC (тем не менее, доступ к камере фото и видео по-прежнему имеет ограничения).

Предыдущие для Windows 10 апреля 2018 г. обновления, пользовательские MRC записи приложения был взаимно исключают друг друга с системой MRC (захват фото, записывает видео или потоковая передача из Windows Device Portal).

## <a name="see-also"></a>См. также
* [Захват смешанной реальности](mixed-reality-capture.md)
* [Представление spectator](spectator-view.md)
