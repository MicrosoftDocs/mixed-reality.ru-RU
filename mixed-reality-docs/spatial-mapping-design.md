---
title: Пространственное сопоставление конструктора
description: Эффективно использовать пространственное сопоставление в HoloLens требует тщательного анализа множества факторов.
author: cre8ivepark
ms.author: dongpark
ms.date: 03/21/2018
ms.topic: article
keywords: Сопоставление Windows Mixed Reality, разработки, пространственных, HoloLens, surface реконструкции, сетки
ms.openlocfilehash: 451213a79e1d482d64725ce750065611830beec3
ms.sourcegitcommit: 17f86fed532d7a4e91bd95baca05930c4a5c68c5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2019
ms.locfileid: "66829961"
---
# <a name="spatial-mapping-design"></a>Пространственное сопоставление конструктора

Эффективно использовать пространственное сопоставление в HoloLens требует тщательного анализа множества факторов.

## <a name="device-support"></a>Поддержка устройств

<table>
    <colgroup>
    <col width="33%" />
    <col width="33%" />
    <col width="33%" />
    </colgroup>
    <tr>
        <td><strong>Возможность</strong></td>
        <td><a href="hololens-hardware-details.md"><strong>HoloLens</strong></a></td>
        <td><a href="immersive-headset-hardware-details.md"><strong>Иммерсивную</strong></a></td>
    </tr>
     <tr>
        <td>Пространственное сопоставление конструктора</td>
        <td>✔️</td>
        <td>❌</td>
    </tr>
</table>

## <a name="why-is-spatial-mapping-important"></a>Почему важна пространственное сопоставление?

Пространственное сопоставление позволяет для размещения объектов на реальных поверхности. Это помогает привязки объектов в мире пользователя и использует преимущества подсказки глубины реального мира. Occluding вашей голограммы, на основе других голограммы и реальных объектов помогает убедить пользователя, эти голограммы которые фактически имеются в своем пространстве. Голограммы с плавающей запятой в места, или перемещать с пользователем не воспринимается как реального. По возможности поместить элементы для комфорта.

Визуализация поверхности, когда размещение или перемещение голограммы (использование простых прогнозируемых сетки). Это поможет пользователю, где они лучше всего можно поместить их голограммы и показывает пользователю, если место, они пытаются разместить она еще не были сопоставлены еще. Вы может «Реклама на щитах элементы» к пользователю, если они направлены на слишком много угла.

## <a name="what-influences-spatial-mapping-quality"></a>Что влияет на качество пространственное сопоставление?

Для обеспечения удобства работы пользователей, важно понимать, какие факторы влияют на качество пространственное сопоставление данных, собранных соединителем HoloLens.

Ошибки в пространственное сопоставление данных делятся на три категории:
* **Пропуски**: Пространственное сопоставление данных отсутствуют реальные поверхности.
* **Hallucinations**: Пространственное сопоставление данных, не существуют в реальном мире существует поверхности.
* **Сдвиг**: Несовершенно поверхности в пространственное сопоставление данных выравниваются по поверхности реального мира, или получения.

Частоту и важность этих ошибок можно влияют несколько факторов:

* **Пользователь движения**
   * Как пользователь перемещается по своей среде определяет, насколько хорошо будут сканироваться среды, поэтому пользователь может потребовать руководство, чтобы добиться хорошей проверки.
   * Камера, используемая для сканирования предоставляет данные в пределах 70 градусов конус, от минимального 0,8 метров максимум 3.1 метров расстояние от камеры. Реальные поверхности будут проверяться только в этом поле зрения. Обратите внимание на то, что эти значения могут быть изменены в будущих версиях.
   * Если пользователь никогда не получает в 3.1 счетчики объекта затем он будет не проверяются.
   * Если пользователь просматривает только объект на расстоянии менее 0,8 метров, то он не будут проверены (Это позволяет избежать сканирования руки пользователя).
   * Если пользователь никогда не ищет вверх (это довольно обычных) затем ближайшее сверху целое скорее всего не проверяются.
   * Если пользователь никогда не ищет за мебель или стене затем перекрыто им объекты не проверяются.
   * Поверхности, как правило, сканироваться на более высокое качество при просмотре лицом к лицу, а не неполную углом.
   * При сбое в системе отслеживания head HoloLens моментально (что может произойти из-за быстрого пользователя движения, плохое освещение, featureless стен или камеры становится рассматривается), это может привести к ошибкам в данных пространственное сопоставление. Все такие ошибки будут исправлены со временем как пользователь продолжает перемещаться и проверять их среды.

* **Материалы по поверхности**
   * Материалы, найденных на поверхности реальных могут значительно различаться. Они влияют на качество пространственное сопоставление, данных, так как они влияют на свет как инфракрасного отражены.
   * Темной поверхности не может проверить, пока мере приближения к камере, так как они отражают меньше свет.
   * Возможно, некоторые поверхности поэтому темной, что они отражают свет слишком мало сканирования из любой расстояние, поэтому они появятся ошибки брешь в системе в месте рабочей области и иногда также программной части рабочей области.
   * Особенно блестящей поверхности может проверять только в том случае, при просмотре лицом к лицу, а не в том случае, если рассматривать неполную угол.
   * Зеркала, так как они создают году зеркальные отражения для реальной пробелы и рабочих областей, может привести к hallucination ошибки и ошибки брешь в системе.

* **Движения сцены**
   * Пространственное сопоставление быстро адаптация к изменениям в среде, такие как перемещение людей или открытие и закрытие двери.
   * Тем не менее пространственное сопоставление можно только адаптироваться к изменениям в области, при четко видны к камере, который используется для просмотра этой области.
   * По этой причине возможна такая адаптация затрагивает отставать от реальности, что может привести к ошибкам брешь в системе или hallucination.
   * В качестве примера пользователь просматривает друзей, а затем отключается, хотя дружественной оставляет возможностей. Представление «ghost» друга (ошибка hallucination) будет сохраняться в пространственное сопоставление данных, пока пользователь снова превращается и повторно сканирует места, где репутацию дружественной.

* **Помехи освещения**
   * При сканировании, например строгого солнечного света, проходящего через окно может помешать инфракрасного освещения в сцене.
   * При сканировании рядом поверхностей света прыгающий их вызывающие смещения ошибок могут препятствовать особенно блестящей поверхности.
   * Блестящей поверхности, отражение света непосредственно в камеру могут конфликтовать с ближайшими пространства, вызывая с плавающей запятой hallucinations среднего air или за счет отсрочки адаптации сцены команд и команд движением.
   * Два устройства HoloLens в одном помещении не должна взаимодействовать друг с другом, но наличие более пяти устройств HoloLens, может привести к помех.

Возможно избежать или устранить для некоторых из этих ошибок. Тем не менее необходимо разработать приложение таким образом, чтобы пользователь смогли достичь поставленных целей, даже при наличии ошибок в данных пространственное сопоставление.

## <a name="the-environment-scanning-experience"></a>Среда, проверку качества

HoloLens узнает о поверхности в среде, так как пользователь просматривает их. Со временем HoloLens создает сканирование всех деталей среды, наблюдались. Также проверка обновлений, как просмотреть их изменения в среде. Такая проверка будут автоматически сохраняться между запусков приложений.

Каждого приложения, использующего пространственное сопоставление следует учитывать стараемся «сканирования»; процесс, через который приложение проводит пользователя для проверки поверхности, которые необходимы для правильной работы приложения.

![Пример проверки](images/sr-mixedworld-140429-8pm-00068-1000px.png)<br>
*Пример проверки*

Суть этого сканирования интерфейса может изменяться в зависимости от потребностей каждого приложения значительно, но два основных принципов должен проводить его разработки.

Во-первых **четкое взаимодействие с пользователем является основной заботой**. Пользователь должен всегда помните, выполнены ли требования приложения. Они не могут удовлетворить, должны быть очевидно, почему это происходит оттого, и они должны быть быстро привело к предпринять соответствующие действия.

Во-вторых **приложения должны соблюдать баланс между эффективностью и надежности**. Если это невозможно, **надежно**, приложения автоматически следует проанализировать пространственное сопоставление данных для экономии времени пользователя. Если уже не сможете сделать это надежно, приложений вместо этого следует включить пользователю быстро предоставлять приложения, с дополнительными сведениями, которые требуется.

Помогает разрабатывать справа, проверку качества, рассмотрите следующие возможные причины, являющихся применимо для вашего приложения:

* **Нет опыта сканирования**
   * Приложение может прекрасно работать без все интерактивные возможности приложения сканирования; он будет рассказано о поверхности, которые обнаруживаются во время перемещения естественность.
   * Например приложение, которое позволяет пользователю рисовать на поверхности с помощью holographic spraypaint требуется знание только области, видимой в данный момент пользователю.
   * Среда может полностью сканирования уже значением, в котором пользователь уже потратил массу времени, с помощью HoloLens.
   * Не забывайте, однако, камера, используемая этим пространственное сопоставление только видно 3.1m глазах у пользователя, поэтому пространственное сопоставление не будет известно об любой более удаленных поверхностях, если только пользователь наблюдал их на расстоянии более подробно в прошлом.
   * Поэтому пользователь понимает, что были проверены, приложение должно предоставить визуальную обратную связь, чтобы этот эффект, например при приведении виртуального тени на поверхности отсканированные позволит поместить голограммы на этих поверхностях наглядно.
   * В этом случае Пространственные поверхности наблюдателя ограничивающий тома должны иметь обновления каждого кадра заблокирован текст [Пространственные системы координат](coordinate-systems.md), так что они соответствуют пользователю.

* **Найти подходящее расположение**
   * Приложение может быть предназначен для использования в расположении с определенными требованиями.
   * Например приложению могут потребоваться пустую область вокруг пользователь, поэтому они безопасно можно попрактиковаться в holographic поздравить тебя.
   * Приложения должны взаимодействовать специальных требований для первоначальных пользователя и усилить их с незащищенного визуальную обратную связь.
   * В этом примере приложение следует визуализировать объем необходимых пустую область и визуально выделить наличие любых нежелательных объектов в этой зоне.
   * В этом случае Пространственные поверхности наблюдателя ограничивающий тома следует использовать блокировки world [Пространственные системы координат](coordinate-systems.md) в выбранном расположении.

* **Найти подходящий конфигурацию поверхностей**
   * Приложению могут потребоваться конкретная конфигурация поверхности, например два больших, плоский, противоположных стен, чтобы создать holographic hall зеркалами.
   * В таких случаях приложение потребуется анализ, поверхностей, предоставляемые пространственных сопоставление для обнаружения подходящего поверхности и направлять пользователя к их.
   * Пользователь должен иметь резервных, если анализ зоны приложения не полностью надежные. Например если приложение неправильно идентифицирует лазейкой как плоский стены, пользователь должен простой способ исправить эту ошибку.

* **Сканировать частью среды**
   * Приложение может потребоваться записывать только частью среды, как указано пользователем.
   * Например приложение проверяет часть комнаты, пользователь может отправить holographic систематической рекламы для мебели, которым требуется продавать.
   * В этом случае приложения должен содержать пространственное сопоставление данных в пределах регионов, наблюдаемая пользователем во время проверки.

* **Сканирование всей комнаты**
   * Приложению могут потребоваться проверку всех поверхностей в текущем комнату, включая часовых поясов пользователь.
   * Например игра может поместить пользователя в роль Gulliver, в осаде из сотен tiny Lilliputians приближается со всех сторон.
   * В таких случаях приложения должны определить, сколько поверхностей в текущем комнаты уже были проверены и направить пользователя взглядом для восполнения значительных пробелов.
   * Ключ к этому процессу, обеспечивает визуальную обратную связь, которая затрудняет снимите флажок, чтобы пользователь какие поверхности еще не были проверены. Приложение может использовать, например [основе расстояние туман](https://msdn.microsoft.com/library/windows/desktop/bb173401%28v=vs.85%29.aspx) визуально выделить области, не охваченных пространственное сопоставление поверхности.

* **Создайте исходный моментальный среды**
   * Приложение может потребоваться игнорировать все изменения в среде после перевода исходного «snapshot».
   * Это может быть соответствующие во избежание перебоев в работе созданные пользователем данные, тесно связан с начальное состояние среды.
   * В этом случае приложение следует сделать копию пространственное сопоставление данных в исходное состояние после завершения.
   * Приложения следует продолжить получение обновлений пространственное сопоставление данных, если голограммы должны по-прежнему быть правильно перекрыто средой.
   * Продолжение обновления пространственное сопоставление данных также позволяют визуализировать любые изменения, возникшие, пользователю пояснение различия между состояниями прежний и наличии среды.

* **Моментальные снимки, инициированного пользователем, среды**
   * Приложения только можете реагировать на изменения среды моменты, определяемые пользователем.
   * Например пользователь может создать несколько 3D «statues» друга путем записи их создает в различные моменты.

* **Разрешить пользователю изменять среды**
   * Приложения могут разрабатываться реагировать в состоящие в режиме реального времени, чтобы любые изменения в среде пользователя.
   * Например Рисование интервью пользователь может запустить «Смена сцены» для holographic воспроизведения происходящих на другой стороне.

* **Руководство пользователя, чтобы избежать ошибок в данных пространственное сопоставление**
   * Приложение может потребоваться предоставить рекомендации пользователю, хотя они сканировании их среды.
   * Это может помочь пользователям избежать некоторых из [ошибок в данных пространственное сопоставление](spatial-mapping-design.md#what-influences-spatial-mapping-quality), к примеру, за счет от Солнцем windows или зеркала.

Один дополнительные подробности, которые следует учитывать является «range» пространственное сопоставление данных не ограничено. Хотя пространственное сопоставление создание постоянной базы данных из больших пространств, вносятся только эти данные доступными для приложений в «пузырек» ограниченного объема вокруг пользователя. Таким образом при запуске в начале long коридор и стека достаточно далеко от начала, а затем со временем исчезнут пространственных поверхности обратно в начале. Конечно это можно уменьшить путем кэширования этих областей в приложении, после они исчезли из доступных пространственное сопоставление данных.

## <a name="mesh-processing"></a>Обработка сетки

Это может помочь обнаружить типичные виды ошибок в поверхности, а также для фильтрации, удаления или изменения данных пространственное сопоставление соответствующим образом.

Имейте в виду, что пространственное сопоставление данных предназначен для отличаться как от максимально реальных поверхности, поэтому при любом обработки применить риски, сдвиг к поверхности к действительности.

Ниже приведены некоторые примеры различных типов сетки обработки, которые могут оказаться полезными:

* **Заполнение брешь в системе**
   * При небольших объектов, внесенных темно-материала не сможет проверять, оно будет закрыто отверстия в области окружающей.
   * Перекрытия, влияют на бреши в системе: голограммы видно отверстия в поверхность мы предполагаем, что непрозрачный реальных «через».
   * Уязвимости, влияющие на raycasts: Если вы используете raycasts, чтобы помочь пользователям взаимодействовать с поверхности, может быть нежелательным для этих лучи проходить через бреши в системе. Способа устранения заключается в использовании набор нескольких raycasts, охватывающий регионом соответствующего размера. Это позволит вам для фильтрации результатов «выброс» таким образом, даже если один raycast проходит через небольшой отверстие, итоговый результат по-прежнему будет допустимым. Однако имейте в виду, что этот подход требует вычислительных затрат.
   * Конфликты физики, влияют на бреши в системе: объект, который управляет физическое моделирование может удалить через отверстия в ближайшее снизу целое и могут.
   * Существует возможность алгоритмически заполнения таких отверстия сетки поверхности. Тем не менее необходимо будет настроить ваш алгоритм, таким образом, чтобы «реальных отверстия», такие как windows и заталкивает не заполняются. Он может быть трудно надежно различать «реальных бреши в системе» из «мнимой бреши в системе», поэтому вам поэкспериментировать с разных эвристические методы, такие как «размер» и «границ фигуры».

* **Удаление hallucination**
   * Отражений, ярко-индикаторы и перемещение объектов можно оставить небольшой устаревших «hallucinations» с плавающей запятой в середине воздуха.
   * Hallucinations влияют на перекрытия: hallucinations может становятся видимыми как темные фигуры, перемещение на переднем плане и occluding других голограммы.
   * Hallucinations влияют на raycasts: Если вы используете raycasts, чтобы помочь пользователям взаимодействовать с поверхности, эти лучей, может возникнуть hallucination вместо области за ней. Как и в случае с бреши в системе, способа устранения состоит в использовании многих raycasts вместо одного raycast, но еще раз это будут реализованы на вычислительной стоимости.
   * Hallucinations, влияющих на физических конфликтов: объект контролируется физическое моделирование может зависнуть от hallucination и он не сможет переместиться на первый взгляд очистить область пространства.
   * Можно отфильтровать такие hallucinations из сетки поверхности. Тем не менее как бреши в системе, будет необходимо для настройки ваш алгоритм для малого реальные объекты, такие как lamp е и дескрипторы дверца не удаляется.

* **Сглаживание**
   * Пространственное сопоставление может вернуть поверхности, которые могут быть, чем неровные и шум по сравнению с аналогичными функциями реального мира.
   * Плавный переход влияет на физики конфликтов: Если ближайшее снизу целое это примерное, шар физически имитации Гольф может не накат плавно по нему в виде прямой линии.
   * Плавность влияют на отрисовку: если поверхность визуализируются непосредственно, грубой нормали к поверхности могут повлиять на его внешний вид и нарушить работу «clean» и просмотреть. Существует возможность избежать этого с помощью соответствующих освещения и текстуры в шейдере, который используется для отрисовки поверхности.
   * Это возможно сгладить неровности в сетки поверхности. Тем не менее это могут передать области дальнейшей от области соответствующего реального мира. Обслуживание закрыть соответствие важно в том случае, для получения точных голограмма перекрытия и чтобы пользователи могли получить точный и прогнозируемого взаимодействия с holographic поверхности.
   * Если требуется только финальных изменений, он может быть достаточно для сглаживания вершинам без изменения позиции вершин.

* **Поиск плоскости**
   * Существует много вариантов анализа, который приложение может потребоваться на поверхностях, предоставляемые пространственное сопоставление.
   * Одним из простых примеров является «плоскости поиск»; Определение областей ограниченного, главным образом плоский поверхностей.
   * Плоский регионах можно использовать как holographic рабочих поверхности, регионах, где holographic содержимое могут быть автоматически помещены приложением.
   * Плоский регионах можно ограничить пользовательский интерфейс, чтобы помочь пользователям взаимодействовать с поверхности, что лучше всего соответствуют их потребностям.
   * Плоский регионах может использоваться как в реальном мире для holographic аналоги функциональных объектов, таких как экраны, таблиц или досок ЖК-ЭКРАНА.
   * Плоский регионах можно определить области play, являющееся основой игровая приставка уровней.
   * Плоский регионах может помочь виртуального агентов для перехода в реальном мире, определяя области floor, реальные люди, скорее всего, для прохода по.

## <a name="prototyping-and-debugging"></a>Создание прототипов и отладка

### <a name="useful-tools"></a>Полезные инструменты
* [HoloLens эмулятор](using-the-hololens-emulator.md) можно использовать для разработки приложений с использованием пространственное сопоставление без доступа к физической HoloLens. Он позволяет имитировать сеанса на HoloLens в среде реалистичные, все данные приложения обычно потребует, включая HoloLens движения, пространственные системы координат и сеток пространственное сопоставление. Это можно использовать для предоставления надежный, повторяемый вход, который может быть полезно для отладки проблем и участие в оценке изменений в коде.
* Чтобы воспроизвести сценариев, записи пространственное сопоставление данных по сети с динамической HoloLens, а затем сохраните его на диск и повторно использовать в последующих сеансах отладки.
* [Windows устройства портала объемного вида](using-the-windows-device-portal.md#3d-view) предоставляет способ для просмотра всех поверхностей пространственных сейчас доступно через систему пространственное сопоставление. Это создает основу сравнения для пространственных поверхности внутри приложения; Например можно легко сказать, если все Пространственные поверхности отсутствуют или от того, отображаются в неправильном месте.

### <a name="general-prototyping-guidance"></a>Создание прототипов Общие рекомендации
* Так как [ошибки](spatial-mapping-design.md#what-influences-spatial-mapping-quality) в пространственное сопоставление данных строго может затронуть взаимодействием с пользователями, рекомендуется протестировать приложение в самых разнообразных средах.
* Не получить перехват привычка всегда тестирования в том же расположении, например на рабочем месте. Убедитесь в том, что тестирование в различных областях различных должностей, фигур, размеры и материалы.
* Аналогичным образом искусственных или записанные данные могут быть полезны для отладки, не стали слишком зависят от же несколько тестовых случаев. Это может замедлить поиск важных вопросов, более разнообразными тестирование бы могли выявить ранее.
* Рекомендуется выполнить тестирование с использованием реальных (и в идеале без coached) пользователей, так как они могут не использовать HoloLens или ваше приложение в точно так же, как и. На самом деле возможно, вас удивит поведение как разные люди, знаний и предположения может быть!

## <a name="see-also"></a>См. также
* [Визуализация при сканировании комнаты](room-scan-visualization.md)
* [Проектирование пространственного звука](spatial-sound-design.md)
* [Сохраняемость в Unity](persistence-in-unity.md)
