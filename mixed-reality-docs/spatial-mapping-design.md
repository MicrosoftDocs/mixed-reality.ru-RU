---
title: Проектирование пространственного сопоставления
description: Эффективное использование пространственного сопоставления в HoloLens требует тщательного рассмотрения многих факторов.
author: cre8ivepark
ms.author: dongpark
ms.date: 03/21/2018
ms.topic: article
keywords: Windows Mixed Reality, проектирование, пространственное сопоставление, HoloLens, реконструкция поверхностей, сеть
ms.openlocfilehash: 02e64727f9a23bea28e018d7c4e5a8b89c152447
ms.sourcegitcommit: 60f73ca23023c17c1da833c83d2a02f4dcc4d17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2019
ms.locfileid: "69566006"
---
# <a name="spatial-mapping-design"></a><span data-ttu-id="ff585-104">Проектирование пространственного сопоставления</span><span class="sxs-lookup"><span data-stu-id="ff585-104">Spatial mapping design</span></span>

<span data-ttu-id="ff585-105">Эффективное использование пространственного сопоставления в HoloLens требует тщательного рассмотрения многих факторов.</span><span class="sxs-lookup"><span data-stu-id="ff585-105">Effective use of spatial mapping within HoloLens requires careful consideration of many factors.</span></span>

## <a name="device-support"></a><span data-ttu-id="ff585-106">Поддержка устройств</span><span class="sxs-lookup"><span data-stu-id="ff585-106">Device support</span></span>

<table>
    <colgroup>
    <col width="33%" />
    <col width="33%" />
    <col width="33%" />
    </colgroup>
    <tr>
        <td><span data-ttu-id="ff585-107"><strong>Возможность</strong></span><span class="sxs-lookup"><span data-stu-id="ff585-107"><strong>Feature</strong></span></span></td>
        <td><span data-ttu-id="ff585-108"><a href="hololens-hardware-details.md"><strong>HoloLens</strong></a></span><span class="sxs-lookup"><span data-stu-id="ff585-108"><a href="hololens-hardware-details.md"><strong>HoloLens</strong></a></span></span></td>
        <td><span data-ttu-id="ff585-109"><a href="immersive-headset-hardware-details.md"><strong>Иммерсивные гарнитуры</strong></a></span><span class="sxs-lookup"><span data-stu-id="ff585-109"><a href="immersive-headset-hardware-details.md"><strong>Immersive headsets</strong></a></span></span></td>
    </tr>
     <tr>
        <td><span data-ttu-id="ff585-110">Проектирование пространственного сопоставления</span><span class="sxs-lookup"><span data-stu-id="ff585-110">Spatial mapping design</span></span></td>
        <td><span data-ttu-id="ff585-111">✔️</span><span class="sxs-lookup"><span data-stu-id="ff585-111">✔️</span></span></td>
        <td><span data-ttu-id="ff585-112">❌</span><span class="sxs-lookup"><span data-stu-id="ff585-112">❌</span></span></td>
    </tr>
</table>

## <a name="why-is-spatial-mapping-important"></a><span data-ttu-id="ff585-113">Зачем важны пространственное сопоставление?</span><span class="sxs-lookup"><span data-stu-id="ff585-113">Why is spatial mapping important?</span></span>

<span data-ttu-id="ff585-114">Пространственное сопоставление позволяет размещать объекты на реальных поверхностях.</span><span class="sxs-lookup"><span data-stu-id="ff585-114">Spatial mapping makes it possible to place objects on real surfaces.</span></span> <span data-ttu-id="ff585-115">Это помогает привязать объекты в мире пользователя и использовать преимущества реальных подсказок по глубине мира. Окклудинг свои голограммы, основанные на других голограммах и реальных объектах, помогут убедить пользователя, что эти голограммы действительно находятся в своем пространстве.</span><span class="sxs-lookup"><span data-stu-id="ff585-115">This helps anchor objects in the user's world and takes advantage of real world depth cues. Occluding your holograms based on other holograms and real world objects helps convince the user that these holograms are actually in their space.</span></span> <span data-ttu-id="ff585-116">Голограммы с плавающей запятой или перемещение с помощью пользователя не будут реальными.</span><span class="sxs-lookup"><span data-stu-id="ff585-116">Holograms floating in space or moving with the user will not feel as real.</span></span> <span data-ttu-id="ff585-117">По возможности размещайте элементы для удобства.</span><span class="sxs-lookup"><span data-stu-id="ff585-117">When possible, place items for comfort.</span></span>

<span data-ttu-id="ff585-118">Визуализируйте поверхности при помещении или перемещении голограмм (используйте простую проецируемую сетку).</span><span class="sxs-lookup"><span data-stu-id="ff585-118">Visualize surfaces when placing or moving holograms (use a simple projected grid).</span></span> <span data-ttu-id="ff585-119">Это поможет пользователю понять, где можно лучше разместить свои голограммы, и показывает, что пользователь пытается разместить голограмму, но еще не сопоставлена.</span><span class="sxs-lookup"><span data-stu-id="ff585-119">This will help the user know where they can best place their holograms, and shows the user if the spot they are trying to place the hologram hasn't been mapped yet.</span></span> <span data-ttu-id="ff585-120">Вы можете «элементы объявления» ближе к пользователю, если они имеют слишком большую часть угла.</span><span class="sxs-lookup"><span data-stu-id="ff585-120">You can "billboard items" toward the user if they end up at too much of an angle.</span></span>

## <a name="what-influences-spatial-mapping-quality"></a><span data-ttu-id="ff585-121">Что влияет на качество пространственного сопоставления?</span><span class="sxs-lookup"><span data-stu-id="ff585-121">What influences spatial mapping quality?</span></span>

<span data-ttu-id="ff585-122">Несколько факторов, подробно описанных [здесь](environment-considerations-for-hololens.md), могут повлиять на частоту и серьезность этих ошибок.</span><span class="sxs-lookup"><span data-stu-id="ff585-122">Several factors, detailed [here](environment-considerations-for-hololens.md), can affect the frequency and severity of these errors.</span></span>  <span data-ttu-id="ff585-123">Однако следует спроектировать приложение таким образом, чтобы пользователь мог достичь своих целей даже при наличии ошибок в данных пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="ff585-123">However, you should design your application so that the user is able to achieve their goals even in the presence of errors in the spatial mapping data.</span></span>

## <a name="the-environment-scanning-experience"></a><span data-ttu-id="ff585-124">Процесс сканирования среды</span><span class="sxs-lookup"><span data-stu-id="ff585-124">The environment scanning experience</span></span>

<span data-ttu-id="ff585-125">Каждое приложение, использующее пространственное сопоставление, должно использовать проверку. процесс, с помощью которого приложение помогает пользователю проверять поверхности, необходимые для правильной работы приложения.</span><span class="sxs-lookup"><span data-stu-id="ff585-125">Each application that uses spatial mapping should consider providing a 'scanning experience'; the process through which the application guides the user to scan surfaces that are necessary for the application to function correctly.</span></span>

<span data-ttu-id="ff585-126">![Пример сканирования](images/sr-mixedworld-140429-8pm-00068-1000px.png)</span><span class="sxs-lookup"><span data-stu-id="ff585-126">![Example of scanning](images/sr-mixedworld-140429-8pm-00068-1000px.png)</span></span><br>
<span data-ttu-id="ff585-127">*Пример сканирования*</span><span class="sxs-lookup"><span data-stu-id="ff585-127">*Example of scanning*</span></span>

<span data-ttu-id="ff585-128">Характер этого процесса сканирования может сильно различаться в зависимости от потребностей конкретного приложения, но при проектировании необходимо иметь два основных принципа.</span><span class="sxs-lookup"><span data-stu-id="ff585-128">The nature of this scanning experience can vary greatly depending upon each application's needs, but two main principles should guide its design.</span></span>

<span data-ttu-id="ff585-129">Во-первых, необходимо **четко понять, что связь с пользователем является основной задачей**.</span><span class="sxs-lookup"><span data-stu-id="ff585-129">Firstly, **clear communication with the user is the primary concern**.</span></span> <span data-ttu-id="ff585-130">Пользователь всегда должен знать, выполняются ли требования приложения.</span><span class="sxs-lookup"><span data-stu-id="ff585-130">The user should always be aware of whether the application's requirements are being met.</span></span> <span data-ttu-id="ff585-131">Если они не выполняются, необходимо сразу же очистить пользователя, почему это так, и они должны быстро принять соответствующие меры.</span><span class="sxs-lookup"><span data-stu-id="ff585-131">When they are not being met, it should be immediately clear to the user why this is so and they should be quickly led to take the appropriate action.</span></span>

<span data-ttu-id="ff585-132">Во-вторых, **приложения должны попытаться обеспечить баланс между эффективностью и надежностью**.</span><span class="sxs-lookup"><span data-stu-id="ff585-132">Secondly, **applications should attempt to strike a balance between efficiency and reliability**.</span></span> <span data-ttu-id="ff585-133">Если это возможно, приложения должны автоматическианализировать пространственные данные сопоставления, чтобы сэкономить время пользователя.</span><span class="sxs-lookup"><span data-stu-id="ff585-133">When it is possible to do so **reliably**, applications should automatically analyze spatial mapping data to save the user time.</span></span> <span data-ttu-id="ff585-134">Если это невозможно, приложения должны позволить пользователю быстро предоставить приложению дополнительные сведения, необходимые для этого.</span><span class="sxs-lookup"><span data-stu-id="ff585-134">When it is not possible to do so reliably, applications should instead enable the user to quickly provide the application with the additional information it requires.</span></span>

<span data-ttu-id="ff585-135">Чтобы помочь вам в проектировании правильного процесса сканирования, определите, какие из следующих возможностей применимы к вашему приложению:</span><span class="sxs-lookup"><span data-stu-id="ff585-135">To help design the right scanning experience, consider which of the following possibilities are applicable to your application:</span></span>

* <span data-ttu-id="ff585-136">**Нет опыта сканирования**</span><span class="sxs-lookup"><span data-stu-id="ff585-136">**No scanning experience**</span></span>
   * <span data-ttu-id="ff585-137">Приложение может работать идеально без пошагового сканирования. Он узнает о поверхностях, которые наблюдаются в процессе естественного перемещения пользователей.</span><span class="sxs-lookup"><span data-stu-id="ff585-137">An application may function perfectly without any guided scanning experience; it will learn about surfaces that are observed in the course of natural user movement.</span></span>
   * <span data-ttu-id="ff585-138">Например, приложение, которое позволяет пользователю рисовать на поверхностях с помощью holographic и распылителя, требует знания только тех поверхностей, которые в настоящее время видны пользователю.</span><span class="sxs-lookup"><span data-stu-id="ff585-138">For example an application that lets the user draw on surfaces with holographic spray paint requires knowledge only of the surfaces currently visible to the user.</span></span>
   * <span data-ttu-id="ff585-139">Окружение может быть полностью проверено, если оно уже заняло много времени с помощью HoloLens.</span><span class="sxs-lookup"><span data-stu-id="ff585-139">The environment may be completely scanned already if it is one in which the user has already spent a lot of time using the HoloLens.</span></span>
   * <span data-ttu-id="ff585-140">Имейте в виду, что камера, используемая пространственным сопоставлением, может видеть только 3.1 m перед пользователем, поэтому при пространственном сопоставлении не будет сведений о более удаленных поверхностях, если пользователь не найдет их с более близкого расстояния в прошлом.</span><span class="sxs-lookup"><span data-stu-id="ff585-140">Bear in mind however that the camera used by spatial mapping can only see 3.1m in front of the user, so spatial mapping will not know about any more distant surfaces unless the user has observed them from a closer distance in the past.</span></span>
   * <span data-ttu-id="ff585-141">Так что пользователь понимает, какие поверхности были проверены, приложение должно предоставить визуальный отзыв об этом эффекте, например приведение виртуальных теней на отсканированные поверхности, может помочь пользователю разместить голограммы на этих поверхностях.</span><span class="sxs-lookup"><span data-stu-id="ff585-141">So the user understands which surfaces have been scanned, the application should provide visual feedback to this effect, for example casting virtual shadows onto scanned surfaces may help the user place holograms on those surfaces.</span></span>
   * <span data-ttu-id="ff585-142">В этом случае ограничивающие тома наблюдателя-поверхности должны обновляться в каждом кадре в [пространственной системе координат](coordinate-systems.md), так что они следуют за пользователем.</span><span class="sxs-lookup"><span data-stu-id="ff585-142">For this case, the spatial surface observer's bounding volumes should be updated each frame to a body-locked [spatial coordinate system](coordinate-systems.md), so that they follow the user.</span></span>

* <span data-ttu-id="ff585-143">**Найти подходящее расположение**</span><span class="sxs-lookup"><span data-stu-id="ff585-143">**Find a suitable location**</span></span>
   * <span data-ttu-id="ff585-144">Приложение может быть предназначено для использования в расположении с конкретными требованиями.</span><span class="sxs-lookup"><span data-stu-id="ff585-144">An application may be designed for use in a location with specific requirements.</span></span>
   * <span data-ttu-id="ff585-145">Например, приложению может потребоваться пустая область вокруг пользователя, чтобы они могли безопасно практиковаться в кунг-э.</span><span class="sxs-lookup"><span data-stu-id="ff585-145">For example, the application may require an empty area around the user so they can safely practice holographic kung-fu.</span></span>
   * <span data-ttu-id="ff585-146">Приложения должны заранее взаимодействовать с любыми конкретными требованиями и подключаться к ним с четкими визуальными отзывами.</span><span class="sxs-lookup"><span data-stu-id="ff585-146">Applications should communicate any specific requirements to the user up-front, and reinforce them with clear visual feedback.</span></span>
   * <span data-ttu-id="ff585-147">В этом примере приложение должно визуализировать экстент необходимой пустой области и визуально выделить присутствие любых нежелательных объектов в этой зоне.</span><span class="sxs-lookup"><span data-stu-id="ff585-147">In this example, the application should visualize the extent of the required empty area and visually highlight the presence of any undesired objects within this zone.</span></span>
   * <span data-ttu-id="ff585-148">В этом случае ограничивающие тома наблюдателя Surface должны использовать заблокированную в мире [систему пространственных координат](coordinate-systems.md) в выбранном расположении.</span><span class="sxs-lookup"><span data-stu-id="ff585-148">For this case, the spatial surface observer's bounding volumes should use a world-locked [spatial coordinate system](coordinate-systems.md) in the chosen location.</span></span>

* <span data-ttu-id="ff585-149">**Поиск подходящей конфигурации поверхностей**</span><span class="sxs-lookup"><span data-stu-id="ff585-149">**Find a suitable configuration of surfaces**</span></span>
   * <span data-ttu-id="ff585-150">Для приложения может потребоваться определенная конфигурация поверхностей, например две крупные, плоские и противоположные стены, чтобы создать более holographic-зал зеркал.</span><span class="sxs-lookup"><span data-stu-id="ff585-150">An application may require a specific configuration of surfaces, for example two large, flat, opposing walls to create a holographic hall of mirrors.</span></span>
   * <span data-ttu-id="ff585-151">В таких случаях приложению потребуется проанализировать поверхности, предоставляемые пространственным сопоставлением для определения подходящих поверхностей, и направить пользователя к ним.</span><span class="sxs-lookup"><span data-stu-id="ff585-151">In such cases the application will need to analyze the surfaces provided by spatial mapping to detect suitable surfaces, and direct the user toward them.</span></span>
   * <span data-ttu-id="ff585-152">Если анализ области приложения не полностью надежен, у пользователя должен быть параметр Fallback.</span><span class="sxs-lookup"><span data-stu-id="ff585-152">The user should have a fallback option if the application's surface analysis is not completely reliable.</span></span> <span data-ttu-id="ff585-153">Например, если приложение неправильно определяет двери как плоскую стену, пользователю требуется простой способ исправить эту ошибку.</span><span class="sxs-lookup"><span data-stu-id="ff585-153">For example, if the application incorrectly identifies a doorway as a flat wall, the user needs a simple way to correct this error.</span></span>

* <span data-ttu-id="ff585-154">**Сканирование части окружения**</span><span class="sxs-lookup"><span data-stu-id="ff585-154">**Scan part of the environment**</span></span>
   * <span data-ttu-id="ff585-155">Приложение может захватывать только часть среды, которая направляется пользователем.</span><span class="sxs-lookup"><span data-stu-id="ff585-155">An application may wish to only capture part of the environment, as directed by the user.</span></span>
   * <span data-ttu-id="ff585-156">Например, приложение сканирует часть комнаты, чтобы пользователь мог разместить holographic-классифицированную рекламу для мебели, которую планируется продать.</span><span class="sxs-lookup"><span data-stu-id="ff585-156">For example, the application scans part of a room so the user may post a holographic classified ad for furniture they wish to sell.</span></span>
   * <span data-ttu-id="ff585-157">В этом случае приложение должно записывать данные пространственного сопоставления в регионах, наблюдаемых пользователем во время проверки.</span><span class="sxs-lookup"><span data-stu-id="ff585-157">In this case, the application should capture spatial mapping data within the regions observed by the user during their scan.</span></span>

* <span data-ttu-id="ff585-158">**Сканирование всей комнаты**</span><span class="sxs-lookup"><span data-stu-id="ff585-158">**Scan the whole room**</span></span>
   * <span data-ttu-id="ff585-159">Приложению может потребоваться просмотр всех поверхностей в текущем помещении, включая пользователей, которые находятся за ним.</span><span class="sxs-lookup"><span data-stu-id="ff585-159">An application may require a scan of all of the surfaces in the current room, including those behind the user.</span></span>
   * <span data-ttu-id="ff585-160">Например, игра может поставить пользователя в роль Гулливер в осаде от сотен маленьких Лиллипутианс подхода из всех направлений.</span><span class="sxs-lookup"><span data-stu-id="ff585-160">For example, a game may put the user in the role of Gulliver, under siege from hundreds of tiny Lilliputians approaching from all directions.</span></span>
   * <span data-ttu-id="ff585-161">В таких случаях приложению необходимо определить, сколько поверхностей в текущей комнате уже было проверено, и направить пользователю взгляд на значительные промежутки.</span><span class="sxs-lookup"><span data-stu-id="ff585-161">In such cases, the application will need to determine how many of the surfaces in the current room have already been scanned, and direct the user's gaze to fill in significant gaps.</span></span>
   * <span data-ttu-id="ff585-162">Ключом к этому процессу является предоставление визуальной обратной связи, которая позволяет ясно понять, какие поверхности еще не были проверены.</span><span class="sxs-lookup"><span data-stu-id="ff585-162">The key to this process is providing visual feedback that makes it clear to the user which surfaces have not yet been scanned.</span></span> <span data-ttu-id="ff585-163">Приложение может, например, использовать [туман на основе расстояния](https://msdn.microsoft.com/library/windows/desktop/bb173401%28v=vs.85%29.aspx) для визуального выделения областей, не охваченных областями пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="ff585-163">The application could for example use [distance-based fog](https://msdn.microsoft.com/library/windows/desktop/bb173401%28v=vs.85%29.aspx) to visually highlight regions that are not covered by spatial mapping surfaces.</span></span>

* <span data-ttu-id="ff585-164">**Создание исходного моментального снимка окружения**</span><span class="sxs-lookup"><span data-stu-id="ff585-164">**Take an initial snapshot of the environment**</span></span>
   * <span data-ttu-id="ff585-165">Приложению может потребоваться игнорировать все изменения в среде после получения исходного снимка.</span><span class="sxs-lookup"><span data-stu-id="ff585-165">An application may wish to ignore all changes in the environment after taking an initial 'snapshot'.</span></span>
   * <span data-ttu-id="ff585-166">Это может быть полезно во избежание нарушений данных, созданных пользователем, которые тесно связаны с первоначальным состоянием среды.</span><span class="sxs-lookup"><span data-stu-id="ff585-166">This may be appropriate to avoid disruption of user-created data that is tightly coupled to the initial state of the environment.</span></span>
   * <span data-ttu-id="ff585-167">В этом случае приложение должно создать копию данных пространственного сопоставления в исходном состоянии после завершения проверки.</span><span class="sxs-lookup"><span data-stu-id="ff585-167">In this case, the application should make a copy of the spatial mapping data in its initial state once the scan is complete.</span></span>
   * <span data-ttu-id="ff585-168">Приложения должны продолжать получать обновления данных пространственного сопоставления, если они все еще должны быть правильно перекрыто средой.</span><span class="sxs-lookup"><span data-stu-id="ff585-168">Applications should continue receiving updates to spatial mapping data if holograms are still to be correctly occluded by the environment.</span></span>
   * <span data-ttu-id="ff585-169">Продолжение обновления данных пространственного сопоставления также позволяет визуализировать все произошедшие изменения, что позволяет пользователю отличия между более ранними и текущими состояниями среды.</span><span class="sxs-lookup"><span data-stu-id="ff585-169">Continued updates to spatial mapping data also allow visualizing any changes that have occurred, clarifying to the user the differences between prior and present states of the environment.</span></span>

* <span data-ttu-id="ff585-170">**Создание моментальных снимков среды, инициированных пользователем**</span><span class="sxs-lookup"><span data-stu-id="ff585-170">**Take user-initiated snapshots of the environment**</span></span>
   * <span data-ttu-id="ff585-171">Приложение может реагировать на изменения окружающей среды только по указанному пользователем.</span><span class="sxs-lookup"><span data-stu-id="ff585-171">An application may only wish to respond to environmental changes when instructed by the user.</span></span>
   * <span data-ttu-id="ff585-172">Например, пользователь может создать несколько трехмерных "статуес" друга, записывая их в разные моменты.</span><span class="sxs-lookup"><span data-stu-id="ff585-172">For example, the user could create multiple 3D 'statues' of a friend by capturing their poses at different moments.</span></span>

* <span data-ttu-id="ff585-173">**Разрешить пользователю изменять окружение**</span><span class="sxs-lookup"><span data-stu-id="ff585-173">**Allow the user to change the environment**</span></span>
   * <span data-ttu-id="ff585-174">Приложение может отвечать в режиме реального времени на любые изменения, внесенные в среду пользователя.</span><span class="sxs-lookup"><span data-stu-id="ff585-174">An application may be designed to respond in real-time to any changes made in the user's environment.</span></span>
   * <span data-ttu-id="ff585-175">Например, пользователь, рисующий прикрытием, может активировать "сцену Change" для более holographic-воспроизводимого воспроизведения на другой стороне.</span><span class="sxs-lookup"><span data-stu-id="ff585-175">For example, the user drawing a curtain could trigger 'scene change' for a holographic play taking place on the other side.</span></span>

* <span data-ttu-id="ff585-176">**Помочь пользователю избежать ошибок в данных пространственного сопоставления**</span><span class="sxs-lookup"><span data-stu-id="ff585-176">**Guide the user to avoid errors in the spatial mapping data**</span></span>
   * <span data-ttu-id="ff585-177">Приложению может потребоваться предоставить пользователю рекомендации, пока они проводят проверку своей среды.</span><span class="sxs-lookup"><span data-stu-id="ff585-177">An application may wish to provide guidance to the user while they are scanning their environment.</span></span>
   * <span data-ttu-id="ff585-178">Это может помочь пользователю избежать определенных видов [ошибок в данных пространственного сопоставления](spatial-mapping-design.md#what-influences-spatial-mapping-quality), например, не отключаясь от сунлит окон или зеркал.</span><span class="sxs-lookup"><span data-stu-id="ff585-178">This can help the user to avoid certain kinds of [errors in the spatial mapping data](spatial-mapping-design.md#what-influences-spatial-mapping-quality), for example by staying away from sunlit windows or mirrors.</span></span>

<span data-ttu-id="ff585-179">Один из дополнительных сведений о том, что "Range" данных пространственного сопоставления не ограничен.</span><span class="sxs-lookup"><span data-stu-id="ff585-179">One additional detail to be aware of is that the 'range' of spatial mapping data is not unlimited.</span></span> <span data-ttu-id="ff585-180">При пространственном сопоставлении создается постоянная база данных с большими пространствами, она только делает эти данные доступными для приложений в "пузырьковом" ограниченном размере вокруг пользователя.</span><span class="sxs-lookup"><span data-stu-id="ff585-180">Whilst spatial mapping does build a permanent database of large spaces, it only makes that data available to applications in a 'bubble' of limited size around the user.</span></span> <span data-ttu-id="ff585-181">Таким же, если начать с начала длинного корридора и пройти гораздо достаточно, чем с самого начала, то в конечном итоге пространственные поверхности будут исчезнуть.</span><span class="sxs-lookup"><span data-stu-id="ff585-181">Thus if you start at the beginning of a long corridor and walk far enough away from the start, then eventually the spatial surfaces back at the beginning will disappear.</span></span> <span data-ttu-id="ff585-182">Разумеется, вы можете уменьшить это путем кэширования этих поверхностей в приложении, когда они исчезают из доступных данных пространственного сопоставления.</span><span class="sxs-lookup"><span data-stu-id="ff585-182">You can of course mitigate this by caching those surfaces in your application after they have disappeared from the available spatial mapping data.</span></span>

## <a name="mesh-processing"></a><span data-ttu-id="ff585-183">Обработка сетки</span><span class="sxs-lookup"><span data-stu-id="ff585-183">Mesh processing</span></span>

<span data-ttu-id="ff585-184">Он может помочь обнаружить распространенные типы ошибок в поверхностях и фильтровать, удалять или изменять данные пространственного сопоставления соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="ff585-184">It may help to detect common types of errors in surfaces and to filter, remove or modify the spatial mapping data as appropriate.</span></span>

<span data-ttu-id="ff585-185">Имейте в виду, что данные пространственного сопоставления должны быть как можно точными для реальных поверхностей, поэтому любая обработка, которую вы применяете, переместит свои поверхности дальше от «правды».</span><span class="sxs-lookup"><span data-stu-id="ff585-185">Bear in mind that spatial mapping data is intended to be as faithful as possible to real-world surfaces, so any processing you apply risks shifting your surfaces further from the 'truth'.</span></span>

<span data-ttu-id="ff585-186">Ниже приведены некоторые примеры различных типов обработки сетки, которые могут оказаться полезными.</span><span class="sxs-lookup"><span data-stu-id="ff585-186">Here are some examples of different types of mesh processing that you may find useful:</span></span>

* <span data-ttu-id="ff585-187">**Заполнение отверстия**</span><span class="sxs-lookup"><span data-stu-id="ff585-187">**Hole filling**</span></span>
   * <span data-ttu-id="ff585-188">Если не удается проверить небольшой объект, состоящие из темного материала, он оставит отверстие в окружающей области.</span><span class="sxs-lookup"><span data-stu-id="ff585-188">If a small object made of a dark material fails to scan, it will leave a hole in the surrounding surface.</span></span>
   * <span data-ttu-id="ff585-189">Отверстия влияют на перекрытия: голограммы могут рассматриваться как отверстия в непрозрачной области реального мира.</span><span class="sxs-lookup"><span data-stu-id="ff585-189">Holes affect occlusion: holograms can be seen 'through' a hole in a supposedly opaque real-world surface.</span></span>
   * <span data-ttu-id="ff585-190">Отверстия влияют на райкастс. Если вы используете райкастс, чтобы помочь пользователям взаимодействовать с Surfaces, может быть нежелательно, чтобы эти лучи проходили через отверстия.</span><span class="sxs-lookup"><span data-stu-id="ff585-190">Holes affect raycasts: if you are using raycasts to help users interact with surfaces, it may be undesirable for these rays to pass through holes.</span></span> <span data-ttu-id="ff585-191">Одним из способов устранения этой проблемы является использование пакета из нескольких райкастс, охватывающих регион соответствующего размера.</span><span class="sxs-lookup"><span data-stu-id="ff585-191">One mitigation is to use a bundle of multiple raycasts covering an appropriately sized region.</span></span> <span data-ttu-id="ff585-192">Это позволит отфильтровать результаты выбросов, чтобы, даже если один райкаст пройдет небольшое отверстие, статистический результат по-прежнему будет действительным.</span><span class="sxs-lookup"><span data-stu-id="ff585-192">This will allow you to filter 'outlier' results, so that even if one raycast passes through a small hole, the aggregate result will still be valid.</span></span> <span data-ttu-id="ff585-193">Однако следует иметь в виду, что этот подход имеет вычислительные затраты.</span><span class="sxs-lookup"><span data-stu-id="ff585-193">However, be aware that this approach comes at a computational cost.</span></span>
   * <span data-ttu-id="ff585-194">Отверстия повлияли на физические конфликты: объект, контролируемый функцией имитации физических объектов, может отбрасывать отверстие в этаже и потерять его.</span><span class="sxs-lookup"><span data-stu-id="ff585-194">Holes affect physics collisions: an object controlled by physics simulation may drop through a hole in the floor and become lost.</span></span>
   * <span data-ttu-id="ff585-195">Можно алгоритмически заполнять такие отверстия в сетке Surface.</span><span class="sxs-lookup"><span data-stu-id="ff585-195">It is possible to algorithmically fill such holes in the surface mesh.</span></span> <span data-ttu-id="ff585-196">Однако необходимо настроить алгоритм таким образом, чтобы «реальные отверстия», например Windows и заталкивает, не заполняются.</span><span class="sxs-lookup"><span data-stu-id="ff585-196">However, you will need to tune your algorithm so that 'real holes' such as windows and doorways do not get filled in.</span></span> <span data-ttu-id="ff585-197">Надежное отличие "реальных дыр" от "мнимых отверстий" может быть затруднено, поэтому необходимо поэкспериментировать с различными эвристиками, такими как "size" и "Граничный фигура".</span><span class="sxs-lookup"><span data-stu-id="ff585-197">It can be difficult to reliably differentiate 'real holes' from 'imaginary holes', so you will need to experiment with different heuristics such as 'size' and 'boundary shape'.</span></span>

* <span data-ttu-id="ff585-198">**Удаление халлуЦинатион**</span><span class="sxs-lookup"><span data-stu-id="ff585-198">**Hallucination removal**</span></span>
   * <span data-ttu-id="ff585-199">Отражения, яркие индикаторы и движущие объекты могут оставлять небольшие задержки "халлуЦинатионс" плавающей точкой в середине воздуха.</span><span class="sxs-lookup"><span data-stu-id="ff585-199">Reflections, bright lights and moving objects can leave small lingering 'hallucinations' floating in mid-air.</span></span>
   * <span data-ttu-id="ff585-200">ХаллуЦинатионс влияет на перекрытия: халлуЦинатионс может стать видимым, как темные фигуры перемещаются впереди и окклудинг другие голограммы.</span><span class="sxs-lookup"><span data-stu-id="ff585-200">Hallucinations affect occlusion: hallucinations may become visible as dark shapes moving in front of and occluding other holograms.</span></span>
   * <span data-ttu-id="ff585-201">ХаллуЦинатионс влияет на райкастс. Если вы используете райкастс, чтобы помочь пользователям взаимодействовать с поверхностями, эти лучи могут попасть на халлуЦинатион, а не на поверхность.</span><span class="sxs-lookup"><span data-stu-id="ff585-201">Hallucinations affect raycasts: if you are using raycasts to help users interact with surfaces, these rays could hit a hallucination instead of the surface behind it.</span></span> <span data-ttu-id="ff585-202">Как и в случае с отверстиями, одним из способов устранения этой проблемы является использование многих райкастс вместо одного райкаст, но опять же это повлечет за собой вычислительные затраты.</span><span class="sxs-lookup"><span data-stu-id="ff585-202">As with holes, one mitigation is to use many raycasts instead of a single raycast, but again this will come at a computational cost.</span></span>
   * <span data-ttu-id="ff585-203">ХаллуЦинатионс влияет на конфликты физических объектов: объект, контролируемый имитацией физикы, может быть задержан на халлуЦинатион и не может перемещаться по пустой области пространства.</span><span class="sxs-lookup"><span data-stu-id="ff585-203">Hallucinations affect physics collisions: an object controlled by physics simulation may become stuck against a hallucination and be unable to move through a seemingly clear area of space.</span></span>
   * <span data-ttu-id="ff585-204">Можно отфильтровать такие халлуЦинатионс из сетки Surface.</span><span class="sxs-lookup"><span data-stu-id="ff585-204">It is possible to filter such hallucinations from the surface mesh.</span></span> <span data-ttu-id="ff585-205">Однако, как и в случае с отверстиями, необходимо настроить алгоритм таким образом, чтобы реальные небольшие объекты, такие как лампы и маркеры двери, не удалялись.</span><span class="sxs-lookup"><span data-stu-id="ff585-205">However, as with holes, you will need to tune your algorithm so that real small objects such as lamp-stands and door handles do not get removed.</span></span>

* <span data-ttu-id="ff585-206">**Сглаживания**</span><span class="sxs-lookup"><span data-stu-id="ff585-206">**Smoothing**</span></span>
   * <span data-ttu-id="ff585-207">Пространственное сопоставление может возвращать поверхности, которые выглядят как грубые или "шумные" в сравнении с реальными аналогами.</span><span class="sxs-lookup"><span data-stu-id="ff585-207">Spatial mapping may return surfaces that appear to be rough or 'noisy' in comparison to their real-world counterparts.</span></span>
   * <span data-ttu-id="ff585-208">Гладкость влияет на конфликты физической связи: Если этаж является приблизительным, физически смоделированный шарик гольфа может не двигаться плавно по линии в прямой строке.</span><span class="sxs-lookup"><span data-stu-id="ff585-208">Smoothness affects physics collisions: if the floor is rough, a physically simulated golf ball may not roll smoothly across it in a straight line.</span></span>
   * <span data-ttu-id="ff585-209">Плавность влияет на отрисовку. Если поверхность отображается напрямую, грубые нормали поверхности могут повлиять на внешний вид и нарушают вид "очистить".</span><span class="sxs-lookup"><span data-stu-id="ff585-209">Smoothness affects rendering: if a surface is visualized directly, rough surface normals can affect its appearance and disrupt a 'clean' look.</span></span> <span data-ttu-id="ff585-210">Это можно устранить с помощью соответствующего освещения и текстур в шейдере, который используется для визуализации поверхности.</span><span class="sxs-lookup"><span data-stu-id="ff585-210">It is possible to mitigate this by using appropriate lighting and textures in the shader that is used to render the surface.</span></span>
   * <span data-ttu-id="ff585-211">Можно сгладить неровности в сетке поверхности.</span><span class="sxs-lookup"><span data-stu-id="ff585-211">It is possible to smooth out roughness in a surface mesh.</span></span> <span data-ttu-id="ff585-212">Тем не менее, это может помещать поверхность с соответствующей реальной поверхности.</span><span class="sxs-lookup"><span data-stu-id="ff585-212">However, this may push the surface further away from the corresponding real-world surface.</span></span> <span data-ttu-id="ff585-213">Поддержание близкой корреспонденции важна для создания точной перекрытияной голограммы и предоставления пользователям возможности достичь точных и предсказуемых взаимодействий с Holographic.</span><span class="sxs-lookup"><span data-stu-id="ff585-213">Maintaining a close correspondence is important to produce accurate hologram occlusion, and to enable users to achieve precise and predictable interactions with holographic surfaces.</span></span>
   * <span data-ttu-id="ff585-214">Если требуется только косметические изменения, может быть достаточно для сглаживания нормалей вершин без изменения положений вершин.</span><span class="sxs-lookup"><span data-stu-id="ff585-214">If only a cosmetic change is required, it may be sufficient to smooth vertex normals without changing vertex positions.</span></span>

* <span data-ttu-id="ff585-215">**Поиск плоскости**</span><span class="sxs-lookup"><span data-stu-id="ff585-215">**Plane finding**</span></span>
   * <span data-ttu-id="ff585-216">Существует множество видов анализа, которые приложение может выполнять на поверхностях, предоставляемых пространственным сопоставлением.</span><span class="sxs-lookup"><span data-stu-id="ff585-216">There are many forms of analysis that an application may wish to perform on the surfaces provided by spatial mapping.</span></span>
   * <span data-ttu-id="ff585-217">Одним из простых примеров является "Поиск в плоскости"; определение ограниченных, преимущественно плоских областей поверхностей.</span><span class="sxs-lookup"><span data-stu-id="ff585-217">One simple example is 'plane finding'; identifying bounded, mostly-planar regions of surfaces.</span></span>
   * <span data-ttu-id="ff585-218">Плоские регионы можно использовать как holographic рабочих поверхностей, регионы, где holographic-содержимое может автоматически размещаться приложением.</span><span class="sxs-lookup"><span data-stu-id="ff585-218">Planar regions can be used as holographic work-surfaces, regions where holographic content can be automatically placed by the application.</span></span>
   * <span data-ttu-id="ff585-219">Плоские регионы могут ограничивать пользовательский интерфейс, чтобы помочь пользователям взаимодействовать с поверхностями, которые лучше подходят для их нужд.</span><span class="sxs-lookup"><span data-stu-id="ff585-219">Planar regions can constrain the user interface, to guide users to interact with the surfaces that best suit their needs.</span></span>
   * <span data-ttu-id="ff585-220">Плоские регионы можно использовать как в реальной среде, для holographic аналогов с функциональными объектами, такими как ЖК-экраны, таблицы или доски.</span><span class="sxs-lookup"><span data-stu-id="ff585-220">Planar regions can be used as in the real world, for holographic counterparts to functional objects such as LCD screens, tables or whiteboards.</span></span>
   * <span data-ttu-id="ff585-221">Плоские регионы могут определять области воспроизведения, образуя видеогаме уровней.</span><span class="sxs-lookup"><span data-stu-id="ff585-221">Planar regions can define play areas, forming the basis of videogame levels.</span></span>
   * <span data-ttu-id="ff585-222">Плоские регионы могут помочь виртуальным агентам перемещаться по реальному миру, определяя области основания, с которыми могут посвящены реальные люди.</span><span class="sxs-lookup"><span data-stu-id="ff585-222">Planar regions can aid virtual agents to navigate the real world, by identifying the areas of floor that real people are likely to walk on.</span></span>

## <a name="prototyping-and-debugging"></a><span data-ttu-id="ff585-223">Создание прототипов и отладка</span><span class="sxs-lookup"><span data-stu-id="ff585-223">Prototyping and debugging</span></span>

### <a name="useful-tools"></a><span data-ttu-id="ff585-224">Полезные средства</span><span class="sxs-lookup"><span data-stu-id="ff585-224">Useful tools</span></span>
* <span data-ttu-id="ff585-225">[Эмулятор hololens](using-the-hololens-emulator.md) можно использовать для разработки приложений, использующих пространственное сопоставление без доступа к физическим HoloLens.</span><span class="sxs-lookup"><span data-stu-id="ff585-225">The [HoloLens emulator](using-the-hololens-emulator.md) can be used to develop applications using spatial mapping without access to a physical HoloLens.</span></span> <span data-ttu-id="ff585-226">Он позволяет имитировать динамический сеанс на HoloLens в реалистичной среде, при этом все данные, которые обычно будут использоваться приложением, включают в себя движение HoloLens, пространственные системы координат и сетки пространственных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="ff585-226">It allows you to simulate a live session on a HoloLens in a realistic environment, with all of the data your application would normally consume, including HoloLens motion, spatial coordinate systems and spatial mapping meshes.</span></span> <span data-ttu-id="ff585-227">Это можно использовать для предоставления надежных, повторяемых входных данных, которые могут оказаться полезными при отладке проблем и оценке изменений в коде.</span><span class="sxs-lookup"><span data-stu-id="ff585-227">This can be used to provide reliable, repeatable input, which can be useful for debugging problems and evaluating changes to your code.</span></span>
* <span data-ttu-id="ff585-228">Чтобы воспроизвести сценарии, запишите данные пространственного сопоставления по сети из динамического HoloLens, а затем сохраните их на диск и повторно используйте в последующих сеансах отладки.</span><span class="sxs-lookup"><span data-stu-id="ff585-228">To reproduce a scenarios, capture spatial mapping data over the network from a live HoloLens, then save it to disk and reuse it in subsequent debugging sessions.</span></span>
* <span data-ttu-id="ff585-229">[Трехмерное представление портала устройств Windows](using-the-windows-device-portal.md#3d-view) позволяет просматривать все пространственные поверхности, доступные в настоящее время через систему пространственных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="ff585-229">The [Windows device portal 3D view](using-the-windows-device-portal.md#3d-view) provides a way to see all of the spatial surfaces currently available via the spatial mapping system.</span></span> <span data-ttu-id="ff585-230">Это дает основание для сравнения пространственных поверхностей внутри приложения; Например, можно легко определить, отсутствуют ли пространственные поверхности или они отображаются в неправильном месте.</span><span class="sxs-lookup"><span data-stu-id="ff585-230">This provides a basis of comparison for the spatial surfaces inside your application; for example you can easily tell if any spatial surfaces are missing or are being displayed in the wrong place.</span></span>

### <a name="general-prototyping-guidance"></a><span data-ttu-id="ff585-231">Общие рекомендации по созданию прототипов</span><span class="sxs-lookup"><span data-stu-id="ff585-231">General prototyping guidance</span></span>
* <span data-ttu-id="ff585-232">Поскольку [ошибки](spatial-mapping-design.md#what-influences-spatial-mapping-quality) в данных пространственного сопоставления могут сильно повлиять на взаимодействие с пользователем, рекомендуется тестировать приложение в самых разных средах.</span><span class="sxs-lookup"><span data-stu-id="ff585-232">Because [errors](spatial-mapping-design.md#what-influences-spatial-mapping-quality) in the spatial mapping data may strongly affect your user's experience, we recommend that you test your application in a wide variety of environments.</span></span>
* <span data-ttu-id="ff585-233">Не загляните в привычку всегда тестировать в одном месте, например на рабочем столе.</span><span class="sxs-lookup"><span data-stu-id="ff585-233">Don't get trapped in the habit of always testing in the same location, for example at your desk.</span></span> <span data-ttu-id="ff585-234">Обязательно протестируйте различные поверхности различных позиций, фигур, размеров и материалов.</span><span class="sxs-lookup"><span data-stu-id="ff585-234">Make sure to test on various surfaces of different positions, shapes, sizes and materials.</span></span>
* <span data-ttu-id="ff585-235">Аналогичным образом, хотя синтетические или записанные данные могут быть полезны для отладки, они не будут прилагаться к одному и тому же небольшому количеству тестовых случаев.</span><span class="sxs-lookup"><span data-stu-id="ff585-235">Similarly, while synthetic or recorded data can be useful for debugging, don't become too reliant upon the same few test cases.</span></span> <span data-ttu-id="ff585-236">Это может задержать Поиск важных проблем, которые более разнообразные тесты будут перехвачены ранее.</span><span class="sxs-lookup"><span data-stu-id="ff585-236">This may delay finding important issues that more varied testing would have caught earlier.</span></span>
* <span data-ttu-id="ff585-237">Рекомендуется выполнять тестирование с реальными пользователями (и в идеале), поскольку они не могут использовать HoloLens или приложение точно так же, как это делается.</span><span class="sxs-lookup"><span data-stu-id="ff585-237">It is a good idea to perform testing with real (and ideally un-coached) users, because they may not use the HoloLens or your application in exactly the same way that you do.</span></span> <span data-ttu-id="ff585-238">На самом деле, это может неожиданно повлиять на поведение людей, знание и допущения.</span><span class="sxs-lookup"><span data-stu-id="ff585-238">In fact, it may surprise you how divergent people's behavior, knowledge and assumptions can be!</span></span>

## <a name="see-also"></a><span data-ttu-id="ff585-239">См. также</span><span class="sxs-lookup"><span data-stu-id="ff585-239">See also</span></span>
* [<span data-ttu-id="ff585-240">Визуализация при сканировании комнаты</span><span class="sxs-lookup"><span data-stu-id="ff585-240">Room scan visualization</span></span>](room-scan-visualization.md)
* [<span data-ttu-id="ff585-241">Проектирование пространственного звука</span><span class="sxs-lookup"><span data-stu-id="ff585-241">Spatial sound design</span></span>](spatial-sound-design.md)
* [<span data-ttu-id="ff585-242">Сохраняемость в Unity</span><span class="sxs-lookup"><span data-stu-id="ff585-242">Persistence in Unity</span></span>](persistence-in-unity.md)
