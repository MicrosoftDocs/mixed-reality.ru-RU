---
title: Совместное использование 250 - HoloLens и иммерсивную MR
description: Выполните кодирование Пошаговое руководство по использованию Unity, Visual Studio, HoloLens и Windows Mixed Reality гарнитуры совместного использования голограммы между устройствами смешанной реальности подробные сведения.
author: keveleigh
ms.author: kurtie
ms.date: 03/21/2018
ms.topic: article
keywords: holotoolkit mixedrealitytoolkit, mixedrealitytoolkit-unity, создающий эффект присутствия, движения контроллера, совместное использование, контроллер xbox, сетевые подключения между устройствами
ms.openlocfilehash: 9e1cb0d168b8bf830b4477190516cd19caef7972
ms.sourcegitcommit: 384b0087899cd835a3a965f75c6f6c607c9edd1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/12/2019
ms.locfileid: "59598046"
---
>[!NOTE]
><span data-ttu-id="0268b-104">Учебники Academy реальности Mixed были разработаны с HoloLens (1-го поколения) и смешанной реальности Иммерсивную в виду.</span><span class="sxs-lookup"><span data-stu-id="0268b-104">The Mixed Reality Academy tutorials were designed with HoloLens (1st gen) and Mixed Reality Immersive Headsets in mind.</span></span>  <span data-ttu-id="0268b-105">Таким образом мы думаем, что это важно, чтобы эти учебники на месте для разработчиков, которые по-прежнему необходимы сведения при разработке приложений для этих устройств.</span><span class="sxs-lookup"><span data-stu-id="0268b-105">As such, we feel it is important to leave these tutorials in place for developers who are still looking for guidance in developing for those devices.</span></span>  <span data-ttu-id="0268b-106">Эти руководства будут **_не_** дополняться последние наборы инструментов или взаимодействия, используемых для HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="0268b-106">These tutorials will **_not_** be updated with the latest toolsets or interactions being used for HoloLens 2.</span></span>  <span data-ttu-id="0268b-107">Они будут сохранены, чтобы продолжить работу на поддерживаемых устройствах.</span><span class="sxs-lookup"><span data-stu-id="0268b-107">They will be maintained to continue working on the supported devices.</span></span> <span data-ttu-id="0268b-108">Будет существовать новую серию учебников, которые будут опубликованы в будущем, демонстрируют способ разработки для HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="0268b-108">There will be a new series of tutorials that will be posted in the future that will demonstrate how to develop for HoloLens 2.</span></span>  <span data-ttu-id="0268b-109">Это уведомление будет обновляться со ссылкой на эти руководства, когда они учитываются.</span><span class="sxs-lookup"><span data-stu-id="0268b-109">This notice will be updated with a link to those tutorials when they are posted.</span></span>

<br>

# <a name="mr-sharing-250-hololens-and-immersive-headsets"></a><span data-ttu-id="0268b-110">Совместное использование 250 MR: HoloLens и иммерсивную</span><span class="sxs-lookup"><span data-stu-id="0268b-110">MR Sharing 250: HoloLens and immersive headsets</span></span>

<span data-ttu-id="0268b-111">Благодаря гибкости для универсальной платформы Windows (UWP) можно легко создать приложение, которое охватывает несколько устройств.</span><span class="sxs-lookup"><span data-stu-id="0268b-111">With the flexibility of Universal Windows Platform (UWP), it is easy to create an application that spans multiple devices.</span></span> <span data-ttu-id="0268b-112">Благодаря этой гибкости мы можем создавать действия, которые необходимо использовать сильные стороны каждого устройства.</span><span class="sxs-lookup"><span data-stu-id="0268b-112">With this flexibility, we can create experiences that leverage the strengths of each device.</span></span> <span data-ttu-id="0268b-113">Этом руководстве рассматриваются основные общий интерфейс, который выполняется на HoloLens и Windows Mixed Reality иммерсивную.</span><span class="sxs-lookup"><span data-stu-id="0268b-113">This tutorial will cover a basic shared experience that runs on both HoloLens and Windows Mixed Reality immersive headsets.</span></span> <span data-ttu-id="0268b-114">Это содержимое было изначально доставлено на конференции Microsoft Build 2017 в Сиэтле, штат Вашингтон.</span><span class="sxs-lookup"><span data-stu-id="0268b-114">This content was originally delivered at the Microsoft Build 2017 conference in Seattle, WA.</span></span>

<span data-ttu-id="0268b-115">**В этом руководстве мы выполним следующее.**</span><span class="sxs-lookup"><span data-stu-id="0268b-115">**In this tutorial, we will:**</span></span>

* <span data-ttu-id="0268b-116">Настройка сети с помощью UNET.</span><span class="sxs-lookup"><span data-stu-id="0268b-116">Setup a network using UNET.</span></span>
* <span data-ttu-id="0268b-117">Совместное использование голограммы устройств смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="0268b-117">Share holograms across mixed reality devices.</span></span>
* <span data-ttu-id="0268b-118">Создайте другое представление приложения, в зависимости от используемого устройства смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="0268b-118">Establish a different view of the application depending on which mixed reality device is being used.</span></span>
* <span data-ttu-id="0268b-119">Создайте общий интерфейс, где пользователи HoloLens помогает пользователям иммерсивную сделать несколько простых головоломок.</span><span class="sxs-lookup"><span data-stu-id="0268b-119">Create a shared experience where HoloLens users guide immersive headsets users through some simple puzzles.</span></span>

## <a name="device-support"></a><span data-ttu-id="0268b-120">Поддержка устройств</span><span class="sxs-lookup"><span data-stu-id="0268b-120">Device support</span></span>

<table>
<tr>
<th><span data-ttu-id="0268b-121">Курс</span><span class="sxs-lookup"><span data-stu-id="0268b-121">Course</span></span></th><th style="width:150px"> <span data-ttu-id="0268b-122"><a href="hololens-hardware-details.md">HoloLens</a></span><span class="sxs-lookup"><span data-stu-id="0268b-122"><a href="hololens-hardware-details.md">HoloLens</a></span></span></th><th style="width:150px"> <span data-ttu-id="0268b-123"><a href="immersive-headset-hardware-details.md">Иммерсивную</a></span><span class="sxs-lookup"><span data-stu-id="0268b-123"><a href="immersive-headset-hardware-details.md">Immersive headsets</a></span></span></th>
</tr><tr>
<td><span data-ttu-id="0268b-124">Совместное использование 250 MR: HoloLens и иммерсивную</span><span class="sxs-lookup"><span data-stu-id="0268b-124">MR Sharing 250: HoloLens and immersive headsets</span></span></td><td style="text-align: center;"> <span data-ttu-id="0268b-125">✔️</span><span class="sxs-lookup"><span data-stu-id="0268b-125">✔️</span></span></td><td style="text-align: center;"> <span data-ttu-id="0268b-126">✔️</span><span class="sxs-lookup"><span data-stu-id="0268b-126">✔️</span></span></td>
</tr>
</table>

## <a name="before-you-start"></a><span data-ttu-id="0268b-127">Прежде чем начать</span><span class="sxs-lookup"><span data-stu-id="0268b-127">Before you start</span></span>

### <a name="prerequisites"></a><span data-ttu-id="0268b-128">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="0268b-128">Prerequisites</span></span>

* <span data-ttu-id="0268b-129">ПК с Windows 10 с [средства разработки, необходимые](install-the-tools.md) и [настроен для поддержки Windows гарнитуры смешанной реальности иммерсивных](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span><span class="sxs-lookup"><span data-stu-id="0268b-129">A Windows 10 PC with the [necessary development tools](install-the-tools.md) and [configured to support a Windows Mixed Reality immersive headset](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span></span>
* <span data-ttu-id="0268b-130">Контроллер Xbox, который работает с компьютера.</span><span class="sxs-lookup"><span data-stu-id="0268b-130">An Xbox controller that works with your PC.</span></span>
* <span data-ttu-id="0268b-131">Хотя бы одно устройство HoloLens и один иммерсивных гарнитуры.</span><span class="sxs-lookup"><span data-stu-id="0268b-131">At least one HoloLens device and one immersive headset.</span></span>
* <span data-ttu-id="0268b-132">Сеть, которая позволяет рассылать UDP для обнаружения.</span><span class="sxs-lookup"><span data-stu-id="0268b-132">A network which allows UDP Broadcast for discovery.</span></span>

### <a name="project-files"></a><span data-ttu-id="0268b-133">Файлы проекта</span><span class="sxs-lookup"><span data-stu-id="0268b-133">Project files</span></span>

* <span data-ttu-id="0268b-134">Скачайте [файлы](https://github.com/Microsoft/MixedReality250/archive/master.zip) требуемые для проекта.</span><span class="sxs-lookup"><span data-stu-id="0268b-134">Download the [files](https://github.com/Microsoft/MixedReality250/archive/master.zip) required by the project.</span></span> <span data-ttu-id="0268b-135">Извлеките файлы в легко запоминающегося расположение.</span><span class="sxs-lookup"><span data-stu-id="0268b-135">Extract the files to an easy to remember location.</span></span>
* <span data-ttu-id="0268b-136">Для этого проекта требуется [рекомендуется версию Unity с поддержкой Windows Mixed Reality](install-the-tools.md).</span><span class="sxs-lookup"><span data-stu-id="0268b-136">This project requires the [a recommended version of Unity with Windows Mixed Reality support](install-the-tools.md).</span></span>

>[!NOTE]
><span data-ttu-id="0268b-137">Если вы хотите просмотреть исходный код перед загрузкой, он имеет [на сайте GitHub](https://github.com/Microsoft/MixedReality250).</span><span class="sxs-lookup"><span data-stu-id="0268b-137">If you want to look through the source code before downloading, it's [available on GitHub](https://github.com/Microsoft/MixedReality250).</span></span>

## <a name="chapter-1---holo-world"></a><span data-ttu-id="0268b-138">Глава 1 - Holo World</span><span class="sxs-lookup"><span data-stu-id="0268b-138">Chapter 1 - Holo World</span></span>

>[!VIDEO https://www.youtube.com/embed/IC0rp6rLiEc]

### <a name="objectives"></a><span data-ttu-id="0268b-139">Цели</span><span class="sxs-lookup"><span data-stu-id="0268b-139">Objectives</span></span>

<span data-ttu-id="0268b-140">Убедитесь, что в среде разработки будет готова к работе с простого проекта.</span><span class="sxs-lookup"><span data-stu-id="0268b-140">Make sure the development environment is ready to go with a simple project.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="0268b-141">Мы построим</span><span class="sxs-lookup"><span data-stu-id="0268b-141">What we will build</span></span>

<span data-ttu-id="0268b-142">Приложение, в которой отображается голограмма HoloLens или иммерсивных гарнитуры смешанной реальности Windows.</span><span class="sxs-lookup"><span data-stu-id="0268b-142">An application that shows a hologram on either HoloLens or a Windows Mixed Reality immersive headset.</span></span>

### <a name="steps"></a><span data-ttu-id="0268b-143">Действия</span><span class="sxs-lookup"><span data-stu-id="0268b-143">Steps</span></span>
* <span data-ttu-id="0268b-144">Откройте Unity.</span><span class="sxs-lookup"><span data-stu-id="0268b-144">Open Unity.</span></span>
    * <span data-ttu-id="0268b-145">Выберите **откройте**.</span><span class="sxs-lookup"><span data-stu-id="0268b-145">Select **Open**.</span></span>
    * <span data-ttu-id="0268b-146">Перейдите к извлеченным файлам проекта.</span><span class="sxs-lookup"><span data-stu-id="0268b-146">Navigate to where you extracted the project files.</span></span>
    * <span data-ttu-id="0268b-147">Щелкните элемент **Выбор папки**.</span><span class="sxs-lookup"><span data-stu-id="0268b-147">Click **Select Folder**.</span></span>
    * <span data-ttu-id="0268b-148">*Займет немного хотя Unity для обработки в проект в первый раз.*</span><span class="sxs-lookup"><span data-stu-id="0268b-148">*It will take a little while for Unity to process the project the first time.*</span></span>
* <span data-ttu-id="0268b-149">Проверьте, что в Unity включено смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="0268b-149">Check that Mixed Reality is enabled in Unity.</span></span>
    * <span data-ttu-id="0268b-150">Открыть диалоговое окно настройки сборки (**управления + Shift + B** или **файл > создать параметры** ).</span><span class="sxs-lookup"><span data-stu-id="0268b-150">Open the build settings dialog (**Control+Shift+B** or **File > Build Settings...**).</span></span>
    * <span data-ttu-id="0268b-151">Выберите **универсальной платформы Windows** щелкните **переключить платформу**.</span><span class="sxs-lookup"><span data-stu-id="0268b-151">Select **Universal Windows Platform** then click **Switch Platform**.</span></span>
    * <span data-ttu-id="0268b-152">Выберите **изменить > Параметры проигрывателя**.</span><span class="sxs-lookup"><span data-stu-id="0268b-152">Select **Edit>Player Settings**.</span></span>
    * <span data-ttu-id="0268b-153">В **инспектор** на правой панели, разверните узел **XR параметры**.</span><span class="sxs-lookup"><span data-stu-id="0268b-153">In the **Inspector** panel on the right hand side, expand **XR Settings**.</span></span>
    * <span data-ttu-id="0268b-154">Проверьте **поддерживается виртуальной реальности** поле.</span><span class="sxs-lookup"><span data-stu-id="0268b-154">Check the **Virtual Reality Supported** box.</span></span>
    * <span data-ttu-id="0268b-155">*Смешанная реальность Windows должен быть виртуальной реальности SDK.*</span><span class="sxs-lookup"><span data-stu-id="0268b-155">*Windows Mixed Reality should be the Virtual Reality SDK.*</span></span>
* <span data-ttu-id="0268b-156">Создание сцены.</span><span class="sxs-lookup"><span data-stu-id="0268b-156">Create a scene.</span></span>
    * <span data-ttu-id="0268b-157">В **иерархии** щелкните правой кнопкой мыши **Main Camera** выберите **удалить**.</span><span class="sxs-lookup"><span data-stu-id="0268b-157">In the **Hierarchy** right click **Main Camera** select **Delete**.</span></span>
    * <span data-ttu-id="0268b-158">Из **HoloToolkit > ввод > Prefabs** перетащите **MixedRealityCameraParent** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-158">From **HoloToolkit > Input > Prefabs** drag **MixedRealityCameraParent** to the **Hierarchy**.</span></span>
* <span data-ttu-id="0268b-159">Добавьте в сцену голограммы</span><span class="sxs-lookup"><span data-stu-id="0268b-159">Add Holograms to the scene</span></span>
    * <span data-ttu-id="0268b-160">Из **AppPrefabs** перетащите **Skybox** для **представлении сцены**.</span><span class="sxs-lookup"><span data-stu-id="0268b-160">From **AppPrefabs** drag **Skybox** to the **Scene View**.</span></span>
    * <span data-ttu-id="0268b-161">Из **AppPrefabs** перетащите **диспетчеры** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-161">From **AppPrefabs** drag **Managers** to the **Hierarchy**.</span></span>
    * <span data-ttu-id="0268b-162">Из **AppPrefabs** перетащите **остров** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-162">From **AppPrefabs** drag **Island** to the **Hierarchy**.</span></span>
* <span data-ttu-id="0268b-163">Сохранение и разработка</span><span class="sxs-lookup"><span data-stu-id="0268b-163">Save And build</span></span>
    * <span data-ttu-id="0268b-164">Сохранить (либо **управления + S** или **файл > Сохранить сцену**)</span><span class="sxs-lookup"><span data-stu-id="0268b-164">Save (either **Control+S** or **File > Save Scene**)</span></span>
    * <span data-ttu-id="0268b-165">Так как это новую сцену, вам потребуется его назвать.</span><span class="sxs-lookup"><span data-stu-id="0268b-165">Since this is a new scene, you'll need to name it.</span></span> <span data-ttu-id="0268b-166">Имя не имеет значения, но мы используем SharedMixedReality.</span><span class="sxs-lookup"><span data-stu-id="0268b-166">Name doesn't matter, but we use SharedMixedReality.</span></span>
* <span data-ttu-id="0268b-167">Экспорт в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="0268b-167">Export To Visual Studio</span></span>
    * <span data-ttu-id="0268b-168">Откройте меню "сборка" (**управления + Shift + B** или **файл > Параметры сборки**)</span><span class="sxs-lookup"><span data-stu-id="0268b-168">Open the build menu (**Control+Shift+B** or **File > Build Settings**)</span></span>
    * <span data-ttu-id="0268b-169">Нажмите кнопку **Добавление открытых сцен.**</span><span class="sxs-lookup"><span data-stu-id="0268b-169">Click **Add Open Scenes.**</span></span>
    * <span data-ttu-id="0268b-170">Проверьте **Unity C# проектов**</span><span class="sxs-lookup"><span data-stu-id="0268b-170">Check **Unity C# Projects**</span></span>
    * <span data-ttu-id="0268b-171">Щелкните **Сборка**.</span><span class="sxs-lookup"><span data-stu-id="0268b-171">Click **Build**.</span></span>
    * <span data-ttu-id="0268b-172">В окне обозревателя файл, который отображается, создайте новую папку с именем **приложения**.</span><span class="sxs-lookup"><span data-stu-id="0268b-172">In the file explorer window that appears, create a New Folder named **App**.</span></span>
    * <span data-ttu-id="0268b-173">Одним щелчком мыши **приложения** папки.</span><span class="sxs-lookup"><span data-stu-id="0268b-173">Single click the **App** folder.</span></span>
    * <span data-ttu-id="0268b-174">Нажмите клавишу **выберите папку.**</span><span class="sxs-lookup"><span data-stu-id="0268b-174">Press **Select Folder.**</span></span>
    * <span data-ttu-id="0268b-175">**Дождитесь завершения сборки**</span><span class="sxs-lookup"><span data-stu-id="0268b-175">**Wait for the build to complete**</span></span>
    * <span data-ttu-id="0268b-176">В окне обозревателя файл, который отображается, перейдите в **приложения** папки.</span><span class="sxs-lookup"><span data-stu-id="0268b-176">In the file explorer window that appears, navigate into the **App** folder.</span></span>
    * <span data-ttu-id="0268b-177">Дважды щелкните **SharedMixedReality.sln** для запуска Visual Studio</span><span class="sxs-lookup"><span data-stu-id="0268b-177">Double-click **SharedMixedReality.sln** to launch Visual Studio</span></span>
* <span data-ttu-id="0268b-178">Строится на основе Visual Studio</span><span class="sxs-lookup"><span data-stu-id="0268b-178">Build From Visual Studio</span></span>
    * <span data-ttu-id="0268b-179">С помощью панели инструментов вверху изменить целевой объект для **выпуска** и **x86**.</span><span class="sxs-lookup"><span data-stu-id="0268b-179">Using the top toolbar change target to **Release** and **x86**.</span></span>
    * <span data-ttu-id="0268b-180">Щелкните стрелку рядом с полем **локального компьютера** и выберите **устройства** для развертывания в HoloLens</span><span class="sxs-lookup"><span data-stu-id="0268b-180">Click the arrow next to **Local Machine** and select **Device** to deploy to HoloLens</span></span>
    * <span data-ttu-id="0268b-181">Щелкните стрелку рядом с полем **устройства** и выберите **локального компьютера** развертывание для гарнитуры смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="0268b-181">Click the arrow next to **Device** and select **Local Machine** to deploy for the mixed reality headset.</span></span>
    * <span data-ttu-id="0268b-182">Нажмите кнопку **Отладка -> Запуск без отладки** или **управления + F5** для запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="0268b-182">Click **Debug->Start Without Debugging** or **Control+F5** to start the application.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="0268b-183">Подробно о коде</span><span class="sxs-lookup"><span data-stu-id="0268b-183">Digging into the code</span></span>

<span data-ttu-id="0268b-184">На панели «проект» перейдите к **Assets\HoloToolkit\Input\Scripts\Utilities** и дважды щелкните **MixedRealityCameraManager.cs** чтобы открыть его.</span><span class="sxs-lookup"><span data-stu-id="0268b-184">In the project panel, navigate to **Assets\HoloToolkit\Input\Scripts\Utilities** and double click **MixedRealityCameraManager.cs** to open it.</span></span>

<span data-ttu-id="0268b-185">**Обзор:** MixedRealityCameraManager.cs является простой сценарий, который настраивает параметры качества уровень и фона в зависимости от устройства.</span><span class="sxs-lookup"><span data-stu-id="0268b-185">**Overview:** MixedRealityCameraManager.cs is a simple script that adjusts quality level and background settings based on the device.</span></span> <span data-ttu-id="0268b-186">Вот HolographicSettings.IsDisplayOpaque, что позволяет обнаружить, является ли устройство HoloLens сценарий ключа (IsDisplayOpaque возвращает значение false) или иммерсивных Гарнитура (IsDisplayOpaque возвращает значение true).</span><span class="sxs-lookup"><span data-stu-id="0268b-186">Key here is HolographicSettings.IsDisplayOpaque, which allows a script to detect if the device is a HoloLens (IsDisplayOpaque returns false) or an immersive headset (IsDisplayOpaque returns true).</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="0268b-187">Наслаждайтесь хода выполнения</span><span class="sxs-lookup"><span data-stu-id="0268b-187">Enjoy your progress</span></span>

<span data-ttu-id="0268b-188">На этом этапе приложение просто визуализирует голограмма.</span><span class="sxs-lookup"><span data-stu-id="0268b-188">At this point the application will just render a hologram.</span></span> <span data-ttu-id="0268b-189">Мы добавим взаимодействия для голограмма позже.</span><span class="sxs-lookup"><span data-stu-id="0268b-189">We will add interaction to the hologram later.</span></span> <span data-ttu-id="0268b-190">Оба устройства голограмма одинаковой визуализации.</span><span class="sxs-lookup"><span data-stu-id="0268b-190">Both devices will render the hologram the same.</span></span> <span data-ttu-id="0268b-191">Насыщенные гарнитура также сделает синим фоном небо и облаков.</span><span class="sxs-lookup"><span data-stu-id="0268b-191">The immersive headset will also render a blue sky and clouds background.</span></span>

## <a name="chapter-2---interaction"></a><span data-ttu-id="0268b-192">Глава 2 - взаимодействия</span><span class="sxs-lookup"><span data-stu-id="0268b-192">Chapter 2 - Interaction</span></span>

>[!VIDEO https://www.youtube.com/embed/Lrb1y4sQRvI]

### <a name="objectives"></a><span data-ttu-id="0268b-193">Цели</span><span class="sxs-lookup"><span data-stu-id="0268b-193">Objectives</span></span>

<span data-ttu-id="0268b-194">Показано, как обрабатывать входные данные для приложения Windows смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="0268b-194">Show how to handle input for a Windows Mixed Reality application.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="0268b-195">Мы построим</span><span class="sxs-lookup"><span data-stu-id="0268b-195">What we will build</span></span>

<span data-ttu-id="0268b-196">Основываясь на приложение в главе 1, мы добавим возможность, позволяющая пользователю взять голограмма и поместите его на поверхность реального мира в HoloLens или на виртуальную таблицу в иммерсивных гарнитуры.</span><span class="sxs-lookup"><span data-stu-id="0268b-196">Building on the application from chapter 1, we will add functionality to allow the user to pick up the hologram and place it on a real world surface in HoloLens or on a virtual table in an immersive headset.</span></span>

<span data-ttu-id="0268b-197">**Входной напоминание:** На HoloLens — выберите жест **жест касания**.</span><span class="sxs-lookup"><span data-stu-id="0268b-197">**Input Refresher:** On HoloLens the select gesture is the **air tap**.</span></span> <span data-ttu-id="0268b-198">На иммерсивную, мы будем использовать **A** кнопки контроллера Xbox.</span><span class="sxs-lookup"><span data-stu-id="0268b-198">On immersive headsets, we will use the **A** button on the Xbox controller.</span></span> <span data-ttu-id="0268b-199">Дополнительные сведения о входных данных [начало](gestures.md).</span><span class="sxs-lookup"><span data-stu-id="0268b-199">For more information on input [start here](gestures.md).</span></span>

### <a name="steps"></a><span data-ttu-id="0268b-200">Действия</span><span class="sxs-lookup"><span data-stu-id="0268b-200">Steps</span></span>
* <span data-ttu-id="0268b-201">Добавление диспетчера входных данных</span><span class="sxs-lookup"><span data-stu-id="0268b-201">Add Input manager</span></span>
    * <span data-ttu-id="0268b-202">Из **HoloToolkit > ввод > Prefabs** перетащите **InputManager** для **иерархии** как дочерний **диспетчеры**.</span><span class="sxs-lookup"><span data-stu-id="0268b-202">From **HoloToolkit > Input > Prefabs** drag **InputManager** to **Hierarchy** as a child of **Managers**.</span></span>
    * <span data-ttu-id="0268b-203">Из **HoloToolkit > ввод > Prefabs > курсор** перетащите **курсор** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-203">From **HoloToolkit > Input > Prefabs > Cursor** drag **Cursor** to **Hierarchy**.</span></span>
* <span data-ttu-id="0268b-204">Добавление пространственное сопоставление</span><span class="sxs-lookup"><span data-stu-id="0268b-204">Add Spatial Mapping</span></span>
    * <span data-ttu-id="0268b-205">Из **HoloToolkit > SpatialMapping > Prefabs** перетащите **SpatialMapping** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-205">From **HoloToolkit > SpatialMapping > Prefabs** drag **SpatialMapping** to **Hierarchy**.</span></span>
* <span data-ttu-id="0268b-206">Добавление виртуального Playspace</span><span class="sxs-lookup"><span data-stu-id="0268b-206">Add Virtual Playspace</span></span>
    * <span data-ttu-id="0268b-207">В **иерархии** разверните **MixedRealityCameraParent** выберите **границ**</span><span class="sxs-lookup"><span data-stu-id="0268b-207">In **Hierarchy** expand **MixedRealityCameraParent** select **Boundary**</span></span>
    * <span data-ttu-id="0268b-208">В **инспектор** панели установите флажок, чтобы включить **границ**</span><span class="sxs-lookup"><span data-stu-id="0268b-208">In **Inspector** panel check the box to enable **Boundary**</span></span>
    * <span data-ttu-id="0268b-209">Из **AppPrefabs** перетащите **VRRoom** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-209">From **AppPrefabs** drag **VRRoom** to **Hierarchy**.</span></span>
* <span data-ttu-id="0268b-210">Добавить WorldAnchorManager</span><span class="sxs-lookup"><span data-stu-id="0268b-210">Add WorldAnchorManager</span></span>
    * <span data-ttu-id="0268b-211">В **иерархии**выберите **диспетчеры**.</span><span class="sxs-lookup"><span data-stu-id="0268b-211">In **Hierarchy**, Select **Managers**.</span></span>
    * <span data-ttu-id="0268b-212">В **инспектор**, нажмите кнопку **добавить компонент**.</span><span class="sxs-lookup"><span data-stu-id="0268b-212">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="0268b-213">Тип **Manager привязки World**.</span><span class="sxs-lookup"><span data-stu-id="0268b-213">Type **World Anchor Manager**.</span></span>
    * <span data-ttu-id="0268b-214">Выберите **Manager привязки World** Чтобы добавить его.</span><span class="sxs-lookup"><span data-stu-id="0268b-214">Select **World Anchor Manager** to add it.</span></span>
* <span data-ttu-id="0268b-215">Добавить TapToPlace острова</span><span class="sxs-lookup"><span data-stu-id="0268b-215">Add TapToPlace to the Island</span></span>
    * <span data-ttu-id="0268b-216">В **иерархии**, разверните **остров**.</span><span class="sxs-lookup"><span data-stu-id="0268b-216">In **Hierarchy**, expand **Island**.</span></span>
    * <span data-ttu-id="0268b-217">Выберите **MixedRealityLand**.</span><span class="sxs-lookup"><span data-stu-id="0268b-217">Select **MixedRealityLand**.</span></span>
    * <span data-ttu-id="0268b-218">В **инспектор**, нажмите кнопку **добавить компонент**.</span><span class="sxs-lookup"><span data-stu-id="0268b-218">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="0268b-219">Тип **коснитесь место** и выберите его.</span><span class="sxs-lookup"><span data-stu-id="0268b-219">Type **Tap To Place** and select it.</span></span>
    * <span data-ttu-id="0268b-220">Проверьте **снабдить родительского Tap**.</span><span class="sxs-lookup"><span data-stu-id="0268b-220">Check **Place Parent On Tap**.</span></span>
    * <span data-ttu-id="0268b-221">Задайте **смещение размещения** для **(0, 0.1, 0)**.</span><span class="sxs-lookup"><span data-stu-id="0268b-221">Set **Placement Offset** to **(0, 0.1, 0)**.</span></span>
* <span data-ttu-id="0268b-222">Сохраните и выполните сборку как и раньше</span><span class="sxs-lookup"><span data-stu-id="0268b-222">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="0268b-223">Подробно о коде</span><span class="sxs-lookup"><span data-stu-id="0268b-223">Digging into the code</span></span>

<span data-ttu-id="0268b-224">**Сценарий 1 - GamepadInput.cs**</span><span class="sxs-lookup"><span data-stu-id="0268b-224">**Script 1 - GamepadInput.cs**</span></span>

<span data-ttu-id="0268b-225">На панели «проект» перейдите к **Assets\HoloToolkit\Input\Scripts\InputSources** и дважды щелкните **GamepadInput.cs** чтобы открыть его.</span><span class="sxs-lookup"><span data-stu-id="0268b-225">In the project panel navigate to **Assets\HoloToolkit\Input\Scripts\InputSources** and double click **GamepadInput.cs** to open it.</span></span> <span data-ttu-id="0268b-226">В тот же путь «проект», также дважды щелкните **InteractionSourceInputSource.cs**.</span><span class="sxs-lookup"><span data-stu-id="0268b-226">From the same path in the project panel, also double click **InteractionSourceInputSource.cs**.</span></span>

<span data-ttu-id="0268b-227">Обратите внимание на то, что оба сценария имеют общий базовый класс BaseInputSource.</span><span class="sxs-lookup"><span data-stu-id="0268b-227">Note that both scripts have a common base class, BaseInputSource.</span></span>

<span data-ttu-id="0268b-228">BaseInputSource хранит ссылки на InputManager, что позволяет скрипт для активации событий.</span><span class="sxs-lookup"><span data-stu-id="0268b-228">BaseInputSource keeps a reference to an InputManager, which allows a script to trigger events.</span></span> <span data-ttu-id="0268b-229">В этом случае событие InputClicked относится.</span><span class="sxs-lookup"><span data-stu-id="0268b-229">In this case, the InputClicked event is relevant.</span></span> <span data-ttu-id="0268b-230">Это будет важно помнить, когда мы приступим к сценария 2, TapToPlace.</span><span class="sxs-lookup"><span data-stu-id="0268b-230">This will be important to remember when we get to script 2, TapToPlace.</span></span> <span data-ttu-id="0268b-231">В случае GamePadInput мы опроса на контроллере Нажимаемые кнопки A, а затем мы событие InputClicked.</span><span class="sxs-lookup"><span data-stu-id="0268b-231">In the case of GamePadInput, we poll for the A button on the controller to be pressed, then we raise the InputClicked event.</span></span> <span data-ttu-id="0268b-232">В случае InteractionSourceInputSource мы событие InputClicked в ответ на TappedEvent.</span><span class="sxs-lookup"><span data-stu-id="0268b-232">In the case of InteractionSourceInputSource, we raise the InputClicked event in response to the TappedEvent.</span></span>

<span data-ttu-id="0268b-233">**Сценарий 2 - TapToPlace.cs**</span><span class="sxs-lookup"><span data-stu-id="0268b-233">**Script 2 - TapToPlace.cs**</span></span>

<span data-ttu-id="0268b-234">На панели «проект» перейдите к **Assets\HoloToolkit\SpatialMapping\Scripts** и дважды щелкните **TapToPlace.cs** чтобы открыть его.</span><span class="sxs-lookup"><span data-stu-id="0268b-234">In the project panel navigate to **Assets\HoloToolkit\SpatialMapping\Scripts** and double click **TapToPlace.cs** to open it.</span></span>

<span data-ttu-id="0268b-235">Первое, что многие разработчики желают реализовать при создании Holographic приложения — это перенос голограммы с входными данными жеста.</span><span class="sxs-lookup"><span data-stu-id="0268b-235">The first thing many developers want to implement when creating a Holographic application is moving Holograms with gesture input.</span></span> <span data-ttu-id="0268b-236">Таким образом мы endeavored тщательно преобразовывать в комментарии этот сценарий.</span><span class="sxs-lookup"><span data-stu-id="0268b-236">As such, we've endeavored to thoroughly comment this script.</span></span> <span data-ttu-id="0268b-237">Несколько моментов заслуживают выделение для этого руководства.</span><span class="sxs-lookup"><span data-stu-id="0268b-237">A few things are worth highlighting for this tutorial.</span></span>

<span data-ttu-id="0268b-238">Во-первых Обратите внимание на то, что TapToPlace реализует IInputClickHandler.</span><span class="sxs-lookup"><span data-stu-id="0268b-238">First, note that TapToPlace implements IInputClickHandler.</span></span> <span data-ttu-id="0268b-239">IInputClickHandler предоставляет функции, которые обрабатывают InputClicked событие GamePadInput.cs или InteractionSourceInputSource.cs.</span><span class="sxs-lookup"><span data-stu-id="0268b-239">IInputClickHandler exposes the functions that handle the InputClicked event raised by GamePadInput.cs or InteractionSourceInputSource.cs.</span></span> <span data-ttu-id="0268b-240">OnInputClicked вызывается, когда BaseInputSource обнаруживает щелчок, пока объект с TapToPlace находится в фокусе.</span><span class="sxs-lookup"><span data-stu-id="0268b-240">OnInputClicked is called when a BaseInputSource detects a click while the object with TapToPlace is in focus.</span></span> <span data-ttu-id="0268b-241">Либо совершающая жест касания в HoloLens, либо нажав кнопку A на контроллер Xbox будет активировать событие.</span><span class="sxs-lookup"><span data-stu-id="0268b-241">Either airtapping on HoloLens or pressing the A button on the Xbox controller will trigger the event.</span></span>

<span data-ttu-id="0268b-242">Во-вторых — код выполнен в обновлении см. в разделе, если поверхность разрабатывается в, мы может размещать объект игр на поверхности, таких как таблицы.</span><span class="sxs-lookup"><span data-stu-id="0268b-242">Second is the code be executed in update to see if a surface is being looked at so we can place the game object on a surface, like a table.</span></span> <span data-ttu-id="0268b-243">Иммерсивных гарнитура нет понятие реальных рабочих областей, поэтому объект, представляющий верхней таблице (Vroom > TableThingy > куб) был помечен на уровне SpatialMapping физики, поэтому луч приведения в обновлении будет конфликтовать с верхней виртуальной таблицы.</span><span class="sxs-lookup"><span data-stu-id="0268b-243">The immersive headset doesn't have a concept of real surfaces, so the object that represents the table top (Vroom > TableThingy > Cube) has been marked with the SpatialMapping physics layer, so the ray cast in Update will collide with the virtual table top.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="0268b-244">Наслаждайтесь хода выполнения</span><span class="sxs-lookup"><span data-stu-id="0268b-244">Enjoy your progress</span></span>

<span data-ttu-id="0268b-245">Это время можно выбрать область, чтобы переместить его.</span><span class="sxs-lookup"><span data-stu-id="0268b-245">This time you can select the island to move it.</span></span> <span data-ttu-id="0268b-246">На HoloLens острова, которая может перемещать реальных область.</span><span class="sxs-lookup"><span data-stu-id="0268b-246">On HoloLens you can move the island to a real surface.</span></span> <span data-ttu-id="0268b-247">В иммерсивных гарнитура можно переместить область для виртуальную таблицу, который мы добавили.</span><span class="sxs-lookup"><span data-stu-id="0268b-247">In the immersive headset you can move the island to the virtual table we added.</span></span>

## <a name="chapter-3---sharing"></a><span data-ttu-id="0268b-248">Глава 3 - совместное использование</span><span class="sxs-lookup"><span data-stu-id="0268b-248">Chapter 3 - Sharing</span></span>

>[!VIDEO https://www.youtube.com/embed/1diycJvxfDc]

### <a name="objectives"></a><span data-ttu-id="0268b-249">Цели</span><span class="sxs-lookup"><span data-stu-id="0268b-249">Objectives</span></span>

<span data-ttu-id="0268b-250">Убедитесь, что сеть настроена правильно и подробной информации о том, как пространственных привязки являются общими для устройств.</span><span class="sxs-lookup"><span data-stu-id="0268b-250">Ensure that the network is correctly configured and detail how spatial anchors are shared between devices.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="0268b-251">Мы построим</span><span class="sxs-lookup"><span data-stu-id="0268b-251">What we will build</span></span>

<span data-ttu-id="0268b-252">Мы преобразуем наш проект в проект многопользовательского режима.</span><span class="sxs-lookup"><span data-stu-id="0268b-252">We will convert our project to a multiplayer project.</span></span> <span data-ttu-id="0268b-253">Мы добавим пользовательский Интерфейс и логика сеансов узла или соединения.</span><span class="sxs-lookup"><span data-stu-id="0268b-253">We will add UI and logic to host or join sessions.</span></span> <span data-ttu-id="0268b-254">HoloLens пользователи будут видеть друг с другом в сеансе с облаками над головой и иммерсивных гарнитура пользователи имеют облаков рядом которых привязка является.</span><span class="sxs-lookup"><span data-stu-id="0268b-254">HoloLens users will see each other in the session with clouds over their heads, and immersive headset users have clouds near to where the anchor is.</span></span> <span data-ttu-id="0268b-255">Пользователи в иммерсивную будут видеть пользователи HoloLens относительно начала координат сцены.</span><span class="sxs-lookup"><span data-stu-id="0268b-255">Users in the immersive headsets will see the HoloLens users relative to the origin of the scene.</span></span> <span data-ttu-id="0268b-256">Все HoloLens пользователи будут видеть голограмма острова в том же месте.</span><span class="sxs-lookup"><span data-stu-id="0268b-256">HoloLens users will all see the hologram of the island in the same place.</span></span> <span data-ttu-id="0268b-257">Очень важно не будет на острове во время этой главе пользователей в иммерсивную, но будет работают почти так же HoloLens, представление глаз птиц острова.</span><span class="sxs-lookup"><span data-stu-id="0268b-257">It is key to note that the users in the immersive headsets will not be on the island during this chapter, but will behave very similarly to HoloLens, with a birds eye view of the island.</span></span>

### <a name="steps"></a><span data-ttu-id="0268b-258">Действия</span><span class="sxs-lookup"><span data-stu-id="0268b-258">Steps</span></span>
* <span data-ttu-id="0268b-259">Remove-Херд и VRRoom</span><span class="sxs-lookup"><span data-stu-id="0268b-259">Remove Island and VRRoom</span></span>
    * <span data-ttu-id="0268b-260">В **иерархии** щелкните правой кнопкой мыши **остров** выберите **удалить**</span><span class="sxs-lookup"><span data-stu-id="0268b-260">In **Hierarchy** right-click **Island** select **Delete**</span></span>
    * <span data-ttu-id="0268b-261">В **иерархии** щелкните правой кнопкой мыши **VRRoom** выберите **удалить**</span><span class="sxs-lookup"><span data-stu-id="0268b-261">In **Hierarchy** right-click **VRRoom** select **Delete**</span></span>
* <span data-ttu-id="0268b-262">Добавить Usland</span><span class="sxs-lookup"><span data-stu-id="0268b-262">Add Usland</span></span>
    * <span data-ttu-id="0268b-263">Из **AppPrefabs** перетащите **Usland** для **иерархии**.</span><span class="sxs-lookup"><span data-stu-id="0268b-263">From **AppPrefabs** drag **Usland** to **Hierarchy**.</span></span>
* <span data-ttu-id="0268b-264">Из **AppPrefabs** перетащите каждый из следующих действий, чтобы **иерархии**:</span><span class="sxs-lookup"><span data-stu-id="0268b-264">From **AppPrefabs** drag each of the following to **Hierarchy**:</span></span>
    * <span data-ttu-id="0268b-265">**UNETSharingStage**</span><span class="sxs-lookup"><span data-stu-id="0268b-265">**UNETSharingStage**</span></span>
    * <span data-ttu-id="0268b-266">**UNetAnchorRoot**</span><span class="sxs-lookup"><span data-stu-id="0268b-266">**UNetAnchorRoot**</span></span>
    * <span data-ttu-id="0268b-267">**UIContainer**</span><span class="sxs-lookup"><span data-stu-id="0268b-267">**UIContainer**</span></span>
    * <span data-ttu-id="0268b-268">**DebugPanelButton**</span><span class="sxs-lookup"><span data-stu-id="0268b-268">**DebugPanelButton**</span></span>
* <span data-ttu-id="0268b-269">Сохраните и выполните сборку как и раньше</span><span class="sxs-lookup"><span data-stu-id="0268b-269">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="0268b-270">Подробно о коде</span><span class="sxs-lookup"><span data-stu-id="0268b-270">Digging into the code</span></span>

<span data-ttu-id="0268b-271">На панели «проект» перейдите к **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** и дважды щелкните **UnetAnchorManager.cs**.</span><span class="sxs-lookup"><span data-stu-id="0268b-271">In the project panel, navigate to **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** and double-click on **UnetAnchorManager.cs**.</span></span> <span data-ttu-id="0268b-272">Возможность для одного HoloLens предоставить сведения об отслеживании другой HoloLens, таким образом, что оба устройства могут совместно использовать то же пространство расположено волшебное средство разрешения.</span><span class="sxs-lookup"><span data-stu-id="0268b-272">The ability for one HoloLens to share tracking information with another HoloLens such that both devices can share the same space is near magical.</span></span> <span data-ttu-id="0268b-273">Мощь смешанной реальности оживает, когда два или больше пользователей могут совместно работать с помощью тех же цифровых данных.</span><span class="sxs-lookup"><span data-stu-id="0268b-273">The power of mixed reality comes alive when two or more people can collaborate using the same digital data.</span></span>

<span data-ttu-id="0268b-274">Необходимо отметить в этом сценарии несколько вещей:</span><span class="sxs-lookup"><span data-stu-id="0268b-274">A few things to point out in this script:</span></span>

<span data-ttu-id="0268b-275">В функции запуска, обратите внимание, что проверка **IsDisplayOpaque**.</span><span class="sxs-lookup"><span data-stu-id="0268b-275">In the start function, notice the check for **IsDisplayOpaque**.</span></span> <span data-ttu-id="0268b-276">В этом случае мы представьте, что привязка устанавливается.</span><span class="sxs-lookup"><span data-stu-id="0268b-276">In this case, we pretend that the Anchor is established.</span></span> <span data-ttu-id="0268b-277">Это обусловлено иммерсивную не предоставляют способ импорта или экспорта привязки.</span><span class="sxs-lookup"><span data-stu-id="0268b-277">This is because the immersive headsets do not expose a way to import or export anchors.</span></span> <span data-ttu-id="0268b-278">Если работа происходит в HoloLens, тем не менее, этот сценарий реализует доступом привязки между устройствами.</span><span class="sxs-lookup"><span data-stu-id="0268b-278">If we are running on a HoloLens, however, this script implements sharing anchors between the devices.</span></span> <span data-ttu-id="0268b-279">Устройство, которое запускает сеанс будет создавать привязки для экспорта.</span><span class="sxs-lookup"><span data-stu-id="0268b-279">The device that starts the session will create an anchor for exporting.</span></span> <span data-ttu-id="0268b-280">Устройства, который присоединяется к сеансу запроса привязки с устройства, запустившего сеанс.</span><span class="sxs-lookup"><span data-stu-id="0268b-280">The device that joins a session will request the anchor from the device that started the session.</span></span>

<span data-ttu-id="0268b-281">**Экспорт:**</span><span class="sxs-lookup"><span data-stu-id="0268b-281">**Exporting:**</span></span>

<span data-ttu-id="0268b-282">Когда пользователь создает сеанс, NetworkDiscoveryWithAnchors будет вызывать функцию UNETAnchorManagers CreateAnchor.</span><span class="sxs-lookup"><span data-stu-id="0268b-282">When a user creates a session, NetworkDiscoveryWithAnchors will call UNETAnchorManagers CreateAnchor function.</span></span> <span data-ttu-id="0268b-283">Рассмотрим CreateAnchor потока.</span><span class="sxs-lookup"><span data-stu-id="0268b-283">Let's follow CreateAnchor flow.</span></span>

<span data-ttu-id="0268b-284">Мы начнем с выполнения действия по обслуживанию, очищая все данные, которые для предыдущих привязки мы собрали.</span><span class="sxs-lookup"><span data-stu-id="0268b-284">We start by doing some housekeeping, clearing out any data we may have collected for previous anchors.</span></span> <span data-ttu-id="0268b-285">Затем мы проверяем, существует ли кэшированный привязки для загрузки.</span><span class="sxs-lookup"><span data-stu-id="0268b-285">Then we check if there is a cached anchor to load.</span></span> <span data-ttu-id="0268b-286">Привязки данных, как правило, находиться в диапазоне от 5 до 20 МБ, поэтому повторное использование кэшированных привязки можно сэкономить на объем данных, которые необходимо передать по сети.</span><span class="sxs-lookup"><span data-stu-id="0268b-286">The anchor data tends to be between 5 and 20 MB, so reusing cached anchors can save on the amount of data we need to transfer over the network.</span></span> <span data-ttu-id="0268b-287">Мы увидим, как это работает немного позже.</span><span class="sxs-lookup"><span data-stu-id="0268b-287">We'll see how this works a bit later.</span></span> <span data-ttu-id="0268b-288">Даже если мы повторно привязки, нам нужно получить данные готовы в случае, если присоединяется новый клиент, не имеет привязки к привязки.</span><span class="sxs-lookup"><span data-stu-id="0268b-288">Even if we are reusing the anchor, we need to get the anchor data ready in case a new client joins that doesn't have the anchor.</span></span>

<span data-ttu-id="0268b-289">Говоря о подготовке данных привязки, класс WorldAnchorTransferBatch предоставляет функциональные возможности для подготовки данных привязки для отправки на другое устройство или приложение и функциональные возможности для импорта данных привязки.</span><span class="sxs-lookup"><span data-stu-id="0268b-289">Speaking of getting the anchor data ready, the WorldAnchorTransferBatch class exposes the functionality to prepare anchor data for sending to another device or application and the functionality to import the anchor data.</span></span> <span data-ttu-id="0268b-290">Мы обеспечиваем для пути экспорта, мы добавим наши привязки к WorldAnchorTransferBatch и вызовите функцию ExportAsync.</span><span class="sxs-lookup"><span data-stu-id="0268b-290">Since we're on the export path, we will add our anchor to the WorldAnchorTransferBatch and call the ExportAsync function.</span></span> <span data-ttu-id="0268b-291">ExportAsync затем вызовет WriteBuffer обратный вызов, при формировании данных для экспорта.</span><span class="sxs-lookup"><span data-stu-id="0268b-291">ExportAsync will then call the WriteBuffer callback as it generates data for export.</span></span> <span data-ttu-id="0268b-292">Когда все данные были экспортированы ExportComplete будет вызываться.</span><span class="sxs-lookup"><span data-stu-id="0268b-292">When all of the data has been exported ExportComplete will be called.</span></span> <span data-ttu-id="0268b-293">В WriteBuffer мы добавим фрагмент данных в список, мы не для экспорта.</span><span class="sxs-lookup"><span data-stu-id="0268b-293">In WriteBuffer we add the chunk of data to a list we keep for exporting.</span></span> <span data-ttu-id="0268b-294">В ExportComplete преобразование списка в массив.</span><span class="sxs-lookup"><span data-stu-id="0268b-294">In ExportComplete we convert the list to an array.</span></span> <span data-ttu-id="0268b-295">AnchorName переменной также задается, который будет активировать другие устройства для запроса привязки, если они не имеют.</span><span class="sxs-lookup"><span data-stu-id="0268b-295">The AnchorName variable is also set, which will trigger other devices to request the anchor if they don't have it.</span></span>

<span data-ttu-id="0268b-296">В некоторых случаях привязка не экспортировать или создаст лишь небольшой объем данных, мы повторит попытку.</span><span class="sxs-lookup"><span data-stu-id="0268b-296">In some cases the anchor won't export or will create so little data that we will try again.</span></span> <span data-ttu-id="0268b-297">Здесь мы вызываем CreateAnchor еще раз.</span><span class="sxs-lookup"><span data-stu-id="0268b-297">Here we just call CreateAnchor again.</span></span>

<span data-ttu-id="0268b-298">Конечная функция в исходном каталоге — AnchorFoundRemotely.</span><span class="sxs-lookup"><span data-stu-id="0268b-298">A final function in the export path is AnchorFoundRemotely.</span></span> <span data-ttu-id="0268b-299">Если другое устройство находит точку привязки, это устройство будет сообщить этому приложению и узел будет использовать его в качестве сигнала, что привязка является «хорошей привязки» и могут кэшироваться.</span><span class="sxs-lookup"><span data-stu-id="0268b-299">When another device finds the anchor, that device will tell the host, and the host will use that as a signal that the anchor is a "good anchor" and can be cached.</span></span>

<span data-ttu-id="0268b-300">**Импорт:**</span><span class="sxs-lookup"><span data-stu-id="0268b-300">**Importing:**</span></span>

<span data-ttu-id="0268b-301">Когда HoloLens присоединяется к сеансу, ему необходимо импортировать привязку.</span><span class="sxs-lookup"><span data-stu-id="0268b-301">When a HoloLens joins a session, it needs to import an anchor.</span></span> <span data-ttu-id="0268b-302">В функции обновления в UNETAnchorManager опрашивается AnchorName.</span><span class="sxs-lookup"><span data-stu-id="0268b-302">In UNETAnchorManager's Update function, the AnchorName is polled.</span></span> <span data-ttu-id="0268b-303">При изменении имени привязки, начинается процесс импорта.</span><span class="sxs-lookup"><span data-stu-id="0268b-303">When the anchor name changes, the import process begins.</span></span> <span data-ttu-id="0268b-304">Во-первых мы попытаемся загрузить привязку с указанным именем из локального хранилища привязки.</span><span class="sxs-lookup"><span data-stu-id="0268b-304">First, we try to load the anchor with the specified name from the local anchor store.</span></span> <span data-ttu-id="0268b-305">Если мы сделали, мы используем его без загрузки данных еще раз.</span><span class="sxs-lookup"><span data-stu-id="0268b-305">If we already have it, we can use it without downloading the data again.</span></span> <span data-ttu-id="0268b-306">Если у нас его нет, мы называем WaitForAnchor, которые будут инициировать загрузку.</span><span class="sxs-lookup"><span data-stu-id="0268b-306">If we don't have it, then we call WaitForAnchor which will initiate the download.</span></span>

<span data-ttu-id="0268b-307">По завершении загрузки называется NetworkTransmitter_dataReadyEvent.</span><span class="sxs-lookup"><span data-stu-id="0268b-307">When the download is completed, NetworkTransmitter_dataReadyEvent is called.</span></span> <span data-ttu-id="0268b-308">Это даст сигнал цикла обновления для вызова ImportAsync с загруженными данными.</span><span class="sxs-lookup"><span data-stu-id="0268b-308">This will signal the Update loop to call ImportAsync with the downloaded data.</span></span> <span data-ttu-id="0268b-309">ImportAsync вызовет ImportComplete после завершения процесса импорта.</span><span class="sxs-lookup"><span data-stu-id="0268b-309">ImportAsync will call ImportComplete when the import process is complete.</span></span> <span data-ttu-id="0268b-310">Если импорт прошел успешно, привязка будет сохраняться в хранилище локального проигрывателя.</span><span class="sxs-lookup"><span data-stu-id="0268b-310">If the import is successful, the anchor will be saved in the local player store.</span></span> <span data-ttu-id="0268b-311">PlayerController.cs фактически выполняется вызов AnchorFoundRemotely позволяет знать, что было установлено хороший привязки узла.</span><span class="sxs-lookup"><span data-stu-id="0268b-311">PlayerController.cs actually makes the call to AnchorFoundRemotely to let the host know that a good anchor has been established.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="0268b-312">Наслаждайтесь хода выполнения</span><span class="sxs-lookup"><span data-stu-id="0268b-312">Enjoy your progress</span></span>

<span data-ttu-id="0268b-313">Это время пользователь с HoloLens будет размещаться сеанс с помощью **запуск сеанса** кнопку в пользовательском Интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="0268b-313">This time a user with a HoloLens will host a session using the **start session** button in the UI.</span></span> <span data-ttu-id="0268b-314">Другим пользователям, как на HoloLens или иммерсивных гарнитура, необходимо выберите сеанс и выберите пункт **веб-трансляции** кнопку в пользовательском Интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="0268b-314">Other users, both on HoloLens or an immersive headset, will select the session and then select the **join session** button in the UI.</span></span> <span data-ttu-id="0268b-315">Если у вас есть несколько пользователей с устройствами, HoloLens, они будут иметь красный облаков над головой.</span><span class="sxs-lookup"><span data-stu-id="0268b-315">If you have multiple people with HoloLens devices, they will have red clouds over their heads.</span></span> <span data-ttu-id="0268b-316">Также будет синее облако для каждого иммерсивных гарнитура, но синие облака не будут выше гарнитуры, как гарнитуры не удается найти же мировых координат как устройства HoloLens.</span><span class="sxs-lookup"><span data-stu-id="0268b-316">There will also be a blue cloud for each immersive headset, but the blue clouds will not be above the headsets, as the headsets are not trying to find the same world coordinate space as the HoloLens devices.</span></span>

<span data-ttu-id="0268b-317">Эту точку в проекте является автономной приложение для управления доступом; очень ничего не делает она может работать в качестве базового плана.</span><span class="sxs-lookup"><span data-stu-id="0268b-317">This point in the project is a contained sharing application; it doesn't do very much, and could act as a baseline.</span></span> <span data-ttu-id="0268b-318">В следующей главах будет приступать к созданию взаимодействие для пользователей, чтобы воспользоваться.</span><span class="sxs-lookup"><span data-stu-id="0268b-318">In the next chapters, we will start building an experience for people to enjoy.</span></span> <span data-ttu-id="0268b-319">Чтобы получить дополнительные рекомендации по опытом разработки, перейдите сюда.</span><span class="sxs-lookup"><span data-stu-id="0268b-319">To get further guidance on shared experience design, go here.</span></span>

## <a name="chapter-4---immersion-and-teleporting"></a><span data-ttu-id="0268b-320">Глава 4 – общения и teleporting</span><span class="sxs-lookup"><span data-stu-id="0268b-320">Chapter 4 - Immersion and teleporting</span></span>

>[!VIDEO https://www.youtube.com/embed/kUHZ5tCOfvY]

### <a name="objectives"></a><span data-ttu-id="0268b-321">Цели</span><span class="sxs-lookup"><span data-stu-id="0268b-321">Objectives</span></span>

<span data-ttu-id="0268b-322">Обслуживайте интерфейс для каждого типа устройств смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="0268b-322">Cater the experience to each type of mixed reality device.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="0268b-323">Мы построим</span><span class="sxs-lookup"><span data-stu-id="0268b-323">What we will build</span></span>

<span data-ttu-id="0268b-324">Мы обновим приложение для размещения пользователей иммерсивных гарнитура на острове иммерсивных представление.</span><span class="sxs-lookup"><span data-stu-id="0268b-324">We will update the application to put immersive headset users on the island with an immersive view.</span></span> <span data-ttu-id="0268b-325">HoloLens пользователи по-прежнему будут иметь вид с высоты птичьего полета острова.</span><span class="sxs-lookup"><span data-stu-id="0268b-325">HoloLens users will still have the bird's eye view of the island.</span></span> <span data-ttu-id="0268b-326">Пользователи каждого из типов устройств можно видеть других пользователей, как они указаны в мире.</span><span class="sxs-lookup"><span data-stu-id="0268b-326">Users of each device type can see other users as they appear in the world.</span></span> <span data-ttu-id="0268b-327">К примеру иммерсивных гарнитура пользователи могут видеть другие аватары на других путях на острове, и они видят пользователи HoloLens как giant облака выше блоке.</span><span class="sxs-lookup"><span data-stu-id="0268b-327">For instance, immersive headset users can see the other avatars on other paths on the island, and they see the HoloLens users as giant clouds above the island.</span></span> <span data-ttu-id="0268b-328">Иммерсивных гарнитура пользователи будут видеть курсор пользователя HoloLens взглядом Рэй также в том случае, если HoloLens пользователь просматривает область.</span><span class="sxs-lookup"><span data-stu-id="0268b-328">Immersive headset users will also see the cursor of the HoloLens user's gaze ray if the HoloLens user is looking at the island.</span></span> <span data-ttu-id="0268b-329">HoloLens пользователи будут видеть аватар на острове для представления каждого пользователя иммерсивных гарнитуры.</span><span class="sxs-lookup"><span data-stu-id="0268b-329">HoloLens users will see an avatar on the island to represent each immersive headset user.</span></span>

<span data-ttu-id="0268b-330">**Обновленные входные данные для Иммерсивных устройства:**</span><span class="sxs-lookup"><span data-stu-id="0268b-330">**Updated Input for the Immersive device:**</span></span>
* <span data-ttu-id="0268b-331">Проигрывателя поворота левой кнопки прокладки и правом прокладки контроллера Xbox</span><span class="sxs-lookup"><span data-stu-id="0268b-331">The left bumper and right bumper buttons on the Xbox controller rotate the player</span></span>
* <span data-ttu-id="0268b-332">Удерживая кнопку Y контроллера Xbox позволит [teleport](navigating-the-windows-mixed-reality-home.md#getting-around-your-home) курсора.</span><span class="sxs-lookup"><span data-stu-id="0268b-332">Holding the Y button on the Xbox controller will enable a [teleport](navigating-the-windows-mixed-reality-home.md#getting-around-your-home) cursor.</span></span> <span data-ttu-id="0268b-333">Если курсор будет отображаться вращающийся индикатор стрелки после отпускания кнопки Y, можно teleported в положении курсора.</span><span class="sxs-lookup"><span data-stu-id="0268b-333">If the cursor has a spinning arrow indicator when you release the Y button, you will be teleported to the cursor's location.</span></span>

### <a name="steps"></a><span data-ttu-id="0268b-334">Действия</span><span class="sxs-lookup"><span data-stu-id="0268b-334">Steps</span></span>
* <span data-ttu-id="0268b-335">Добавить MixedRealityTeleport MixedRealityCameraParent</span><span class="sxs-lookup"><span data-stu-id="0268b-335">Add MixedRealityTeleport to MixedRealityCameraParent</span></span>
    * <span data-ttu-id="0268b-336">В **иерархии**выберите **Usland**.</span><span class="sxs-lookup"><span data-stu-id="0268b-336">In **Hierarchy**, select **Usland**.</span></span>
    * <span data-ttu-id="0268b-337">В **инспектор**, включить **уровень управления**.</span><span class="sxs-lookup"><span data-stu-id="0268b-337">In **Inspector**, enable **Level Control**.</span></span>
    * <span data-ttu-id="0268b-338">В **иерархии**выберите **MixedRealityCameraParent**.</span><span class="sxs-lookup"><span data-stu-id="0268b-338">In **Hierarchy**, select **MixedRealityCameraParent**.</span></span>
    * <span data-ttu-id="0268b-339">В **инспектор**, нажмите кнопку **добавить компонент**.</span><span class="sxs-lookup"><span data-stu-id="0268b-339">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="0268b-340">Тип **смешанной реальности Teleport** и выберите его.</span><span class="sxs-lookup"><span data-stu-id="0268b-340">Type **Mixed Reality Teleport** and select it.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="0268b-341">Подробно о коде</span><span class="sxs-lookup"><span data-stu-id="0268b-341">Digging into the code</span></span>

<span data-ttu-id="0268b-342">Иммерсивных гарнитура пользователей будет привязанным к их ПК с помощью кабеля, но наши остров больше, чем кабель имеет большую длину.</span><span class="sxs-lookup"><span data-stu-id="0268b-342">Immersive headset users will be tethered to their PCs with a cable, but our island is larger than the cable is long.</span></span> <span data-ttu-id="0268b-343">Чтобы компенсировать, мы должны возможность перемещения камеры, независимо от пользователя движения.</span><span class="sxs-lookup"><span data-stu-id="0268b-343">To compensate, we need the ability to move the camera independently of the user's motion.</span></span> <span data-ttu-id="0268b-344">См. в разделе [страницы комфорта](comfort.md) Дополнительные сведения о создании собственного приложения смешанной реальности (в частности собственный движения и locomotion).</span><span class="sxs-lookup"><span data-stu-id="0268b-344">Please see the [comfort page](comfort.md) for more information about designing your mixed reality application (in particular self motion and locomotion).</span></span>

<span data-ttu-id="0268b-345">Для описания этого процесса будет полезно определить два термина.</span><span class="sxs-lookup"><span data-stu-id="0268b-345">In order to describe this process it will be useful to define two terms.</span></span> <span data-ttu-id="0268b-346">Во-первых, **наличия прицепа к арендованному** будет объектом, который перемещает камеры независимо от пользователя.</span><span class="sxs-lookup"><span data-stu-id="0268b-346">First, **dolly** will be the object that moves the camera independently from the user.</span></span> <span data-ttu-id="0268b-347">Дочерний объект игр **наличия прицепа к арендованному** будет **главной камеры**.</span><span class="sxs-lookup"><span data-stu-id="0268b-347">A child game object of the **dolly** will be the **main camera**.</span></span> <span data-ttu-id="0268b-348">Главной камеры, присоединяется к head пользователя.</span><span class="sxs-lookup"><span data-stu-id="0268b-348">The main camera is attached to the user's head.</span></span>

<span data-ttu-id="0268b-349">На панели «проект» перейдите к **Assets\AppPrefabs\Support\Scripts\GameLogic** и дважды щелкните **MixedRealityTeleport.cs**.</span><span class="sxs-lookup"><span data-stu-id="0268b-349">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **MixedRealityTeleport.cs**.</span></span>

<span data-ttu-id="0268b-350">MixedRealityTeleport имеет два задания.</span><span class="sxs-lookup"><span data-stu-id="0268b-350">MixedRealityTeleport has two jobs.</span></span> <span data-ttu-id="0268b-351">Во-первых он обрабатывает поворота с помощью по нему.</span><span class="sxs-lookup"><span data-stu-id="0268b-351">First, it handles rotation using the bumpers.</span></span> <span data-ttu-id="0268b-352">В функции обновления опроса для «ButtonUp» LeftBumper и RightBumper.</span><span class="sxs-lookup"><span data-stu-id="0268b-352">In the update function we poll for 'ButtonUp' on LeftBumper and RightBumper.</span></span> <span data-ttu-id="0268b-353">GetButtonUp только возвращает значение true на первом кадре, кнопка не нажата была вниз.</span><span class="sxs-lookup"><span data-stu-id="0268b-353">GetButtonUp only returns true on the first frame a button is up after having been down.</span></span> <span data-ttu-id="0268b-354">Если было вызвано одной из кнопок, затем мы знаем, что пользователю необходимо повернуть.</span><span class="sxs-lookup"><span data-stu-id="0268b-354">If either button had been raised, then we know the user needs to rotate.</span></span>

<span data-ttu-id="0268b-355">Когда мы повернуть мы исчезания и появление с помощью простой сценарий с именем «исчезания элемента управления».</span><span class="sxs-lookup"><span data-stu-id="0268b-355">When we rotate we do a fade out and fade in using a simple script called 'fade control'.</span></span> <span data-ttu-id="0268b-356">Это делается для предотвратить просмотр искусственных перемещения, что может привести к discomfort пользователя.</span><span class="sxs-lookup"><span data-stu-id="0268b-356">We do this to prevent the user from seeing an unnatural movement which could lead to discomfort.</span></span> <span data-ttu-id="0268b-357">Исчезания и уменьшения эффекта достаточно прост.</span><span class="sxs-lookup"><span data-stu-id="0268b-357">The fade in and out effect is fairly simple.</span></span> <span data-ttu-id="0268b-358">У нас есть черные квадрант, выступающие в начале **главной камеры**.</span><span class="sxs-lookup"><span data-stu-id="0268b-358">We have a black quad hanging in front of the **main camera**.</span></span> <span data-ttu-id="0268b-359">Когда исчезновение перехода альфа-значение от 0 до 1.</span><span class="sxs-lookup"><span data-stu-id="0268b-359">When fading out we transition the alpha value from 0 to 1.</span></span> <span data-ttu-id="0268b-360">Постепенно в результате области черных пикселей из четырех, чтобы отображать и скрывать все, за ними.</span><span class="sxs-lookup"><span data-stu-id="0268b-360">This gradually causes the black pixels of the quad to render and obscure anything behind them.</span></span> <span data-ttu-id="0268b-361">Когда плавный переход обратно в перехода альфа-значение к нулю.</span><span class="sxs-lookup"><span data-stu-id="0268b-361">When fading back in we transition the alpha value back to zero.</span></span>

<span data-ttu-id="0268b-362">Когда мы вычисляем поворот, обратите внимание, что нам требуется сменить наших **наличия прицепа к арендованному** , но вычисление поворота вокруг **главной камеры**.</span><span class="sxs-lookup"><span data-stu-id="0268b-362">When we calculate the rotation, note that we are rotating our **dolly** but calculating the rotation around the **main camera**.</span></span> <span data-ttu-id="0268b-363">Это важно, так как дальше **главной камеры** нахождение вдали 0,0,0, тем менее точным поворот вокруг наличия прицепа к арендованному стал бы с точки зрения пользователя.</span><span class="sxs-lookup"><span data-stu-id="0268b-363">This is important as the farther the **main camera** is away from 0,0,0, the less accurate a rotation around the dolly would become from the point of view of the user.</span></span> <span data-ttu-id="0268b-364">На самом деле, если вы не вращаются вокруг положение камеры, пользователь будет перемещен в дугу вокруг **наличия прицепа к арендованному** вместо того чтобы поворот.</span><span class="sxs-lookup"><span data-stu-id="0268b-364">In fact, if you do not rotate around the camera position, the user will move on an arc around the **dolly** rather than rotating.</span></span>

<span data-ttu-id="0268b-365">Второе задание для MixedRealityTeleport — переключаются **наличия прицепа к арендованному**.</span><span class="sxs-lookup"><span data-stu-id="0268b-365">The second job for MixedRealityTeleport is to handle moving the **dolly**.</span></span> <span data-ttu-id="0268b-366">Это делается в SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="0268b-366">This is done in SetWorldPosition.</span></span> <span data-ttu-id="0268b-367">SetWorldPosition занимает позицию нужного world позицию, где пользователь хочет percieve, они находятся.</span><span class="sxs-lookup"><span data-stu-id="0268b-367">SetWorldPosition takes the desired world position, the position where the user wants to percieve that they inhabit.</span></span> <span data-ttu-id="0268b-368">Нам нужно поместить наш **наличия прицепа к арендованному** в этой позиции минус локального положение **главной камеры**, поскольку этому смещению появляются в каждом кадре.</span><span class="sxs-lookup"><span data-stu-id="0268b-368">We need to put our **dolly** at that position minus the local position of the **main camera**, as that offset will be added each frame.</span></span>

<span data-ttu-id="0268b-369">Второй сценарий вызывает SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="0268b-369">A second script calls SetWorldPosition.</span></span> <span data-ttu-id="0268b-370">Давайте взглянем на этот скрипт.</span><span class="sxs-lookup"><span data-stu-id="0268b-370">Let's look at that script.</span></span> <span data-ttu-id="0268b-371">На панели «проект» перейдите к **Assets\AppPrefabs\Support\Scripts\GameLogic** и дважды щелкните **TeleportScript.cs**.</span><span class="sxs-lookup"><span data-stu-id="0268b-371">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **TeleportScript.cs**.</span></span>

<span data-ttu-id="0268b-372">Этот сценарий немного сложнее, чем MixedRealityTeleport.</span><span class="sxs-lookup"><span data-stu-id="0268b-372">This script is a little more involved than MixedRealityTeleport.</span></span> <span data-ttu-id="0268b-373">Сценарий проверяет наличие Y кнопки контроллера Xbox пройдет.</span><span class="sxs-lookup"><span data-stu-id="0268b-373">The script is checking for the Y Button on the Xbox controller to be held down.</span></span> <span data-ttu-id="0268b-374">Во время удержания кнопки вниз teleport курсор отображается и скрипт приводит лучом, проведенным из положение взглядом пользователя.</span><span class="sxs-lookup"><span data-stu-id="0268b-374">While the button is held down a teleport cursor is rendered and the script casts a ray from the user's gaze position.</span></span> <span data-ttu-id="0268b-375">Если, Рэй конфликтует с поверхностью, больше или меньше указывающая вверх, рабочей области будет считаться хорошим область, чтобы teleport для, и анимации для курсора teleport будет включена.</span><span class="sxs-lookup"><span data-stu-id="0268b-375">If that ray collides with a surface that is more or less pointing up, the surface will be considered a good surface to teleport to, and the animation on the teleport cursor will be enabled.</span></span> <span data-ttu-id="0268b-376">Если луч не пересекается с поверхность более или менее, указывающего, анимации на курсор будет недоступен.</span><span class="sxs-lookup"><span data-stu-id="0268b-376">If the ray does not collide with a surface more or less pointing up, then the animation on the cursor will be disabled.</span></span> <span data-ttu-id="0268b-377">При отпускании кнопки Y и вычисляемые луча, она допустимую позицию, сценарий вызывает SetWorldPosition с позицией, пересеченной лучом.</span><span class="sxs-lookup"><span data-stu-id="0268b-377">When the Y button is released and the calculated point of the ray is a valid position, the script calls SetWorldPosition with the position the ray intersected.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="0268b-378">Наслаждайтесь хода выполнения</span><span class="sxs-lookup"><span data-stu-id="0268b-378">Enjoy your progress</span></span>

<span data-ttu-id="0268b-379">Это время необходимо найти друга.</span><span class="sxs-lookup"><span data-stu-id="0268b-379">This time you'll need to find a friend.</span></span>

<span data-ttu-id="0268b-380">Опять же пользователь с HoloLens будет поддерживать сеанс.</span><span class="sxs-lookup"><span data-stu-id="0268b-380">Once again, a user with the HoloLens will host a session.</span></span> <span data-ttu-id="0268b-381">Другим пользователям будет подключиться к сеансу.</span><span class="sxs-lookup"><span data-stu-id="0268b-381">Other users will join the session.</span></span> <span data-ttu-id="0268b-382">Приложение будет помещен в первых трех пользователей, для присоединения из иммерсивных гарнитура на один из трех путей на острове.</span><span class="sxs-lookup"><span data-stu-id="0268b-382">The application will place the first three users to join from an immersive headset on one of the three paths on the island.</span></span> <span data-ttu-id="0268b-383">Вы можете просмотреть острова, которая в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="0268b-383">Feel free to explore the island in this section.</span></span>

<span data-ttu-id="0268b-384">Сведения о необходимо обратить внимание:</span><span class="sxs-lookup"><span data-stu-id="0268b-384">Details to notice:</span></span>
1. <span data-ttu-id="0268b-385">Вы увидите лиц в облаках, что позволяет пользователю immersed направление, в котором пользователь HoloLens см. в разделе.</span><span class="sxs-lookup"><span data-stu-id="0268b-385">You can see faces in the clouds, which helps an immersed user see which direction a HoloLens user is looking.</span></span>
2. <span data-ttu-id="0268b-386">Аватары на острове имеют necks, поворот.</span><span class="sxs-lookup"><span data-stu-id="0268b-386">The avatars on the island have necks that rotate.</span></span> <span data-ttu-id="0268b-387">Они не соответствуют действия пользователя является реальной (мы не смогли их), но оно делает, неплохо работать.</span><span class="sxs-lookup"><span data-stu-id="0268b-387">They won't follow what the user is doing is real reality (we don't have that information) but it makes for a nice experience.</span></span>
3. <span data-ttu-id="0268b-388">Если пользователь HoloLens просматривает островом, immersed пользователи могут просматривать их курсора.</span><span class="sxs-lookup"><span data-stu-id="0268b-388">If the HoloLens user is looking at the Island, the immersed users can see their cursor.</span></span>
4. <span data-ttu-id="0268b-389">Облаках, которые представляют пользователей, HoloLens приведение теней.</span><span class="sxs-lookup"><span data-stu-id="0268b-389">The clouds that represent the HoloLens users cast shadows.</span></span>

## <a name="chapter-5---finale"></a><span data-ttu-id="0268b-390">Глава 5 - некоторые</span><span class="sxs-lookup"><span data-stu-id="0268b-390">Chapter 5 - Finale</span></span>

>[!VIDEO https://www.youtube.com/embed/n_HDWJbfpNg]

### <a name="objectives"></a><span data-ttu-id="0268b-391">Цели</span><span class="sxs-lookup"><span data-stu-id="0268b-391">Objectives</span></span>

<span data-ttu-id="0268b-392">Создайте интерактивные возможности для совместной работы между типами двух устройств.</span><span class="sxs-lookup"><span data-stu-id="0268b-392">Create a collaborative interactive experience between the two device types.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="0268b-393">Мы построим</span><span class="sxs-lookup"><span data-stu-id="0268b-393">What we will build</span></span>

<span data-ttu-id="0268b-394">Пользователи HoloLens, основываясь на главе 4, когда пользователь с иммерсивных гарнитура получает практически головоломку на острове, получат всплывающей подсказкой с ключом к головоломки.</span><span class="sxs-lookup"><span data-stu-id="0268b-394">Building on chapter 4, when a user with an immersive headset gets near a puzzle on the island, the HoloLens users will get a tool tip with a clue to the puzzle.</span></span> <span data-ttu-id="0268b-395">После всех пользователей иммерсивных гарнитура получить прошлые головоломок и на «Готово pad» в комнате rocket, ракеты приведет к запуску.</span><span class="sxs-lookup"><span data-stu-id="0268b-395">Once all of the immersive headset users get past their puzzles and onto the "ready pad" in the rocket room, the rocket will launch.</span></span>

### <a name="steps"></a><span data-ttu-id="0268b-396">Действия</span><span class="sxs-lookup"><span data-stu-id="0268b-396">Steps</span></span>
* <span data-ttu-id="0268b-397">В **иерархии**выберите **Usland**.</span><span class="sxs-lookup"><span data-stu-id="0268b-397">In **Hierarchy**, select **Usland**.</span></span>
* <span data-ttu-id="0268b-398">В **инспектор**в **уровень управления**, проверьте **включить совместной работы**.</span><span class="sxs-lookup"><span data-stu-id="0268b-398">In **Inspector**, in **Level Control**, check **Enable Collaboration**.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="0268b-399">Подробно о коде</span><span class="sxs-lookup"><span data-stu-id="0268b-399">Digging into the code</span></span>

<span data-ttu-id="0268b-400">Теперь давайте рассмотрим LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="0268b-400">Now let us look at LevelControl.cs.</span></span> <span data-ttu-id="0268b-401">Этот сценарий является основой логику игры и обслуживает состояния игры.</span><span class="sxs-lookup"><span data-stu-id="0268b-401">This script is the core of the game logic and maintains the game state.</span></span> <span data-ttu-id="0268b-402">Так как это игры с помощью UNET нам нужно понять, как данные перемещаются, по крайней мере достаточной для изменения в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="0268b-402">Since this is a multiplayer game using UNET we need to understand how data flows, at least well enough to modify this tutorial.</span></span> <span data-ttu-id="0268b-403">Для более полного представления о UNET обратитесь к документации Unity.</span><span class="sxs-lookup"><span data-stu-id="0268b-403">For a more complete overview of UNET, please refer to Unity's documentation.</span></span>

<span data-ttu-id="0268b-404">На панели «проект» перейдите к **Assets\AppPrefabs\Support\Scripts\GameLogic** и дважды щелкните **LevelControl.cs**.</span><span class="sxs-lookup"><span data-stu-id="0268b-404">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **LevelControl.cs**.</span></span>

<span data-ttu-id="0268b-405">Сообщите нам понять, как иммерсивных гарнитура сообщает, что они готовы к запуску rocket.</span><span class="sxs-lookup"><span data-stu-id="0268b-405">Let us understand how an immersive headset indicates that they are ready for the rocket launch.</span></span> <span data-ttu-id="0268b-406">При установке одного из трех логические в список, соответствующие трем способам на острове логические сообщаются Rocket запуска готовности.</span><span class="sxs-lookup"><span data-stu-id="0268b-406">Rocket Launch readiness is communicated by setting one of three bools in a list of bools that correspond to the three paths on the island.</span></span> <span data-ttu-id="0268b-407">Bool контура устанавливается при пользователя, присвоенный пути находится на вершине коричневая панель внутри rocket комнаты.</span><span class="sxs-lookup"><span data-stu-id="0268b-407">A path's bool will be set when the user assigned to the path is on top of the brown pad inside the rocket room.</span></span> <span data-ttu-id="0268b-408">Итак, теперь к деталям.</span><span class="sxs-lookup"><span data-stu-id="0268b-408">Okay, now to the details.</span></span>

<span data-ttu-id="0268b-409">Мы начнем в функцию Update().</span><span class="sxs-lookup"><span data-stu-id="0268b-409">We will start in the Update() function.</span></span> <span data-ttu-id="0268b-410">Обратите внимание, что имеется функция «по системам».</span><span class="sxs-lookup"><span data-stu-id="0268b-410">You will note that there is a 'cheat' function.</span></span> <span data-ttu-id="0268b-411">Мы использовали это в разработке для тестирования rocket запуска и выполнить сброс последовательности.</span><span class="sxs-lookup"><span data-stu-id="0268b-411">We used this in development to test the rocket launch and reset sequence.</span></span> <span data-ttu-id="0268b-412">Это не сработает во взаимодействие с пользователем с несколькими.</span><span class="sxs-lookup"><span data-stu-id="0268b-412">It won't work in the multi user experience.</span></span> <span data-ttu-id="0268b-413">Будем надеяться, что к моменту усвоить следующие сведения можно сделать это в действии.</span><span class="sxs-lookup"><span data-stu-id="0268b-413">Hopefully by the time you internalize the following infromation you can make it work.</span></span> <span data-ttu-id="0268b-414">После мы проверяем, см. в разделе, если следует схитрить, мы проверяем, если immersed локального проигрывателя.</span><span class="sxs-lookup"><span data-stu-id="0268b-414">After we check to see if we should cheat, we check to see if the local player is immersed.</span></span> <span data-ttu-id="0268b-415">Мы хотим сосредоточиться на том, как мы находят, что мы находимся на цель.</span><span class="sxs-lookup"><span data-stu-id="0268b-415">We want to focus on how we find that we're at the goal.</span></span> <span data-ttu-id="0268b-416">Внутри if (Immersed) Проверьте, имеется вызов CheckGoal скрытие за **EnableCollaboration** bool.</span><span class="sxs-lookup"><span data-stu-id="0268b-416">Inside of the if (Immersed) check, there is a call to CheckGoal hiding behind the **EnableCollaboration** bool.</span></span> <span data-ttu-id="0268b-417">Это соответствует флажок, извлеченного при помощью шагов, описанных в этой главе.</span><span class="sxs-lookup"><span data-stu-id="0268b-417">This corresponds to the checkbox you checked while completing the steps for this chapter.</span></span> <span data-ttu-id="0268b-418">Внутри EnableCollaboration мы видим, вызов CheckGoal().</span><span class="sxs-lookup"><span data-stu-id="0268b-418">Inside of EnableCollaboration we see a call to CheckGoal().</span></span>

<span data-ttu-id="0268b-419">CheckGoal выполняет некоторые расчеты, чтобы узнать, если мы более или менее положение на панели.</span><span class="sxs-lookup"><span data-stu-id="0268b-419">CheckGoal does some math to see if we are more or less standing on the pad.</span></span> <span data-ttu-id="0268b-420">Когда мы, мы Debug.Log «Прибыло в цель» и затем мы вызовите «SendAtGoalMessage()».</span><span class="sxs-lookup"><span data-stu-id="0268b-420">When we are, we Debug.Log "Arrived at goal" and then we call 'SendAtGoalMessage()'.</span></span> <span data-ttu-id="0268b-421">В SendAtGoalMessage мы вызываем playerController.SendAtGoal.</span><span class="sxs-lookup"><span data-stu-id="0268b-421">In SendAtGoalMessage we call playerController.SendAtGoal.</span></span> <span data-ttu-id="0268b-422">Чтобы сэкономить время, ниже приведен код:</span><span class="sxs-lookup"><span data-stu-id="0268b-422">To save you some time, here's the code:</span></span>

```cs
private void CmdSendAtGoal(int GoalIndex)
       {
           levelState.SetGoalIndex(GoalIndex);
       }
```

```cs
public void SendAtGoal(int GoalIndex)
       {
           if (isLocalPlayer)
           {
               Debug.Log("sending at goal " + GoalIndex);
               CmdSendAtGoal(GoalIndex);
           }
       }
```

<span data-ttu-id="0268b-423">Обратите внимание на то, что SendAtGoalMessage вызывает CmdSendAtGoal, какие levelState.SetGoalIndex вызовы, обратно в LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="0268b-423">Note that SendAtGoalMessage calls CmdSendAtGoal, which calls levelState.SetGoalIndex, which is back in LevelControl.cs.</span></span> <span data-ttu-id="0268b-424">На первый взгляд это кажется странным.</span><span class="sxs-lookup"><span data-stu-id="0268b-424">At first glance this seems strange.</span></span> <span data-ttu-id="0268b-425">Почему просто не вызвать SetGoalIndex, а не это странное маршрутизации через контроллер проигрывателя?</span><span class="sxs-lookup"><span data-stu-id="0268b-425">Why not just call SetGoalIndex rather than this strange routing through the player controller?</span></span> <span data-ttu-id="0268b-426">Причина в том, что мы удовлетворяющие модели данных, которые UNET использует для синхронизации данных. Чтобы избежать обмана и пробуксовка, UNET наличие у каждого объекта пользователя, имеющего позволяют изменять синхронизированные переменные.</span><span class="sxs-lookup"><span data-stu-id="0268b-426">The reason is that we are conforming to the data model UNET uses to keep data in sync. To prevent cheating and thrashing, UNET requires that each object has a user who has authority to change the synchronized variables.</span></span> <span data-ttu-id="0268b-427">Кроме того только узла (пользователя, запустившего сеанс) могут изменять данные напрямую.</span><span class="sxs-lookup"><span data-stu-id="0268b-427">Further, only the host (the user that started the session) can change data directly.</span></span> <span data-ttu-id="0268b-428">Пользователей, которые не являются узла, но имеет полномочия, необходимые для отправки «команды» узлу, который будет изменить переменную.</span><span class="sxs-lookup"><span data-stu-id="0268b-428">Users who are not the host, but have authority, need to send a 'command' to the host which will change the variable.</span></span> <span data-ttu-id="0268b-429">По умолчанию узел имеет полномочия на все объекты, за исключением объекта, сформированными для представления пользователю.</span><span class="sxs-lookup"><span data-stu-id="0268b-429">By default the host has authority over all objects, except for the object spawned to represent the user.</span></span> <span data-ttu-id="0268b-430">В нашем случае этот объект имеет playercontroller скрипт.</span><span class="sxs-lookup"><span data-stu-id="0268b-430">In our case this object has the playercontroller script.</span></span> <span data-ttu-id="0268b-431">Есть способ запросить полномочия для объекта, а затем внесите изменения, но мы решили использовать факт, что контроллер проигрыватель имеет собственный центр и маршрута команды через контроллер проигрывателя.</span><span class="sxs-lookup"><span data-stu-id="0268b-431">There is a way to request authority for an object and then make changes, but we choose to leverage the fact that the player controller has self authority and route commands through the player controller.</span></span>

<span data-ttu-id="0268b-432">Другими словами, при выяснилось, что сами в нашей цели, игроку необходимо сообщить этому приложению, и узел сообщит, все остальные.</span><span class="sxs-lookup"><span data-stu-id="0268b-432">Said another way, when we've found ourselves at our goal, the player needs to tell the host, and the host will tell everyone else.</span></span>

<span data-ttu-id="0268b-433">В обзор LevelControl.cs SetGoalIndex.</span><span class="sxs-lookup"><span data-stu-id="0268b-433">Back in LevelControl.cs look at SetGoalIndex.</span></span> <span data-ttu-id="0268b-434">Здесь мы задав значение в synclist (AtGoal).</span><span class="sxs-lookup"><span data-stu-id="0268b-434">Here we are setting the value of a value in a synclist (AtGoal).</span></span> <span data-ttu-id="0268b-435">Помните, мы находятся в контексте узла хотя мы это делать.</span><span class="sxs-lookup"><span data-stu-id="0268b-435">Remember that we are in the context of the host while we do this.</span></span> <span data-ttu-id="0268b-436">Как и команды, RPC еще кое-узел может выдавать, вызовет все клиенты должны выполнять определенный код.</span><span class="sxs-lookup"><span data-stu-id="0268b-436">Similar to a command, an RPC is something the host can issue that will cause all clients to run some code.</span></span> <span data-ttu-id="0268b-437">Здесь мы называем «RpcCheckAllGoals».</span><span class="sxs-lookup"><span data-stu-id="0268b-437">Here we call 'RpcCheckAllGoals'.</span></span> <span data-ttu-id="0268b-438">Каждый клиент отдельно проверьте, если заданы все три AtGoals и если да, запустить ракеты.</span><span class="sxs-lookup"><span data-stu-id="0268b-438">Each client will individually check to see if all three AtGoals are set, and if so, launch the rocket.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="0268b-439">Наслаждайтесь хода выполнения</span><span class="sxs-lookup"><span data-stu-id="0268b-439">Enjoy your progress</span></span>

<span data-ttu-id="0268b-440">Основываясь на предыдущей главе, мы начнем сеанс как перед.</span><span class="sxs-lookup"><span data-stu-id="0268b-440">Building on the previous chapter, we will start the session as before.</span></span> <span data-ttu-id="0268b-441">Это время, как пользователи в иммерсивных гарнитура get на «дверца» пути к их появляется всплывающая подсказка, видно только те пользователи, HoloLens.</span><span class="sxs-lookup"><span data-stu-id="0268b-441">This time as the users in the immersive headset get to the "door" on their path, a tooltip will appear that only the HoloLens users can see.</span></span> <span data-ttu-id="0268b-442">HoloLens пользователи отвечают за связь этой информации пользователей в иммерсивных гарнитуры.</span><span class="sxs-lookup"><span data-stu-id="0268b-442">The HoloLens users are responsible for communicating this clue to the users in the immersive headset.</span></span> <span data-ttu-id="0268b-443">Игра rocket приведет к запуску пространство после каждого аватар зашел в его соответствующий коричневая панель внутри вулкана.</span><span class="sxs-lookup"><span data-stu-id="0268b-443">The rocket will launch to space once each avatar has stepped on its corresponding brown pad inside the volcano.</span></span> <span data-ttu-id="0268b-444">Сцены сбросит через 60 секунд, чтобы делать это снова.</span><span class="sxs-lookup"><span data-stu-id="0268b-444">The scene will reset after 60 seconds so you can do it again.</span></span>

## <a name="see-also"></a><span data-ttu-id="0268b-445">См. также</span><span class="sxs-lookup"><span data-stu-id="0268b-445">See also</span></span>
* [<span data-ttu-id="0268b-446">Входные данные MR 213: Контроллеры движения</span><span class="sxs-lookup"><span data-stu-id="0268b-446">MR Input 213: Motion controllers</span></span>](mixed-reality-213.md)
