---
title: 4. Настройка интерактивной сцены
description: Часть 4 руководства по созданию простого приложения для игры в шахматы с помощью Unreal Engine 4 и подключаемого модуля средств разработки пользовательского интерфейса (UX) из набора средств для смешанной реальности
author: sw5813
ms.author: suwu
ms.date: 5/5/2020
ms.topic: article
ms.localizationpriority: high
keywords: Unreal, Unreal Engine 4, UE4, HoloLens, HoloLens 2, смешанная реальность, учебник, начало работы, MRTK, UXT, средства разработки пользовательского интерфейса, средства UX, документация
ms.openlocfilehash: 17f7ab1c1126c47e5ac6388d125d45cf3f2c2d87
ms.sourcegitcommit: 189a47b8712dd5b620e19815f5cf6d1ac0f29880
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2020
ms.locfileid: "82851557"
---
# <a name="3-making-your-scene-interactive"></a><span data-ttu-id="bd1f2-104">3. Настройка интерактивной сцены</span><span class="sxs-lookup"><span data-stu-id="bd1f2-104">3. Making your scene interactive</span></span>

<span data-ttu-id="bd1f2-105">В этом разделе вы познакомитесь с подключаемым модулем разработки пользовательского интерфейса (UX) из набора средств для смешанной реальности, который содержит набор средств с открытым кодом для удобного добавления в сцену интерактивных возможностей.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-105">This section introduces you to the open source Mixed Reality Toolkit UX Tools plugin, which provides a set of tools to easily make your scene interactive.</span></span> <span data-ttu-id="bd1f2-106">Когда вы завершите работу с этим разделом, шахматные фигуры будут реагировать на действия пользователя.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-106">By the end of this section, your chess pieces will respond to user input.</span></span> 

## <a name="objectives"></a><span data-ttu-id="bd1f2-107">Задачи</span><span class="sxs-lookup"><span data-stu-id="bd1f2-107">Objectives</span></span>

* <span data-ttu-id="bd1f2-108">Включение в проект подключаемого модуля средств UX из набора средств для смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-108">Include the Mixed Reality Toolkit UX Tools plugin in your project</span></span>
* <span data-ttu-id="bd1f2-109">Добавление субъектов взаимодействия с руками, чтобы они реагировали на пальцы пользователя.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-109">Add Hand Interaction Actors to your fingertips</span></span>
* <span data-ttu-id="bd1f2-110">Создание манипуляторов и подключение их к шахматным фигурам и доске.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-110">Create and attach Manipulators to your chess board and pieces</span></span> 
* <span data-ttu-id="bd1f2-111">Применение симуляции ввода для проверки проекта.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-111">Use input simulation to validate your project</span></span>

## <a name="download-the-mixed-reality-toolkit-ux-tools-plugin"></a><span data-ttu-id="bd1f2-112">Скачивание подключаемого модуля средств UX из набора средств для смешанной реальности</span><span class="sxs-lookup"><span data-stu-id="bd1f2-112">Download the Mixed Reality Toolkit UX Tools plugin</span></span>

1.  <span data-ttu-id="bd1f2-113">Клонируйте или скачайте из [репозитория средств UX на сайте GitHub](https://github.com/microsoft/MixedReality-UXTools-Unreal/releases), а затем распакуйте последний выпуск подключаемого модуля средств UX из набора средств для смешанной реальности.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-113">Clone or download and unzip the latest release of the MRTK UX Tools plugin from the [UX Tools GitHub repository](https://github.com/microsoft/MixedReality-UXTools-Unreal/releases)</span></span>

2.  <span data-ttu-id="bd1f2-114">В главной папке проекта создайте в новую папку с именем Plugins.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-114">In your chess project root folder, create a new folder called “Plugins”.</span></span> <span data-ttu-id="bd1f2-115">Скопируйте в эту папку распакованный подключаемый модуль средств UX.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-115">Copy your unzipped UXTools plugin into this folder.</span></span> <span data-ttu-id="bd1f2-116">Перезапустите редактор Unreal.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-116">Restart the Unreal editor.</span></span> 

![Создание папки для подключаемых модулей в проекте](images/unreal-uxt/4-plugins.PNG)

3.  <span data-ttu-id="bd1f2-118">Если после перезапуска вы не увидите содержимое подключаемого модуля средств UX на панели источников, попробуйте включить параметр **View Options > Show Plugin Content** (Параметры просмотра > Показать содержимое подключаемого модуля).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-118">After restarting, if you don’t see UXTools plugin content in your sources panel, you may need to click on **View Options > Show Plugin Content**.</span></span> <span data-ttu-id="bd1f2-119">Вы увидите, что подключаемый модуль средств UX предоставляет папку Content с элементами Pointers (Указатели), Input Simulation (Симуляция ввода) и Simple Button (Простая кнопка), а также папку с классами C++, в которой каждая функция размещена в отдельной подпапке.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-119">You’ll see that the UXTools plugin provides a Content folder with Pointers, Input Simulation, and a Simple Button, as well as a C++ Classes folder with subfolders separated by function.</span></span>  

![Отображение содержимого подключаемого модуля](images/unreal-uxt/4-showplugincontent.PNG)

## <a name="spawn-hand-interaction-actors"></a><span data-ttu-id="bd1f2-121">Порождение субъектов взаимодействия с рукой</span><span class="sxs-lookup"><span data-stu-id="bd1f2-121">Spawn Hand Interaction Actors</span></span>

1.  <span data-ttu-id="bd1f2-122">Для начала мы создадим субъекты взаимодействия с рукой на основе MRPawn, чтобы получить следующие возможности: 1) визуализировать для MRPawn курсоры на кончиках указательных пальцев для элемента Pawn; 2) реализовать события ввода рукой (для прямой манипуляции субъектами) через Pawn; 3) реализовать события ввода через дальнее взаимодействие, чтобы поддерживать телекинез от ладоней пользователя.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-122">Let’s start by spawning Hand Interaction Actors from our MRPawn so that 1) we can visualize MRPawn with a cursor on the tips of the Pawn’s index fingers, 2) we can provide articulated hand input events (and thus, directly manipulate actors) through the Pawn, and 3) we can provide far interaction input events through hand rays extending from our palms.</span></span> <span data-ttu-id="bd1f2-123">Откройте схему **MRPawn** и перейдите к разделу **Event Graph** (Граф событий).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-123">Open the **MRPawn** Blueprint and navigate to the **Event Graph**.</span></span> 

2.  <span data-ttu-id="bd1f2-124">Перетащите закрепление выполнения из события BeginPlay и отпустите его на свободном месте, чтобы создать новый узел.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-124">Drag the execution pin from Event BeginPlay and release to place a new node.</span></span> <span data-ttu-id="bd1f2-125">Выберите узел **Spawn Actor from Class** (Порождение субъекта из класса).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-125">Select the **Spawn Actor from Class** node.</span></span> <span data-ttu-id="bd1f2-126">Щелкните раскрывающийся список рядом с закреплением **Class** (Класс) и выполните поиск по строке **Uxt Hand Interaction Actor** (Субъект взаимодействия с рукой).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-126">Click the dropdown next to the **Class** pin and search for **Uxt Hand Interaction Actor**.</span></span> <span data-ttu-id="bd1f2-127">Перетащите закрепление выполнения из узла SpawnActor Uxt Hand Interaction, отпустите его и выполните поиск функции **Set Hand** (Установка руки), которая содержится в классе субъекта взаимодействия с рукой.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-127">Drag the execution pin from the SpawnActor Uxt Hand Interaction node, release, and search for the **Set Hand** function contained in the Uxt Hand Interaction Actor class.</span></span> <span data-ttu-id="bd1f2-128">Подключите возвращаемое значение узла SpawnActor к закреплению Target (Целевой объект) узла Set Hand (Установка руки), чтобы задать значение **Left** (Левая) для субъекта взаимодействия с рукой.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-128">Connect the SpawnActor node’s Return Value to the Target pin of the Set Hand node to set the hand of the Hand Interaction Actor to **Left**.</span></span> <span data-ttu-id="bd1f2-129">Создайте второй субъект **Uxt Hand Interaction Actor**, но теперь настройте для руки значение **Right** (Правая). Теперь при создании этого события для каждой руки будет создан отдельный субъект взаимодействия с рукой.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-129">Spawn a second **Uxt Hand Interaction Actor**, this time setting the hand to **Right**, so that when the event begins, a Uxt Hand Interaction Actor will be spawned on each hand.</span></span> 

![Порождение субъектов взаимодействия с рукой](images/unreal-uxt/4-spawnactor.PNG)

3.  <span data-ttu-id="bd1f2-131">Теперь нам нужно настроить для субъектов взаимодействия с рукой значения начального преобразования и владельца.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-131">Next, we need to provide our Uxt Hand Interaction Actors with an initial transform at which to spawn, and an owner.</span></span> <span data-ttu-id="bd1f2-132">Перетащите закрепление одного из элементов **Spawn Transform** (Порождение преобразования) и отпустите его, чтобы разместить новый узел.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-132">Drag the pin off one of the **Spawn Transform** pins and release to place a new node.</span></span> <span data-ttu-id="bd1f2-133">Найдите узел **Make Transform** (Выполнить преобразование).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-133">Search for the **Make Transform** node.</span></span> <span data-ttu-id="bd1f2-134">Первоначальное преобразование не имеет особого значения, так как субъекты взаимодействия с рукой будут перемещаться на руки пользователя сразу же после отображения (этот код уже реализован в подключаемом модуле средств UX), а без этого они просто не видны.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-134">The initial transform really doesn’t matter since the Hand Interaction Actors will jump to our hands as soon as they are visible (code that’s already written for us in the UX Tools plugin), otherwise, they’ll disappear.</span></span> <span data-ttu-id="bd1f2-135">Однако функция SpawnActor требует передать ей преобразование в качестве входных данных, и без него компилятор создает ошибку, поэтому мы просто сохраним для Make Transform значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-135">However, the SpawnActor function requires a Transform as input to avoid a compiler error, so we’ll just leave the default values in Make Transform as is.</span></span> <span data-ttu-id="bd1f2-136">Перетащите **Return Value** (Возвращаемое значение) элемента Make Transform на элемент Interaction Actor Spawn Transform (Преобразование порождения субъекта взаимодействия) другой руки.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-136">Drag Make Transform’s **Return Value** to the other hand’s Interaction Actor Spawn Transform as well.</span></span> 

4.  <span data-ttu-id="bd1f2-137">Щелкните **стрелку вниз** в нижней части обоих узлов SpawnActor, чтобы открыть закрепление **Owner** (Владелец).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-137">Click the **down arrow** at the bottom of both SpawnActor nodes to reveal the **Owner** pin.</span></span> <span data-ttu-id="bd1f2-138">Перетащите закрепление одного из элементов **Owner** (Владелец) и отпустите его, чтобы разместить новый узел.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-138">Drag the pin off one of the **Owner** pins and release to place a new node.</span></span> <span data-ttu-id="bd1f2-139">Выполните поиск по слову "self" и выберите переменную **Get a reference to self** (Получить ссылку на себя).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-139">Search for “self” and select the **Get a reference to self** variable.</span></span> <span data-ttu-id="bd1f2-140">Создайте связь между узлом ссылки на объект Self и закреплением Owner (Владелец) другого элемента Hand Interaction Actor (Субъект взаимодействия с рукой).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-140">Create a link between the Self object reference node and the other Hand Interaction Actor’s Owner pin as well.</span></span> <span data-ttu-id="bd1f2-141">Вы можете перетащить узлы в схеме, как сочтете нужным, чтобы сделать ее более удобной для просмотра.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-141">Feel free to drag around nodes to make your Blueprint more readable.</span></span> <span data-ttu-id="bd1f2-142">**Скомпилируйте**, **сохраните** схему и вернитесь к главному окну.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-142">**Compile**, **save**, and return to the Main window.</span></span> 

![Полная конфигурация субъектов взаимодействия с рукой](images/unreal-uxt/4-fingerptrs.PNG)

<span data-ttu-id="bd1f2-144">Дополнительные сведения о субъекте взаимодействия с рукой, который входит в подключаемый модуль средств UX из набора средств для смешанной реальности, можно изучить в [официальной документации](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/HandInteraction.html).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-144">For more information about the Hand Interaction Actor provided in the MRTK UX Tools plugin, check out the official [documentation](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/HandInteraction.html).</span></span>

## <a name="attach-manipulators"></a><span data-ttu-id="bd1f2-145">Присоединение манипуляторов</span><span class="sxs-lookup"><span data-stu-id="bd1f2-145">Attach Manipulators</span></span>

1.  <span data-ttu-id="bd1f2-146">Теперь мы подключим манипуляторы к шахматной доске и субъектам королей.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-146">Next, we’ll attach Manipulators to our chess board and king Actors.</span></span> <span data-ttu-id="bd1f2-147">Манипулятором называется компонент, который реагирует на жесты рукой и поддерживает действия захвата, вращения и переноса. Применив преобразование манипулятора к преобразованию субъекта, мы сможем напрямую манипулировать субъектами.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-147">A Manipulator is a component that responds to articulated hand input and can be grabbed, rotated, and translated; by applying the Manipulator’s transform to that of an Actor, Actors can be directly manipulated.</span></span> 

2.  <span data-ttu-id="bd1f2-148">Откройте схему Board.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-148">Open your Board Blueprint.</span></span> <span data-ttu-id="bd1f2-149">На панели **Components** (Компоненты) нажмите **Add Component** (Добавить компонент) и выполните поиск по строке **Uxt Generic Manipulator**.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-149">In the **Components** panel, click **Add Component** and search for **Uxt Generic Manipulator**.</span></span> <span data-ttu-id="bd1f2-150">На панели Details (Сведения) можно найти раздел **Generic Manipulator** (Универсальный манипулятор) и настроить его параметры: манипуляция одной или двумя руками, режим вращения, сглаживание.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-150">In the Details panel, you’ll find a section titled **Generic Manipulator** where you can set whether you want to enable one-handed or two-handed manipulation, the rotation mode, and smoothing.</span></span> <span data-ttu-id="bd1f2-151">Вы можете выбрать здесь любой удобный режим, а затем **скомпилировать** и **сохранить** схему Board.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-151">Feel free to select whichever modes you wish, then **Compile** and **Save** Board.</span></span> 

![Добавление универсального манипулятора](images/unreal-uxt/4-addmanip.PNG)

![Настройка режима](images/unreal-uxt/4-setrotmode.PNG)

3.  <span data-ttu-id="bd1f2-154">Повторите описанные выше действия для субъекта WhiteKing.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-154">Repeat the steps above for the WhiteKing Actor.</span></span>

<span data-ttu-id="bd1f2-155">Дополнительные сведения о компонентах манипуляторов, которые входят в подключаемый модуль средств UX из набора средств для смешанной реальности, можно изучить в [официальной документации](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/Manipulator.html).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-155">For more information about the Manipulator Components provided in the MRTK UX Tools plugin, visit the official [documentation](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/Manipulator.html).</span></span>

## <a name="test-out-your-scene-with-simulated-hands"></a><span data-ttu-id="bd1f2-156">Тестирование сцены с помощью симуляции рук</span><span class="sxs-lookup"><span data-stu-id="bd1f2-156">Test out your scene with simulated hands</span></span>

1.  <span data-ttu-id="bd1f2-157">В главном окне нажмите **Play** (Играть).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-157">In the Main window, press **Play**.</span></span> <span data-ttu-id="bd1f2-158">Вы увидеть две сетки для рук, которые предоставляются подключаемым модулем средств UX из набора средств для смешанной реальности, и два луча, выходящие из ладоней этих рук.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-158">You should see two mesh hands provided by the MRTK UX Tools plugin, with hand rays extending from each hand’s palm!</span></span> 

![Симуляция рук в окне просмотра](images/unreal-uxt/4-handsim.PNG)

2.  <span data-ttu-id="bd1f2-160">Чтобы управлять **правой рукой**, удерживайте нажатой **левую клавишу ALT**.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-160">To control the **right hand**, hold down the **left Alt** button.</span></span> <span data-ttu-id="bd1f2-161">Перемещайте мышь, чтобы двигать рукой.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-161">Move your mouse to move the hand.</span></span> <span data-ttu-id="bd1f2-162">Прокрутка **колесика мыши** позволяет переместить руку **вперед** или **назад**.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-162">Scroll with your **mouse wheel** to move the hand **forwards** or **backwards**.</span></span> <span data-ttu-id="bd1f2-163">Щелкните левой кнопкой мыши, чтобы **сжать** ладонь, или среднюю кнопку мыши, чтобы **активировать** объект.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-163">Click your left mouse to **pinch**, click the middle mouse button to **poke**.</span></span>

3.  <span data-ttu-id="bd1f2-164">Чтобы управлять **левой рукой**, удерживайте нажатой **левую клавишу SHIFT**.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-164">To control the **left hand**, hold down the **left Shift** button.</span></span> <span data-ttu-id="bd1f2-165">Для перемещения левой руки используются те же элементы управления, что и для правой руки.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-165">The controls for moving the left hand are the same as those for the right hand.</span></span> 

4.  <span data-ttu-id="bd1f2-166">Теперь попробуйте с помощью этой симуляции рук поднять, переместить и поставить на новое место белого короля.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-166">Now try using the simulated hands to pick up, move, and set down the white chess king.</span></span> <span data-ttu-id="bd1f2-167">Вы даже можете перемещать доску!</span><span class="sxs-lookup"><span data-stu-id="bd1f2-167">You can also manipulate the board!</span></span> <span data-ttu-id="bd1f2-168">Потренируйтесь выполнять ближнее и дальнее взаимодействие. Вы заметите, что при приближении рук к доске и (или) к королю на расстоянии прямого захвата лучи телекинеза исчезают и заменяются курсором пальца на кончике указательного пальца.</span><span class="sxs-lookup"><span data-stu-id="bd1f2-168">Experiment with both near and far interaction- notice that when your hands get close enough to grab the board and king directly, the hand ray disappears and is replaced with a finger cursor on the index tip.</span></span> 

<span data-ttu-id="bd1f2-169">Дополнительные сведения о функции симуляции рук, которая входит в подключаемый модуль средств UX из набора средств для смешанной реальности, можно изучить в [официальной документации](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/InputSimulation.html).</span><span class="sxs-lookup"><span data-stu-id="bd1f2-169">For more information about the simulated hands feature provided by the MRTK UX Tools plugin, visit the official [documentation](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/InputSimulation.html).</span></span>

[<span data-ttu-id="bd1f2-170">Следующий раздел: 5. Добавление кнопки и сброс расположений фрагментов</span><span class="sxs-lookup"><span data-stu-id="bd1f2-170">Next Section: 5. Adding a button & resetting piece locations</span></span>](unreal-uxt-ch5.md)