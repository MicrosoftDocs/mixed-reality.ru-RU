---
title: Основные сведения о производительности для смешанной реальности
description: Дополнительные разделы и сведения об оптимизации производительности для смешанной реальности приложений Windows
author: Troy-Ferrell
ms.author: trferrel
ms.date: 3/26/2019
ms.topic: article
keywords: Смешанный реальность, смешанная реальность, виртуальной реальности, виртуальной Реальности, MR, производительности, оптимизации, ЦП, GPU Windows
ms.openlocfilehash: ce59f9023c21dc7c981a2bb97d9fbd0c57622dbf
ms.sourcegitcommit: 384b0087899cd835a3a965f75c6f6c607c9edd1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/12/2019
ms.locfileid: "59603288"
---
# <a name="understanding-performance-for-mixed-reality"></a>Основные сведения о производительности для смешанной реальности

Эта статья содержит вводную информацию рационализации значимость производительности для приложения смешанной реальности.  Взаимодействие с пользователем может снижаться значительно, если приложение не запускается частотой кадров оптимальной. Голограммы, будут отображаться нестабильной головной отслеживания среды будут неточны, что приводит к снижению удобство работы пользователей. Действительно производительности следует рассматривать как компонентом первого класса для смешанной реальности разработки и не стабилизации, конец цикла задач.

Для просмотра ниже перечислены значения частоты кадров производительность для каждой целевой платформы.

| Платформа | Частота кадров целевого |
|----------|-------------------|
| [HoloLens](hololens-hardware-details.md) | 60 КАДРОВ/С |
| [ПК Windows Mixed Reality Ultra](immersive-headset-hardware-details.md) | 90 КАДРОВ/С |
| [Смешанный реальности ПК Windows](immersive-headset-hardware-details.md) | 60 КАДРОВ/С |

Ниже платформа предоставляет общую структуру рекомендации и понимают к попадание на целевом частоты кадров. Чтобы сразу приступить к работе дальнейшей в подробности, рекомендуется прочитать статью [рекомендации по производительности для статьи Unity](performance-recommendations-for-unity.md). В частности этот связанной статье описывается, как измерить частоту кадров в Unity Windows Mixed Reality приложения, а также действия, выполняемые в среде Unity для повышения производительности.

## <a name="understanding-performance-bottlenecks"></a>Узких мест производительности

Если приложение имеет неэффективно частоты кадров, первым делом для анализа и понять, где приложение с большим объемом вычислений. Есть два процессора первичный, отвечающие за работу для подготовки к просмотру в сцену: ЦП и GPU. Каждый из этих двух компонентов обрабатывать различные операции и этапы приложения смешанной реальности. Существуют три ключевых местах, где могут возникнуть узкие места. 

1. **Поток приложения - ЦП** -этот поток отвечает за логику приложения. Это включает в себя обработку входных данных, анимации, физики и другие приложения логики или состояния
2. **Поток - отрисовки ресурсов ЦП и GPU** -этот поток отвечает на передачу вызовов draw в GPU. Когда приложение хочет отобразить объект, например куба или модели, этот поток отправляет запрос в GPU, имеющий архитектурой, оптимизированный для подготовки отчетов, для выполнения этих операций.
3. **GPU** - 
    этот обработчик обычно обрабатывает графического конвейера приложения для преобразования трехмерного данных (моделей, текстур и т.д) в пикселях и в конечном счете создания двухмерное изображение для отправки на экране устройства.

![Время существования кадра](images/lifetime-of-a-frame.png)

Как правило HoloLens приложения будут ограниченные GPU. Тем не менее это не выполняются в каждое приложение, и поэтому рекомендуется использовать средства и методики ниже, чтобы перейти к естественных для вашего конкретного приложения.

## <a name="how-to-analyze-your-application"></a>Как для анализа работы приложения

Существует множество средств, которые позволяют вам как разработчику понять профиль производительности приложения смешанной реальности. Это позволит вам как целевой объект, где у вас есть узкие места и как они manifesting самостоятельно выполнять их отладку.

Это список популярной и многофункциональной, позволяющих получить глубокое данные профилирования для приложения.
- [Intel Graphics Performance Analyzers](https://software.intel.com/gpa)
- [Отладчики графики Visual Studio](https://docs.microsoft.com/visualstudio/debugger/graphics/visual-studio-graphics-diagnostics?view=vs-2017)
- [Unity Profiler](https://docs.unity3d.com/Manual/Profiler.html)
- [Отладчик Unity кадра](https://docs.unity3d.com/Manual/FrameDebugger.html)

### <a name="how-to-profile-in-any-environment"></a>Профилирование в любой среде

Нет простой тест, чтобы быстро определить, если вас наверняка будут ограниченные GPU или ЦП, ограниченных в приложении. При уменьшении разрешение вывод целевого объекта отрисовки, существует меньше точек для вычисления, и таким образом, меньше работы GPU необходимо выполнить, чтобы отобразить изображение. Окна просмотра, масштабирование (динамическое разрешение масштабирование) является способ визуализации изображения, меньше чем целевой объект отрисовки, а затем можно отобразить устройства вывода. Устройство будет вверх выборку из меньший набор пикселей для отображения окончательного образа.

После уменьшения разрешения для подготовки к просмотру, если:
1) Частота кадров приложения **увеличивает**, то скорее **ограниченного GPU**
1) Частота кадров приложения **неизменным**, то скорее **ограниченного ЦП**

>[!NOTE]
>Среда Unity предоставляет возможность легко изменять разрешения целевых отрисовки приложения во время выполнения посредством *[XRSettings.renderViewportScale](https://docs.unity3d.com/ScriptReference/XR.XRSettings-renderViewportScale.html)* свойство. Итоговый образ, представленные на устройстве имеет фиксированным разрешением. Платформа делает выборку низкого разрешения, выходные данные для создания образа выше разрешения для отрисовки на отображение. 
>
>```CS
>UnityEngine.XR.XRSettings.renderScale = 0.7f;
>```

## <a name="how-to-improve-your-application"></a>Как улучшить приложение

### <a name="cpu-performance-recommendations"></a>Рекомендации по производительности ЦП

Как правило большую часть работы в приложении смешанной реальности на ЦП включает в себя выполнение «моделирование» сцены и расширенное уникальные приложения логики обработки. Таким образом следующее обычно предназначены для оптимизации.

- Анимации
- Упростите Физика
- Выделение памяти
- Сложные алгоритмы (например) обратной кинематики, пути поиска)

### <a name="gpu-performance-recommendations"></a>Рекомендации по производительности GPU

#### <a name="understanding-bandwidth-vs-fill-rate"></a>Коэффициент заполнения vs основные сведения о пропускной способности
При отрисовке определенного кадра на GPU, приложение обычно является либо ограничивается скорость пропускной способности или заливкой памяти.

- **Пропускная способность памяти** — это скорость операций чтения и записи GPU можно выполнять из памяти
    - Чтобы определить ограничения пропускной способности, снизить качество текстуры и проверьте, если частота кадров улучшается.
    - В Unity, это можно сделать, изменив **качества текстуры** в **изменить** > **параметры проекта**  >   **[ Параметры качества](https://docs.unity3d.com/Manual/class-QualitySettings.html)**.
- **Скоростью заполнения** ссылается на пропускную способность, готовый для просмотра пикселей, которые можно рисовать в секунду с GPU.
    - Для определения заливки ограничение скорости, уменьшите разрешение экрана и проверьте, если частота кадров улучшается. 
    - В Unity, это можно сделать с помощью *[XRSettings.renderViewportScale](https://docs.unity3d.com/ScriptReference/XR.XRSettings-renderViewportScale.html)* свойство

Пропускная способность памяти обычно включает в себя оптимизацию либо
1) уменьшить разрешение текстуры
2) использовать меньше текстур (например) нормали, отражающий, д)

Коэффициент заполнения в основном ориентировано на сокращение количества операций, которые должны вычисляться для окончательного готовый для просмотра пикселя. В качестве примера часто делятся на уменьшение
1) количество объектов для рендеринга и обработки
2) Количество операций в шейдера
3) количество этапов GPU окончательный результат (геометрических объектов, постобработка эффекты и т. д)
4) число пикселей для отрисовки (т. е. разрешение экрана)

#### <a name="reduce-poly-count"></a>Уменьшение числа poly
Выше многоугольника подсчитывает результат в дополнительные операции для графического Процессора и уменьшению числа многоугольники в сцене сократит количество времени для визуализации этого геометрического объекта. Также в заливки геометрии, по-прежнему могут потреблять задействованы другие факторы, но количество многоугольников является базовой метрики, чтобы определить, насколько велики затраты сцены будет для подготовки к просмотру.

#### <a name="limit-overdraw"></a>Ограничение может быть нарисован поверх

Высокий перерисовывать происходит, когда несколько объектов представления, но не выводятся на экран, как они скрыты по другой, обычно более подробно, occluding объекта. Представьте себе, просмотрев стены, имеющего несколько комнаты и geometry, за ней. Все геометрии должны быть обработаны для подготовки к просмотру, но только непрозрачный стены действительно требуется отображены как его occludes вида все содержимое. Это приводит к потере операции, которые не требуются для текущего представления.

#### <a name="shaders"></a>Шейдеры

Шейдеры — небольшой программы, которые выполняются в GPU и обычно определить два важных шага при подготовке к просмотру:
1) какие вершины должно отображаться на экране, и где они находятся в пространстве экрана (например) Вершинный построитель текстуры)
    - Вершинный построитель текстуры обычно выполняется на вершину для каждого GameObject
2) что следует цвета этих пикселей (например) шейдер пикселей)
    - Построитель текстуры выполняется на пиксель для текстуры к просмотру устройство

Обычно шейдеры выполняют множество преобразований и освещения вычисления. Несмотря на то, что модели сложных освещения, теней и других операций можно сформировать фантастические результаты, они также поставляются с ценой. Сокращение количества операций, вычисляемых в шейдеров может значительно снизить общей работы, которую нужно выполнить в каждом кадре графического Процессора.

##### <a name="shader-coding-recommendations"></a>Шейдер кодирования рекомендации

- Использовать билинейная фильтрация, когда это возможно
- Изменить порядок выражений, используемых для выполнения умножения и сложения, в то же время MAD встроенные функции
- Рассчитывают максимально на ЦП и передайте в качестве константы к материалам
- **Приоритет перенос операций из построителя текстуры в шейдер вершин**
    - Обычно число вершин << # пикселей (например) 720 p == 921 600 пикселей, 1080 p == 2,073,600 пикселей и т. д)

#### <a name="remove-gpu-stages"></a>Удалить этапы графического Процессора
Постобработка эффекты могут обходиться очень дорого и обычно препятствовать коэффициент заполнения приложения. Сюда также входят методы сглаживания, такие как MSAA. На HoloLens рекомендуется полностью избежать этих методов. Кроме того следует избегать этапов дополнительных шейдера геометрии, оболочка и вычислительных шейдеров по возможности.

## <a name="memory-recommendations"></a>Рекомендации по объему памяти
Операции выделения и освобождения слишком большой объем памяти, могут иметь неблагоприятное воздействие на holographic приводит к несогласованности производительности, зафиксированной кадров и других неблагоприятное поведение приложения. Это особенно важно понять рекомендации по использованию памяти, при разработке в Unity, так как управление памятью осуществляется сборщиком мусора.

#### <a name="object-pooling"></a>Использование пулов объектов

Использование пулов объектов — популярный способ для сокращения затрат непрерывное выделение и освобождение объектов. Это делается путем выделения большого пула идентичные объекты и повторное использование экземпляров неактивных, доступные из этого пула, а не постоянно порождении и уничтожение объектов со временем. Пулы объектов отлично подходят для повторно готовый к применению компонентов, которые имеют время существования переменной во время приложения.

## <a name="see-also"></a>См. также
- [Рекомендации по производительности для Unity](performance-recommendations-for-unity.md)
- [Рекомендуемые параметры для Unity](recommended-settings-for-unity.md)
