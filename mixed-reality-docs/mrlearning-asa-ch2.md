---
title: Учебники по пространственной привязке Azure — 2. Сохранение, извлечение и совместное использование пространственных привязок Azure
description: В рамках этого курса вы узнаете, как реализовать функцию распознавания лиц Azure в приложении смешанной реальности.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.openlocfilehash: 7b19233a9634e2568200476c9483464bbf9dd3c8
ms.sourcegitcommit: a580166a19294f835b8e09c780f663f228dd5de0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2020
ms.locfileid: "77250753"
---
# <a name="2-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="66447-105">2. сохранение, извлечение и совместное использование пространственных привязок Azure</span><span class="sxs-lookup"><span data-stu-id="66447-105">2. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="66447-106">В этом руководстве вы узнаете, как сохранить пространственные привязки Azure в нескольких сеансах приложения, сохранив идентификатор привязки в хранилище HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="66447-106">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="66447-107">Вы также узнаете, как предоставить этот идентификатор привязки другим устройствам для выравнивания привязок на нескольких устройствах.</span><span class="sxs-lookup"><span data-stu-id="66447-107">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="66447-108">Задачи</span><span class="sxs-lookup"><span data-stu-id="66447-108">Objectives</span></span>

* <span data-ttu-id="66447-109">Узнайте, как сохранять и извлекать идентификаторы пространственной привязки Azure на локальный диск HoloLens 2 и обратно для сохраняемости между сеансами приложения.</span><span class="sxs-lookup"><span data-stu-id="66447-109">Learn how to save and retrieve Azure Spatial Anchor IDs to and from the HoloLens 2 local disk, for persistence between app sessions</span></span>
* <span data-ttu-id="66447-110">Узнайте, как совместно использовать идентификаторы пространственной привязки Azure между пользователями в сценарии с несколькими устройствами.</span><span class="sxs-lookup"><span data-stu-id="66447-110">Learn how to share Azure Spatial Anchor IDs between users in a multi-device scenario</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="66447-111">Подготовка сцены</span><span class="sxs-lookup"><span data-stu-id="66447-111">Preparing the scene</span></span>

<span data-ttu-id="66447-112">В окне проекта перейдите к разделу **активы** > **мртк. Учебник. Азуреспатиаланчорс** > **Prefabs** папку.</span><span class="sxs-lookup"><span data-stu-id="66447-112">In the Project window, navigate to **Assets** > **MRTK.Tutorials.AzureSpatialAnchors** > **Prefabs** folder.</span></span> <span data-ttu-id="66447-113">Удерживая нажатой клавишу CTRL, щелкните **ButtonParent_SaveAnchorId** и **ButtonParent_ShareAnchorId** , чтобы выбрать два Prefabs, а затем перетащите их в окно иерархии, чтобы добавить их в сцену:</span><span class="sxs-lookup"><span data-stu-id="66447-113">While holding down the CTRL button, click on **ButtonParent_SaveAnchorId** and **ButtonParent_ShareAnchorId** to select the two prefabs, then drag them into the Hierarchy window to add them to the scene:</span></span>

![мрлеарнинг-ASA](images/mrlearning-asa/tutorial2-section1-step1-1.png)

## <a name="persist-azure-anchors-between-app-sessions---save-anchor-id-to-disk"></a><span data-ttu-id="66447-115">Сохранять привязки Azure между сеансами приложений — сохранить идентификатор привязки на диск</span><span class="sxs-lookup"><span data-stu-id="66447-115">Persist Azure Anchors between app sessions - Save anchor ID to disk</span></span>
<!-- TODO: Consider renaming to 'Persist Azure Anchors between app sessions' -->

<span data-ttu-id="66447-116">В этом разделе вы узнаете, как сохранить и получить идентификатор привязки Azure на локальном диске HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="66447-116">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens 2 local disk.</span></span> <span data-ttu-id="66447-117">Это позволит вам запрашивать в Azure один и тот же идентификатор привязки между разными сеансами приложения, что позволяет закрепленным голограммам размещаться в том же расположении, что и в предыдущем сеансе приложения.</span><span class="sxs-lookup"><span data-stu-id="66447-117">This will allow you to query Azure for the same anchor ID between different app sessions, allowing the anchored holograms to be position at the same location as in the previous app session.</span></span>

<span data-ttu-id="66447-118">В окне Иерархия разверните объект **ButtonParent_SaveAnchorId** , содержащий две кнопки — одну кнопку, чтобы сохранить идентификатор привязки Azure в хранилище HoloLens 2, а другой для получения сохраненного идентификатора с диска:</span><span class="sxs-lookup"><span data-stu-id="66447-118">In the Hierarchy window, expand the **ButtonParent_SaveAnchorId** object which contains two buttons, one button for saving the Azure Anchor ID to the HoloLens 2 storage and another for retrieving the saved ID from the disk:</span></span>

![мрлеарнинг-ASA](images/mrlearning-asa/tutorial2-section2-step1-1.png)

<span data-ttu-id="66447-120">Выполните те же действия, что и в разделе [Настройка кнопок для работы с инструкциями по монтажному кадру](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) из предыдущего руководства, чтобы настроить **холоый компонент (скрипт)** и компонент для **взаимодействия (скрипт)** на каждой из этих двух кнопок:</span><span class="sxs-lookup"><span data-stu-id="66447-120">Follow the same steps as in the [configuring the buttons to operate the scene](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Pressable Button Holo Lens 2 (Script)** component and the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="66447-121">Для объекта **савеазуреанчоридтодиск** назначьте функцию Анчормодулескрипт > **савеазуреанчоридтодиск ()** .</span><span class="sxs-lookup"><span data-stu-id="66447-121">For the **SaveAzureAnchorIdToDisk** object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="66447-122">Для объекта **жетазуреанчоридфромдиск** назначьте функцию Анчормодулескрипт > **жетазуреанчоридфромдиск ()** .</span><span class="sxs-lookup"><span data-stu-id="66447-122">For the **GetAzureAnchorIdFromDisk** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="66447-123">Если вы создаете обновленное приложение для HoloLens, теперь можно сохранять пространственные привязки Azure между сеансами приложения, сохранив идентификатор привязки Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-123">If you build the updated application to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="66447-124">Чтобы протестировать эту возможность, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="66447-124">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="66447-125">Переместите интерфейс запуска Rocket в нужное место.</span><span class="sxs-lookup"><span data-stu-id="66447-125">Move the Rocket Launcher experience to desired location.</span></span>
2. <span data-ttu-id="66447-126">Запустите сеанс Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-126">Start Azure Session.</span></span>
3. <span data-ttu-id="66447-127">Создайте привязку Azure (создает привязки в расположении процесса запуска Rocket).</span><span class="sxs-lookup"><span data-stu-id="66447-127">Create Azure Anchor (creates anchors at the location of the Rocket Launcher experience).</span></span>
4. <span data-ttu-id="66447-128">Сохраните идентификатор привязки Azure на диске.</span><span class="sxs-lookup"><span data-stu-id="66447-128">Save Azure Anchor ID to Disk.</span></span>
5. <span data-ttu-id="66447-129">Перезапустите приложение.</span><span class="sxs-lookup"><span data-stu-id="66447-129">Restart the application.</span></span>
6. <span data-ttu-id="66447-130">Получите привязку Azure с диска (загружает только что сохраненный идентификатор привязки).</span><span class="sxs-lookup"><span data-stu-id="66447-130">Get Azure Anchor from Disk (loads the anchor ID you just saved).</span></span>
7. <span data-ttu-id="66447-131">Запустите сеанс Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-131">Start Azure Session.</span></span>
8. <span data-ttu-id="66447-132">Найдите привязку Azure (размещает процесс запуска Rocket в расположении из шага 3).</span><span class="sxs-lookup"><span data-stu-id="66447-132">Find Azure Anchor (positions the Rocket Launcher experience at the location from step 3).</span></span>

## <a name="share-azure-anchors-between-multiple-devices"></a><span data-ttu-id="66447-133">Совместное использование привязок Azure между несколькими устройствами</span><span class="sxs-lookup"><span data-stu-id="66447-133">Share Azure Anchors between multiple devices</span></span>

<span data-ttu-id="66447-134">В этом разделе вы узнаете, как предоставить идентификатор привязки Azure нескольким устройствам.</span><span class="sxs-lookup"><span data-stu-id="66447-134">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="66447-135">Это позволит нескольким устройствам запрашивать один и тот же идентификатор привязки в Azure, обеспечивая пространственное согласованность привязанных голограмм.</span><span class="sxs-lookup"><span data-stu-id="66447-135">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="66447-136">Пространственное выравнивание, т. е. Просмотр одних и тех же голограмм в одном физическом расположении между несколькими устройствами, является ключом к локальным совместно используемым интерфейсам в HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="66447-136">Spatial alignment, i.e. seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="66447-137">Существует много способов передавать идентификаторы привязки Azure между устройствами, включая методы, описанные в серии руководств по [многопользовательским возможностям](mrlearning-sharing(photon)-ch1.md) .</span><span class="sxs-lookup"><span data-stu-id="66447-137">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the the [Multi-user capabilities tutorials](mrlearning-sharing(photon)-ch1.md) series.</span></span> <span data-ttu-id="66447-138">В этом примере вы будете использовать простую веб-службу для отправки и скачивания идентификаторов привязки между устройствами.</span><span class="sxs-lookup"><span data-stu-id="66447-138">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="66447-139">В окне Иерархия разверните объект **ButtonParent_ShareAnchorId** , содержащий две кнопки. одна кнопка для отправки идентификатора привязки Azure на веб-сервер, а другая — для загрузки идентификатора с веб-сервера:</span><span class="sxs-lookup"><span data-stu-id="66447-139">In the Hierarchy window, expand the **ButtonParent_ShareAnchorId** object which contains two buttons; one button for uploading the Azure Anchor ID to the web server, and another for downloading the ID from the web server:</span></span>

![мрлеарнинг-ASA](images/mrlearning-asa/tutorial2-section3-step1-1.png)

<span data-ttu-id="66447-141">Выполните те же действия, что и в разделе [Настройка кнопок для работы с инструкциями по монтажному кадру](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) из предыдущего руководства, чтобы настроить **холоый компонент (скрипт)** и компонент для **взаимодействия (скрипт)** на каждой из этих двух кнопок:</span><span class="sxs-lookup"><span data-stu-id="66447-141">Follow the same steps as in the [configuring the buttons to operate the scene](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Pressable Button Holo Lens 2 (Script)** component and the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="66447-142">Для объекта **шареазуреанчоридтонетворк** назначьте функцию Анчормодулескрипт > **шареазуреанчоридтонетворк ()** .</span><span class="sxs-lookup"><span data-stu-id="66447-142">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="66447-143">Для объекта **жетазуреанчоридфромнетворк** назначьте функцию Анчормодулескрипт > **жетазуреанчоридфромнетворк ()** .</span><span class="sxs-lookup"><span data-stu-id="66447-143">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="66447-144">Если вы создаете обновленное приложение на двух устройствах HoloLens, теперь вы можете обеспечить пространственное выравнивание между ними, совместно используя идентификатор привязки Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-144">If you build the updated application to two HoloLens devices, you can now achieve spatial alignment between them by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="66447-145">Чтобы протестировать эту возможность, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="66447-145">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="66447-146">На устройстве HoloLens 1: Переместите интерфейс запуска Rocket в нужное расположение.</span><span class="sxs-lookup"><span data-stu-id="66447-146">On HoloLens device 1: Move the Rocket Launcher experience to desired location.</span></span>
2. <span data-ttu-id="66447-147">На устройстве HoloLens 1: запустите сеанс Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-147">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="66447-148">На устройстве HoloLens 1: создание привязки Azure (создает привязки в расположении процесса запуска Rocket).</span><span class="sxs-lookup"><span data-stu-id="66447-148">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rocket Launcher experience).</span></span>
4. <span data-ttu-id="66447-149">На устройстве HoloLens 1: совместное использование идентификатора привязки Azure с сетью.</span><span class="sxs-lookup"><span data-stu-id="66447-149">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="66447-150">На устройстве HoloLens 2: перезапустите приложение.</span><span class="sxs-lookup"><span data-stu-id="66447-150">On HoloLens device 2: Restart the application.</span></span>
6. <span data-ttu-id="66447-151">На устройстве HoloLens 2: получение идентификатора общей привязки из сети (получение идентификатора привязки, доступного только с устройства HoloLens 1).</span><span class="sxs-lookup"><span data-stu-id="66447-151">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="66447-152">На устройстве HoloLens 2: запустите сеанс Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-152">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="66447-153">На устройстве HoloLens 2: найти привязку Azure (в расположении из шага 3) найдите интерфейс запуска Rocket.</span><span class="sxs-lookup"><span data-stu-id="66447-153">On HoloLens device 2: Find Azure Anchor (positions the Rocket Launcher experience at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="66447-154">Если у вас есть только один HoloLens, вы по-прежнему можете протестировать функциональные возможности, перезапустив приложение, а не используя второе устройство HoloLens.</span><span class="sxs-lookup"><span data-stu-id="66447-154">If you only have one HoloLens, you can still test the functionality by restarting the application instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="66447-155">Поздравляем!</span><span class="sxs-lookup"><span data-stu-id="66447-155">Congratulations</span></span>

<span data-ttu-id="66447-156">В этом учебнике вы узнали, как сохранять пространственные привязки Azure между сеансами приложений и перезапусками приложений, сохранив идентификатор пространственной привязки Azure на локальном диске HoloLens.</span><span class="sxs-lookup"><span data-stu-id="66447-156">In this tutorial you learned how to persist Azure Spatial Anchors between application sessions and application restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="66447-157">Вы также узнали, как совместно использовать пространственные привязки Azure между несколькими устройствами для простейших многопользовательских и статичных общих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="66447-157">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="66447-158">В следующем учебном курсе вы узнаете, как предоставить пользователям отзывы в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="66447-158">In the next tutorial you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="66447-159">Этот отзыв будет включать сведения о создании привязок, качестве понимания качества среды и состоянии сеанса Azure.</span><span class="sxs-lookup"><span data-stu-id="66447-159">This feedback will include information about Anchor creation, the quality of environment understanding, and the state of the Azure session.</span></span> <span data-ttu-id="66447-160">Без отзывов пользователи могут не определить, успешно ли отправлена привязка в Azure, является ли качество среды достаточным для создания привязки или текущего состояния.</span><span class="sxs-lookup"><span data-stu-id="66447-160">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

[<span data-ttu-id="66447-161">Следующее занятие: 3. Отображение обратной связи с пространственными привязками Azure</span><span class="sxs-lookup"><span data-stu-id="66447-161">Next Lesson: 3. Displaying Azure Spatial Anchor feedback</span></span>](mrlearning-asa-ch3.md)
