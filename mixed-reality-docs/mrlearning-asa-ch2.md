---
title: Модуль MR Learning ASA. пространственный якорь Azure в HoloLens 2
description: В рамках этого курса вы узнаете, как реализовать функцию распознавания лиц Azure в приложении смешанной реальности.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens
ms.openlocfilehash: 80367ed818168c1d642fadbd7316d3d6481dd2a9
ms.sourcegitcommit: 611af6ff7a2412abad80c0c7d4decfc0c3a0e8c8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/17/2019
ms.locfileid: "68293798"
---
# <a name="2-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="c7c92-104">2. Сохранение, извлечение и совместное использование пространственных привязок Azure</span><span class="sxs-lookup"><span data-stu-id="c7c92-104">2. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="c7c92-105">В этом руководстве мы научитесь сохранять пространственные привязки Azure в нескольких сеансах приложения, сохранив сведения о привязке на диске HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="c7c92-105">In this tutorial, we will learn how to save our Azure Spatial Anchors across multiple app sessions by saving our anchor information to the HoloLens 2's disk.</span></span> <span data-ttu-id="c7c92-106">Кроме того, мы научитесь совместно использовать эти данные привязки с другими устройствами для выравнивания привязок на нескольких устройствах.</span><span class="sxs-lookup"><span data-stu-id="c7c92-106">We will also learn how to share this anchor information to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="c7c92-107">Цели</span><span class="sxs-lookup"><span data-stu-id="c7c92-107">Objectives</span></span>

* <span data-ttu-id="c7c92-108">Узнайте, как сохранять и извлекать сведения об пространственных привязках Azure с локального диска HoloLens 2 для сохранения между сеансами приложения.</span><span class="sxs-lookup"><span data-stu-id="c7c92-108">Learn how to save and retrieve Azure Spatial Anchor information from the HoloLens 2 local disk, for persistence between app sessions</span></span>

* <span data-ttu-id="c7c92-109">Узнайте, как предоставить сведения о пространственной точке доступа Azure между пользователями в сценарии с несколькими устройствами.</span><span class="sxs-lookup"><span data-stu-id="c7c92-109">Learn how to share Azure Spatial Anchor information between users in a multi-device scenario</span></span>

## <a name="instructions"></a><span data-ttu-id="c7c92-110">Инструкция</span><span class="sxs-lookup"><span data-stu-id="c7c92-110">Instructions</span></span>

### <a name="persist-azure-anchors-between-app-sessions---save-anchor-id-to-disk"></a><span data-ttu-id="c7c92-111">Сохранять привязки Azure между сеансами приложений — сохранить идентификатор привязки на диск</span><span class="sxs-lookup"><span data-stu-id="c7c92-111">Persist Azure Anchors Between App Sessions - Save Anchor ID to Disk</span></span>

1. <span data-ttu-id="c7c92-112">Найдите и добавьте prefab Савеанчортодиск в сцену.</span><span class="sxs-lookup"><span data-stu-id="c7c92-112">Search for and add the SaveAnchorToDisk prefab to your scene.</span></span> <span data-ttu-id="c7c92-113">К ним относятся две кнопки: одна кнопка для сохранения доступных идентификаторов привязки Azure на диске HoloLens 2, а другая — для получения идентификаторов с диска.</span><span class="sxs-lookup"><span data-stu-id="c7c92-113">These include two buttons, one button for saving any available Azure Anchor IDs to the HoloLens 2 disk, and another for retrieving any IDs from the disk.</span></span>

![module2chapter2step1im](images/module2chapter2step1im.PNG)

2. <span data-ttu-id="c7c92-115">Настройте каждую кнопку в соответствии с приведенными ниже инструкциями.</span><span class="sxs-lookup"><span data-stu-id="c7c92-115">Configure Each button according to the instructions below</span></span>

   - <span data-ttu-id="c7c92-116">Для кнопки с именем Саветодиск создайте новое событие при нажатии кнопки триггер события, а также на триггер события On Click.</span><span class="sxs-lookup"><span data-stu-id="c7c92-116">For the Button named SaveToDisk, create a new event under the Button Pressed event trigger as well as the On Click event trigger.</span></span> <span data-ttu-id="c7c92-117">Перетащите объект Парентанчор в пустое поле и назначьте метод Савеазуреанчоридтодиск () из компонента Асамодулескрипт объекта Парентанчор.</span><span class="sxs-lookup"><span data-stu-id="c7c92-117">Drag the ParentAnchor object into the empty field, and assign the SaveAzureAnchorIDToDisk() method from the ParentAnchor Object's ASAmoduleScript component.</span></span>
   
     > <span data-ttu-id="c7c92-118">Примечание. Некоторые кнопки могут перекрывать другие кнопки в сцене.</span><span class="sxs-lookup"><span data-stu-id="c7c92-118">Note: some of the buttons may appear overlapping the other buttons in the scene.</span></span> <span data-ttu-id="c7c92-119">Вы можете настроить положение кнопки.</span><span class="sxs-lookup"><span data-stu-id="c7c92-119">Feel free to adjust the button's positioning.</span></span>

![module2chapter2step2aim](images/module2chapter2step2aim.PNG)

![module2chapter2step2aim](images/module2chapter2step2bim.PNG)

![module2chapter2step2aim](images/module2chapter2step2cim.PNG)


   - <span data-ttu-id="c7c92-123">Для кнопки с именем Жетфромдиск создайте новое событие при нажатии кнопки триггер события, а также на триггер события On Click.</span><span class="sxs-lookup"><span data-stu-id="c7c92-123">For the Button named GetFromDisk, create a new event under the Button Pressed event trigger as well as the On Click event trigger.</span></span> <span data-ttu-id="c7c92-124">Перетащите объект Парентанчор в пустое поле и назначьте метод Лоадазуреанчоридсфромдиск () из компонента Асамодулескрипт объекта Парентанчор.</span><span class="sxs-lookup"><span data-stu-id="c7c92-124">Drag the ParentAnchor object into the empty field, and assign the LoadAzureAnchorIDsFromDisk() method from the ParentAnchor Object's ASAmoduleScript component.</span></span>

3. <span data-ttu-id="c7c92-125">Следуйте инструкциям из Тутоирал 1, чтобы создать обновленное приложение на устройстве.</span><span class="sxs-lookup"><span data-stu-id="c7c92-125">Follow the instructions from Tutoiral 1 to build the updated application to your device.</span></span> <span data-ttu-id="c7c92-126">После нажатия кнопки создать привязку Azure, как было сделано на предыдущем занятии, можно сохранить идентификатор привязки Azure на диске, нажав кнопку Сохранить в диск.</span><span class="sxs-lookup"><span data-stu-id="c7c92-126">After pressing the Create Azure Anchor button, as you did in the previous lesson, you may now save the Azure Anchor ID to disk by pressing the save to disk button.</span></span>

4. <span data-ttu-id="c7c92-127">Перезапустите приложение, запустите сеанс Azure, нажмите кнопку "загрузить идентификатор привязки", а затем нажмите кнопку "установить привязку Azure", чтобы указать привязку, связанную с ИДЕНТИФИКАТОРом, который мы сохранили на диске.</span><span class="sxs-lookup"><span data-stu-id="c7c92-127">Restart the application, start the Azure Session, Press Load Anchor ID, and then press Locate Azure Anchor to locate the anchor associated with the ID we saved to the disk.</span></span> <span data-ttu-id="c7c92-128">Теперь вся сцена должна быть привязана к позиции, в месте, где вы ранее сохранили привязку!</span><span class="sxs-lookup"><span data-stu-id="c7c92-128">The entire scene should now snap into position, at the location you saved the anchor previously!</span></span>

### <a name="share-azure-anchors-between-multiple-devices"></a><span data-ttu-id="c7c92-129">Совместное использование привязок Azure между несколькими устройствами</span><span class="sxs-lookup"><span data-stu-id="c7c92-129">Share Azure Anchors between multiple devices</span></span>

<span data-ttu-id="c7c92-130">В этом разделе мы научитесь совместно использовать идентификатор привязки Azure для нескольких устройств.</span><span class="sxs-lookup"><span data-stu-id="c7c92-130">In this section, we'll learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="c7c92-131">Это позволит нескольким устройствам запрашивать один и тот же идентификатор привязки в Azure, позволяя привязать голограммы и сцены к пространственному выравниванию.</span><span class="sxs-lookup"><span data-stu-id="c7c92-131">This will allow multiple devices to query Azure for the same anchor ID, allowing our anchored holograms and scenes to be spatially aligned.</span></span> <span data-ttu-id="c7c92-132">Пространственное выравнивание (просмотр одних и тех же голограмм в одном физическом расположении между несколькими устройствами) является ключом к локальным совместно используемым интерфейсам в HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="c7c92-132">Spatial alignment (seeing the same holograms in the same physical location between multiple devices) is key to local shared experiences in the HoloLens 2.</span></span> <span data-ttu-id="c7c92-133">Существует много способов передачи информации об идентификаторах Azure между устройствами, включая методы, описанные в учебниках по совместному использованию пространственных привязок Azure (TODO: Add Link). В этом примере используется простая веб-служба для передачи и загрузки идентификаторов привязки между устройствами.</span><span class="sxs-lookup"><span data-stu-id="c7c92-133">There are many ways to transfer information regarding azure IDs between devices, including methods outlined in the Azure Spatial Anchors shared experiences tutorials (TODO: add link.) This example uses a simple web service to upload and download Anchor IDs between devices.</span></span>

1. <span data-ttu-id="c7c92-134">Добавьте prefab Шареанчор в иерархию.</span><span class="sxs-lookup"><span data-stu-id="c7c92-134">Add the ShareAnchor prefab into your hierarchy.</span></span> <span data-ttu-id="c7c92-135">Эта prefab добавляет две новые кнопки в сцену. один для отправки сведений об ИДЕНТИФИКАТОРе привязки, а другой — для загрузки сведений об ИДЕНТИФИКАТОРе привязки.</span><span class="sxs-lookup"><span data-stu-id="c7c92-135">This prefab adds two new buttons to your scene; one for uploading anchor ID information and another for downloading anchor ID information.</span></span> 

![module2chapter2step5im](images/module2chapter2step5im.PNG)

2. <span data-ttu-id="c7c92-137">Настройте каждую кнопку в соответствии с приведенными ниже инструкциями.</span><span class="sxs-lookup"><span data-stu-id="c7c92-137">Configure Each button according to the instructions below</span></span>

   - <span data-ttu-id="c7c92-138">Для кнопки с именем Сендшареданчор создайте новое событие под нажатой кнопкой события, а также триггер события On Click.</span><span class="sxs-lookup"><span data-stu-id="c7c92-138">For the Button named, SendSharedAnchor, create a new event under the Button Pressed event trigger as well as the On Click event trigger.</span></span> <span data-ttu-id="c7c92-139">Перетащите объект Парентанчор в пустое поле и назначьте метод Шареанчор () из компонента Асамодулескрипт объекта Парентанчор.</span><span class="sxs-lookup"><span data-stu-id="c7c92-139">Drag the ParentAnchor object into the empty field, and assign the ShareAnchor() method from the ParentAnchor Object's ASAmoduleScript component.</span></span>

![module2chapter2step6aim](images/module2chapter2step6aim.PNG)

![module2chapter2step6bim](images/module2chapter2step6bim.PNG)

   - <span data-ttu-id="c7c92-142">Для кнопки с именем Жетшареданчор создайте новое событие под нажатой кнопкой события, а также триггер события On Click.</span><span class="sxs-lookup"><span data-stu-id="c7c92-142">For the Button named, GetSharedAnchor, create a new event under the Button Pressed event trigger as well as the On Click event trigger.</span></span> <span data-ttu-id="c7c92-143">Перетащите объект Парентанчор в пустое поле и назначьте метод Жетшаредазуреанчор () из компонента Асамодулескрипт объекта Парентанчор.</span><span class="sxs-lookup"><span data-stu-id="c7c92-143">Drag the ParentAnchor object into the empty field, and assign the GetSharedAzureAnchor() method from the ParentAnchor object's ASAmoduleScript component.</span></span>

3. <span data-ttu-id="c7c92-144">Следуйте инструкциям из [учебника 1](mrlearning-base-ch1.md).</span><span class="sxs-lookup"><span data-stu-id="c7c92-144">Follow the instructions from [Tutorial 1](mrlearning-base-ch1.md).</span></span> <span data-ttu-id="c7c92-145">для создания обновленного приложения на устройстве.</span><span class="sxs-lookup"><span data-stu-id="c7c92-145">to build the updated application to your device.</span></span> <span data-ttu-id="c7c92-146">После нажатия кнопки создать привязку Azure, как показано на предыдущем занятии, вы можете предоставить идентификатор привязки Azure другим устройствам, нажав кнопку поделиться на другое устройство.</span><span class="sxs-lookup"><span data-stu-id="c7c92-146">After pressing the Create Azure Anchor button, as you did in the previous lesson, you may now share the Azure Anchor ID to other devices by pressing the Share To Other Device button.</span></span>

   > <span data-ttu-id="c7c92-147">Примечание. Выберите родительскую привязку и прокрутите вниз до родительского скрипта привязки.</span><span class="sxs-lookup"><span data-stu-id="c7c92-147">Note: Select the parent anchor and scroll down to the parent anchor script.</span></span> <span data-ttu-id="c7c92-148">Убедитесь, что ПИН-код общедоступного общего доступа уникален, поэтому при его предоставлении вам известно, что вы предоставляете общий доступ.</span><span class="sxs-lookup"><span data-stu-id="c7c92-148">Ensure that your public sharing pin is unique, so that when you share it, you know it is yours that you are sharing.</span></span> <span data-ttu-id="c7c92-149">Могут быть тысячи пользователей, совместно использующих свои привязки Azure, поэтому это позволит вам обеспечить общий доступ к правильным привязкам Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c92-149">There could be thousands of users sharing their Azure anchors, so doing this will allow you to ensure you are sharing the correct Azure anchors.</span></span>

4. <span data-ttu-id="c7c92-150">При наличии другого устройства HoloLens 2 запустите приложение и запустите сеанс Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c92-150">If you have another HoloLens 2 device, start the application and then start the Azure Session.</span></span> <span data-ttu-id="c7c92-151">Нажмите кнопку Get Shared Anchor ID (получить общий идентификатор привязки), а затем нажмите кнопку найти привязку Azure, чтобы найти привязку, связанную с ИДЕНТИФИКАТОРом, который мы сохранили на диске.</span><span class="sxs-lookup"><span data-stu-id="c7c92-151">Press the Get Shared Anchor ID button, and then press the Locate Azure Anchor button to locate the anchor associated with the ID we saved to the disk.</span></span> <span data-ttu-id="c7c92-152">Теперь вся сцена должна быть привязана к позиции, где она была помещена на другое устройство HoloLens 2!</span><span class="sxs-lookup"><span data-stu-id="c7c92-152">The entire scene should now snap into position, at the where it was placed on the other HoloLens 2 device!</span></span> <span data-ttu-id="c7c92-153">Если у вас только один HoloLens, вы по-прежнему можете выполнять тестирование, перезапуская приложение, запуская сеанс Azure, а затем нажав кнопку "получить идентификатор общей привязки", а затем нажав кнопку "найти привязку Azure", чтобы найти привязку, связанную с Идентификатор, сохраненный на диске.</span><span class="sxs-lookup"><span data-stu-id="c7c92-153">If you only have one HoloLens 2, you may still test functionality by restarting the application, starting the Azure Session, and then Press the "Get Shared Anchor ID" button button, and then press the Locate Azure Anchor button to locate the anchor associated with the ID we saved to the disk.</span></span> <span data-ttu-id="c7c92-154">Теперь вся сцена должна быть привязана к позиции, в месте, где вы ранее сохранили привязку!</span><span class="sxs-lookup"><span data-stu-id="c7c92-154">The entire scene should now snap into position, at the location you saved the anchor previously!</span></span>

## <a name="congratulations"></a><span data-ttu-id="c7c92-155">Поздравляем!</span><span class="sxs-lookup"><span data-stu-id="c7c92-155">Congratulations</span></span>
<span data-ttu-id="c7c92-156">На этом занятии вы узнали, как сохранить пространственные привязки Azure между сеансами приложения и перезапуском приложения, сохранив идентификатор пространственного якоря Azure на локальном диске HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="c7c92-156">In this Lesson you learned how to persist Azure Spatial Anchors between application sessions and application restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens 2.</span></span> <span data-ttu-id="c7c92-157">Вы также узнали, как совместно использовать пространственные привязки Azure между несколькими устройствами для простейших многопользовательских и статичных общих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="c7c92-157">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="c7c92-158">Мы Научитесь реализовывать пространственные привязки Azure как часть полностью интерактивного локального общего интерфейса на протяжении последнего урока модуля общего доступа.</span><span class="sxs-lookup"><span data-stu-id="c7c92-158">We learn how to implement Azure Spatial Anchors as part of a fully interactive local shared experience during the final lesson of the Sharing Module.</span></span> <span data-ttu-id="c7c92-159">Возможности локального общего доступа могут включать в себя такие функции, как синхронизация расположения, поворот и масштабирование трехмерного объекта, идентификаторы каждого пользователя и общее состояние приложения.</span><span class="sxs-lookup"><span data-stu-id="c7c92-159">A local sharing experience may include functionality such as synchronized 3D object position, rotation, and scale, identifiers for each user, and shared application states.</span></span> <span data-ttu-id="c7c92-160">Пространственные привязки Azure улучшают эти общие сценарии, предоставляя каждому участнику общую привязку, которая позволяет всем пользователям видеть виртуальные объекты в одном и том же физическом расположении.</span><span class="sxs-lookup"><span data-stu-id="c7c92-160">Azure Spatial Anchors enhances these shared scenarios by providing each participant with a common anchor that lets all users see virtual objects in the same physical location.</span></span> <span data-ttu-id="c7c92-161">Это справедливо для различных платформ устройств, включая устройства HoloLens, Android и iOS.</span><span class="sxs-lookup"><span data-stu-id="c7c92-161">This is true across a range of device platforms, including HoloLens, Android, and iOS devices.</span></span> <span data-ttu-id="c7c92-162">Чтобы научиться разрабатывать общие возможности, заполните все уроки в модуле общего доступа.</span><span class="sxs-lookup"><span data-stu-id="c7c92-162">To learn how to develop a shared experience, complete all lessons in the Sharing module.</span></span>

<span data-ttu-id="c7c92-163">На следующем занятии будет рассмотрено, как предоставить пользователям отзывы в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="c7c92-163">In the next Lesson, we will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="c7c92-164">Этот отзыв будет включать сведения о создании привязок, качестве понимания качества среды и состоянии сеанса Azure.</span><span class="sxs-lookup"><span data-stu-id="c7c92-164">This feedback will include information about Anchor creation, the quality of environment understanding, and the state of the Azure session.</span></span> <span data-ttu-id="c7c92-165">Без отзывов пользователи могут не определить, успешно ли отправлена привязка в Azure, имеет ли качество окружения достаточно для создания привязки или текущего состояния.</span><span class="sxs-lookup"><span data-stu-id="c7c92-165">Without feedback, users may not know whether an anchor has successfully been upload to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

[<span data-ttu-id="c7c92-166">Следующий урок. Учебник по ASA 3</span><span class="sxs-lookup"><span data-stu-id="c7c92-166">Next Lesson: ASA Tutorial 3</span></span>](mrlearning-asa-ch3.md)

